<dataControllerCollection snapshot="true" xmlns="urn:schemas-codeontime-com:data-aquarium">
  <dataController name="Messages" conflictDetection="overwriteChanges" label="Opexad Error Message" nativeSchema="opex" nativeTableName="ad_error_message" generateDataAccessObjects="true">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`ad_error_message`.`msgNo` `MsgNo`
	,`ad_error_message`.`errorMsg` `ErrorMsg`
	,`ad_error_message`.`module_id` `ModuleID`
	,`ad_error_message`.`error_type` `ErrorType`
	,`ad_error_message`.`rowid` `Rowid`
from `opex`.`ad_error_message` `ad_error_message`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="MsgNo" type="String" allowNulls="false" label="msg No" length="4" showInSummary="true" />
      <field name="ErrorMsg" type="String" allowNulls="false" label="error Msg" length="250" showInSummary="true" />
      <field name="ModuleID" type="String" label="Module Id" length="2" showInSummary="true" />
      <field name="ErrorType" type="String" label="Error Type" length="1" showInSummary="true" />
      <field name="Rowid" type="Int32" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Opexad Error Message">
        <headerText>$DefaultGridViewDescription</headerText>
        <dataFields>
          <dataField fieldName="MsgNo" columns="4" />
          <dataField fieldName="ErrorMsg" />
          <dataField fieldName="ModuleID" columns="2" />
          <dataField fieldName="ErrorType" columns="1" />
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Opexad Error Message">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1" headerText="Opexad Error Message">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="MsgNo" columns="4" />
              <dataField fieldName="ErrorMsg" />
              <dataField fieldName="ModuleID" columns="2" />
              <dataField fieldName="ErrorType" columns="1" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexad Error Message">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="MsgNo" columns="4" />
              <dataField fieldName="ErrorMsg" />
              <dataField fieldName="ModuleID" columns="2" />
              <dataField fieldName="ErrorType" columns="1" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
        <action id="a2" commandName="Edit" />
        <action id="a3" commandName="Delete" />
        <action id="a6" />
        <action id="a7" commandName="New" commandArgument="grid1" />
        <action id="a8" commandName="Duplicate" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a1" commandName="Edit" />
        <action id="a2" commandName="Delete" />
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag3" scope="ActionBar" headerText="New" flat="true">
        <action id="a1" commandName="New" commandArgument="createForm1" cssClass="NewIcon" />
      </actionGroup>
      <actionGroup id="ag4" scope="ActionBar" headerText="Edit/Delete" flat="true">
        <action id="a1" whenKeySelected="true" commandName="Edit" commandArgument="editForm1" cssClass="EditIcon" whenView="grid1" />
        <action id="a2" whenKeySelected="true" commandName="Delete" cssClass="DeleteIcon" whenView="grid1" />
      </actionGroup>
      <actionGroup id="ag5" scope="ActionBar" headerText="Actions">
        <action id="a1" commandName="ExportCsv" />
        <action id="a2" />
        <action id="a3" commandName="ExportRowset" />
        <action id="a4" commandName="ExportRss" />
        <action id="a5" />
        <action id="a6" commandName="Import" commandArgument="createForm1" />
        <action id="a7" commandName="DataSheet" />
        <action id="a8" commandName="Grid" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag7" scope="ActionBar" headerText="Report">
        <action id="a1" commandName="ReportAsPdf" />
        <action id="a2" commandName="ReportAsImage" />
        <action id="a3" commandName="ReportAsExcel" />
        <action id="a4" commandName="ReportAsWord" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="Options" conflictDetection="overwriteChanges" label="Opexad Module Options" nativeSchema="opex" nativeTableName="ad_module_options" generateDataAccessObjects="true">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`ad_module_options`.`rowid` `Rowid`
	,`ad_module_options`.`id` `ID`
	,`ad_module_options`.`description` `Description`
	,`ad_module_options`.`value` `Value`
	,`ad_module_options`.`option_name` `OptionName`
	,`ad_module_options`.`required` `Required`
from `opex`.`ad_module_options` `ad_module_options`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="Rowid" type="Int32" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="ID" type="String" allowNulls="false" label="Id" length="2" showInSummary="true" />
      <field name="Description" type="String" label="Description" length="250" showInSummary="true" />
      <field name="Value" type="String" label="Value" length="500" showInSummary="true" />
      <field name="OptionName" type="String" label="Option Name" length="50" showInSummary="true" />
      <field name="Required" type="String" label="Required" length="1" showInSummary="true" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Opexad Module Options" access="Public">
        <headerText>$DefaultGridViewDescription</headerText>
        <dataFields>
          <dataField fieldName="ID" columns="2" />
          <dataField fieldName="Description" />
          <dataField fieldName="Value" />
          <dataField fieldName="OptionName" columns="50" />
          <dataField fieldName="Required" columns="1" />
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Opexad Module Options" access="Public">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1" headerText="Opexad Module Options">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="ID" columns="2" />
              <dataField fieldName="Description" />
              <dataField fieldName="Value" />
              <dataField fieldName="OptionName" columns="50" />
              <dataField fieldName="Required" columns="1" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexad Module Options">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="ID" columns="2" />
              <dataField fieldName="Description" />
              <dataField fieldName="Value" />
              <dataField fieldName="OptionName" columns="50" />
              <dataField fieldName="Required" columns="1" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
        <action id="a2" commandName="Edit" />
        <action id="a3" commandName="Delete" />
        <action id="a6" />
        <action id="a7" commandName="New" commandArgument="grid1" />
        <action id="a8" commandName="Duplicate" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a1" commandName="Edit" />
        <action id="a2" commandName="Delete" />
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag3" scope="ActionBar" headerText="New" flat="true">
        <action id="a1" commandName="New" commandArgument="createForm1" cssClass="NewIcon" />
      </actionGroup>
      <actionGroup id="ag4" scope="ActionBar" headerText="Edit/Delete" flat="true">
        <action id="a1" whenKeySelected="true" commandName="Edit" commandArgument="editForm1" cssClass="EditIcon" whenView="grid1" />
        <action id="a2" whenKeySelected="true" commandName="Delete" cssClass="DeleteIcon" whenView="grid1" />
      </actionGroup>
      <actionGroup id="ag5" scope="ActionBar" headerText="Actions">
        <action id="a1" commandName="ExportCsv" />
        <action id="a2" />
        <action id="a3" commandName="ExportRowset" />
        <action id="a4" commandName="ExportRss" />
        <action id="a5" />
        <action id="a6" commandName="Import" commandArgument="createForm1" />
        <action id="a7" commandName="DataSheet" />
        <action id="a8" commandName="Grid" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag7" scope="ActionBar" headerText="Report">
        <action id="a1" commandName="ReportAsPdf" />
        <action id="a2" commandName="ReportAsImage" />
        <action id="a3" commandName="ReportAsExcel" />
        <action id="a4" commandName="ReportAsWord" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="GlCodes" conflictDetection="overwriteChanges" label="Gl Codes" nativeSchema="opex" nativeTableName="gl_codes">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`gl_codes`.`gl_code` `GlCode`
	,`gl_codes`.`gl_description` `GlDescription`
	,`gl_codes`.`disabled` `Disabled`
	,`gl_codes`.`display_in_ss` `DisplayInSs`
from `opex`.`gl_codes` `gl_codes`
</text>
      </command>
    </commands>
    <fields>
      <field name="GlCode" type="String" allowNulls="false" isPrimaryKey="true" label="GL Code" length="12" showInSummary="true" readOnly="true" />
      <field name="GlDescription" type="String" label="Description" length="50" showInSummary="true" readOnly="true" />
      <field name="Disabled" type="String" label="Disabled" length="1" showInSummary="true" readOnly="true" />
      <field name="DisplayInSs" type="String" label="Display In Ss" length="1" showInSummary="true" readOnly="true" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Gl Codes" filter="Disabled = &quot;N&quot; AND DisplayInSs = &quot;Y&quot;">
        <headerText>$DefaultGridViewDescription</headerText>
        <dataFields>
          <dataField fieldName="GlCode" columns="12" />
          <dataField fieldName="GlDescription" columns="50" />
          <dataField fieldName="Disabled" columns="1" hidden="true">
          </dataField>
          <dataField fieldName="DisplayInSs" columns="1" hidden="true">
          </dataField>
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Gl Codes">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1" headerText="Gl Codes">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="GlCode" columns="12" />
              <dataField fieldName="GlDescription" columns="50" />
              <dataField fieldName="Disabled" columns="1" />
              <dataField fieldName="DisplayInSs" columns="1" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Gl Codes">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="GlCode" columns="12" />
              <dataField fieldName="GlDescription" columns="50" />
              <dataField fieldName="Disabled" columns="1" />
              <dataField fieldName="DisplayInSs" columns="1" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="Opexlocations" conflictDetection="overwriteChanges" label="Opexlocations" nativeSchema="opex" nativeTableName="locations">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`locations`.`sla_acc` `SlaAcc`
	,`locations`.`location_code` `LocationCode`
	,`locations`.`sla_nam` `SlaNam`
	,`locations`.`sla_shrt_nam` `SlaShrtNam`
	,`locations`.`sla_add1` `SlaAdd1`
	,`locations`.`sla_add2` `SlaAdd2`
	,`locations`.`del_location_id` `DelLocationID`
	,`locations`.`sla_add3` `SlaAdd3`
	,`locations`.`sla_add4` `SlaAdd4`
	,`locations`.`sla_pst_cd` `SlaPstCd`
	,`locations`.`sla_cntt` `SlaCntt`
	,`locations`.`sla_cntt_let1` `SlaCnttLet1`
	,`locations`.`sla_titl_let1` `SlaTitlLet1`
	,`locations`.`sla_tel` `SlaTel`
	,`locations`.`sla_fax` `SlaFax`
	,`locations`.`email` `Email`
	,`locations`.`disabled` `Disabled`
from `opex`.`locations` `locations`
</text>
      </command>
      <command id="del_location_idIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="DelLocationID" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="SlaAcc" type="String" allowNulls="false" label="Delivery Code" length="8" showInSummary="true" />
      <field name="LocationCode" type="String" label="Location Code" length="8" showInSummary="true" />
      <field name="SlaNam" type="String" allowNulls="false" label="Name" length="75" showInSummary="true" />
      <field name="SlaShrtNam" type="String" label="Short Name" length="6" showInSummary="true" />
      <field name="SlaAdd1" type="String" label="Address" length="50" showInSummary="true" />
      <field name="SlaAdd2" type="String" label="Address" length="50" />
      <field name="DelLocationID" type="UInt32" allowNulls="false" isPrimaryKey="true" label="Delivery Id" readOnly="true" />
      <field name="SlaAdd3" type="String" label="Address" length="50" />
      <field name="SlaAdd4" type="String" label="Address" length="50" />
      <field name="SlaPstCd" type="String" label="Post Code" length="10" />
      <field name="SlaTel" type="String" label="Telephone" length="15" />
      <field name="SlaFax" type="String" label="Sla Fax" length="15" />
      <field name="Email" type="String" label="Email" length="45" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Delivery Addresses" filter="disabled = &quot;N&quot;" tags="view-style-grid, &#xD;&#xA;view-style-charts-disabled,&#xD;&#xA;view-style-list-disabled,&#xD;&#xA;multi-select-none ">
        <headerText>This is a list of valid Delivery Addresses</headerText>
        <dataFields>
          <dataField fieldName="DelLocationID" columns="15" />
          <dataField fieldName="SlaAcc" columns="8" />
          <dataField fieldName="LocationCode" columns="8" hidden="true">
          </dataField>
          <dataField fieldName="SlaNam" />
          <dataField fieldName="SlaShrtNam" columns="6" />
          <dataField fieldName="SlaAdd1" columns="50" />
          <dataField fieldName="SlaPstCd" columns="10" />
          <dataField fieldName="SlaTel" columns="15" />
          <dataField fieldName="Email" columns="45" />
        </dataFields>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" commandName="Select" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="Opexroles" conflictDetection="overwriteChanges" label="Opexroles" nativeSchema="opex" nativeTableName="roles">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`roles`.`id` `ID`
	,`roles`.`name` `Name`
	,`roles`.`description` `Description`
	,`roles`.`cost_centre` `CostCentre`
	,`cost_centre`.`budget_desc` `CostCentrebudgetDesc`
	,`roles`.`rank_code` `RankCode`
	,`rank`.`rank_desc` `RankDesc`
from `opex`.`roles` `roles`
	left join `opex`.`rq_budcd` `cost_centre` on `roles`.`cost_centre` = `cost_centre`.`budget_code`
	left join `opex`.`rq_ranks` `rank` on `roles`.`rank_code` = `rank`.`rank_code`
</text>
      </command>
      <command id="idIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="ID" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="ID" type="Int32" allowNulls="false" isPrimaryKey="true" label="Id" readOnly="true" />
      <field name="Name" type="String" label="Name" length="12" showInSummary="true" />
      <field name="Description" type="String" label="Description" length="50" showInSummary="true" />
      <field name="CostCentre" type="String" dataFormatString="c" label="Cost Centre" length="8" showInSummary="true">
        <items style="Lookup" dataController="RqBudcd" newDataView="createForm1" dataValueField="BudgetCode" dataTextField="BudgetDesc" />
      </field>
      <field name="CostCentrebudgetDesc" type="String" readOnly="true" label="Cost Centrebudget Desc" length="50" />
      <field name="RankCode" type="String" label="Rank Code" length="8" showInSummary="true">
        <items style="Lookup" dataController="RqRanks" newDataView="createForm1" dataValueField="RankCode" dataTextField="RankDesc" />
      </field>
      <field name="RankDesc" type="String" readOnly="true" label="Rank Desc" length="32" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Opexroles">
        <headerText>$DefaultGridViewDescription</headerText>
        <dataFields>
          <dataField fieldName="Name" columns="12" />
          <dataField fieldName="Description" columns="50" />
          <dataField fieldName="CostCentre" aliasFieldName="CostCentrebudgetDesc" />
          <dataField fieldName="RankCode" aliasFieldName="RankDesc" />
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Opexroles">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1" headerText="Opexroles">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="Name" columns="12" />
              <dataField fieldName="Description" columns="50" />
              <dataField fieldName="CostCentre" aliasFieldName="CostCentrebudgetDesc" />
              <dataField fieldName="RankCode" aliasFieldName="RankDesc" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexroles">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="Name" columns="12" />
              <dataField fieldName="Description" columns="50" />
              <dataField fieldName="CostCentre" aliasFieldName="CostCentrebudgetDesc" />
              <dataField fieldName="RankCode" aliasFieldName="RankDesc" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="RqBudcd" conflictDetection="overwriteChanges" label="Rq Budcd" nativeSchema="opex" nativeTableName="rq_budcd">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`rq_budcd`.`budget_code` `BudgetCode`
	,`rq_budcd`.`budget_desc` `BudgetDesc`
	,`rq_budcd`.`disabled` `Disabled`
	,`rq_budcd`.`displya_in_ss` `DisplyaInSs`
from `opex`.`rq_budcd` `rq_budcd`
</text>
      </command>
    </commands>
    <fields>
      <field name="BudgetCode" type="String" allowNulls="false" isPrimaryKey="true" label="Budget Code" length="8" showInSummary="true" readOnly="true" />
      <field name="BudgetDesc" type="String" allowNulls="false" label="Description" length="50" showInSummary="true" readOnly="true" />
      <field name="Disabled" type="String" label="Disabled" length="1" showInSummary="true" readOnly="true" />
      <field name="DisplyaInSs" type="String" label="Displya In Ss" length="1" showInSummary="true" readOnly="true" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Rq Budcd" filter="Disabled = &quot;N&quot; AND DisplyaInSs = &quot;Y&quot;">
        <headerText>$DefaultGridViewDescription</headerText>
        <dataFields>
          <dataField fieldName="BudgetCode" columns="8" />
          <dataField fieldName="BudgetDesc" columns="50" />
          <dataField fieldName="Disabled" columns="1" hidden="true">
          </dataField>
          <dataField fieldName="DisplyaInSs" columns="1" hidden="true">
          </dataField>
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Rq Budcd">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1" headerText="Rq Budcd">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="BudgetCode" columns="8" />
              <dataField fieldName="BudgetDesc" columns="50" />
              <dataField fieldName="Disabled" columns="1" />
              <dataField fieldName="DisplyaInSs" columns="1" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Rq Budcd">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="BudgetCode" columns="8" />
              <dataField fieldName="BudgetDesc" columns="50" />
              <dataField fieldName="Disabled" columns="1" />
              <dataField fieldName="DisplyaInSs" columns="1" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="ReasonCodes" conflictDetection="overwriteChanges" label="Opexrq Comms" nativeSchema="opex" nativeTableName="rq_comms" generateDataAccessObjects="true">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`rq_comms`.`comment_code` `CommentCode`
	,`rq_comms`.`comment_desc` `CommentDesc`
	,`rq_comms`.`stores_only` `StoresOnly`
	,`rq_comms`.`req_only` `ReqOnly`
	,`rq_comms`.`col_only` `ColOnly`
	,`rq_comms`.`disabled` `Disabled`
from `opex`.`rq_comms` `rq_comms`
</text>
      </command>
    </commands>
    <fields>
      <field name="CommentCode" type="String" allowNulls="false" isPrimaryKey="true" label="Reason Code" length="3" showInSummary="true" />
      <field name="CommentDesc" type="String" label="Reason" length="20" showInSummary="true" />
      <field name="StoresOnly" type="String" label="Stores Only" length="1" showInSummary="true" />
      <field name="ReqOnly" type="String" label="Req Only" length="1" showInSummary="true" />
      <field name="ColOnly" type="String" label="Col Only" length="1" showInSummary="true" />
      <field name="Disabled" type="String" label="Disabled" length="1" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Opexrq Comms" filter="stores_only = &quot;N&quot;&#xD;&#xA;AND&#xD;&#xA;disabled = &quot;N&quot;&#xD;&#xA;AND&#xD;&#xA;col_only =  &quot;N&quot;">
        <headerText>Choose from the list of reason codes displayed</headerText>
        <dataFields>
          <dataField fieldName="CommentCode" columns="3" />
          <dataField fieldName="CommentDesc" columns="20" />
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Reason Codes">
        <headerText>Reason Code Detail</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="CommentCode" columns="3" />
              <dataField fieldName="CommentDesc" columns="20" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexrq Comms">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="CommentCode" columns="3" />
              <dataField fieldName="CommentDesc" columns="20" />
              <dataField fieldName="StoresOnly" columns="1" />
              <dataField fieldName="ReqOnly" columns="1" />
              <dataField fieldName="ColOnly" columns="1" />
              <dataField fieldName="Disabled" columns="1" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="OpexrqLocns" conflictDetection="overwriteChanges" label="Opexrq Locns" nativeSchema="opex" nativeTableName="rq_locns">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`rq_locns`.`rowid` `Rowid`
	,`rq_locns`.`location_code` `LocationCode`
	,`rq_locns`.`location_desc` `LocationDesc`
	,`rq_locns`.`budget_ind` `BudgetInd`
	,`budget_ind`.`budget_desc` `BudgetIndbudgetDesc`
	,`rq_locns`.`whse_code` `WhseCode`
	,`rq_locns`.`user_name` `UserName`
	,`rq_locns`.`turn_date` `TurnDate`
	,`rq_locns`.`uniform_ytd2` `UniformYtd2`
	,`rq_locns`.`non_stk_ytd2` `NonStkYtd2`
	,`rq_locns`.`user_name2` `UserName2`
	,`rq_locns`.`turn_date2` `TurnDate2`
	,`rq_locns`.`uniform_ytd3` `UniformYtd3`
	,`rq_locns`.`non_stk_ytd3` `NonStkYtd3`
	,`rq_locns`.`user_name3` `UserName3`
	,`rq_locns`.`turn_date3` `TurnDate3`
	,`rq_locns`.`uniform_ytd4` `UniformYtd4`
	,`rq_locns`.`non_stk_ytd4` `NonStkYtd4`
	,`rq_locns`.`user_name4` `UserName4`
	,`rq_locns`.`turn_date4` `TurnDate4`
	,`rq_locns`.`uniform_ytd5` `UniformYtd5`
	,`rq_locns`.`non_stk_ytd5` `NonStkYtd5`
	,`rq_locns`.`user_name5` `UserName5`
	,`rq_locns`.`turn_date5` `TurnDate5`
	,`rq_locns`.`email` `Email`
	,`rq_locns`.`disabled` `Disabled`
	,`rq_locns`.`owner` `Owner`
	,`rq_locns`.`division_code` `DivisionCode`
	,`division`.`division_desc` `DivisionDesc`
	,`division`.`company_id` `DivisionCompanyid`
	,`rq_locns`.`company_id` `CompanyID`
	,`company`.`name` `CompanyName`
	,`rq_locns`.`default_delivery_location_id` `DefaultDeliveryLocationID`
	,`default_delivery_location`.`sla_acc` `DefaultDeliveryLocationSlaAcc`
from `opex`.`rq_locns` `rq_locns`
	left join `opex`.`rq_budcd` `budget_ind` on `rq_locns`.`budget_ind` = `budget_ind`.`budget_code`
	left join `opex`.`divisions` `division` on `rq_locns`.`division_code` = `division`.`division_code`
	left join `opex`.`company` `company` on `rq_locns`.`company_id` = `company`.`id`
	left join `opex`.`locations` `default_delivery_location` on `rq_locns`.`default_delivery_location_id` = `default_delivery_location`.`del_location_id`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="Rowid" type="Int32" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="LocationCode" type="String" allowNulls="false" label="Location Code" length="8" showInSummary="true" />
      <field name="LocationDesc" type="String" allowNulls="false" label="Location Desc" length="75" showInSummary="true" />
      <field name="BudgetInd" type="String" label="Budget Ind" length="8" showInSummary="true">
        <items style="Lookup" dataController="RqBudcd" newDataView="createForm1" dataValueField="BudgetCode" dataTextField="BudgetDesc" />
      </field>
      <field name="BudgetIndbudgetDesc" type="String" readOnly="true" label="Budget Indbudget Desc" length="50" />
      <field name="WhseCode" type="String" label="Whse Code" length="3" showInSummary="true" />
      <field name="UserName" type="String" label="User Name" length="10" showInSummary="true" />
      <field name="TurnDate" type="DateTime" label="Turn Date" />
      <field name="UniformYtd2" type="Decimal" label="Uniform Ytd2" />
      <field name="NonStkYtd2" type="Decimal" label="Non Stk Ytd2" />
      <field name="UserName2" type="String" label="User Name2" length="10" />
      <field name="TurnDate2" type="DateTime" label="Turn Date2" />
      <field name="UniformYtd3" type="Decimal" label="Uniform Ytd3" />
      <field name="NonStkYtd3" type="Decimal" label="Non Stk Ytd3" />
      <field name="UserName3" type="String" label="User Name3" length="10" />
      <field name="TurnDate3" type="DateTime" label="Turn Date3" />
      <field name="UniformYtd4" type="Decimal" label="Uniform Ytd4" />
      <field name="NonStkYtd4" type="Decimal" label="Non Stk Ytd4" />
      <field name="UserName4" type="String" label="User Name4" length="10" />
      <field name="TurnDate4" type="DateTime" label="Turn Date4" />
      <field name="UniformYtd5" type="Decimal" label="Uniform Ytd5" />
      <field name="NonStkYtd5" type="Decimal" label="Non Stk Ytd5" />
      <field name="UserName5" type="String" label="User Name5" length="10" />
      <field name="TurnDate5" type="DateTime" label="Turn Date5" />
      <field name="Email" type="String" label="Email" length="60" />
      <field name="Disabled" type="String" label="Disabled" length="1" />
      <field name="Owner" type="String" label="Owner" length="8" />
      <field name="DivisionCode" type="String" label="Division Code" length="8" />
      <field name="DivisionDesc" type="String" readOnly="true" label="Division Desc" length="35" />
      <field name="DivisionCompanyid" type="UInt32" readOnly="true" label="Division Company id" />
      <field name="CompanyID" type="UInt32" label="Company Id" />
      <field name="CompanyName" type="String" readOnly="true" label="Company Name" length="20" />
      <field name="DefaultDeliveryLocationID" type="UInt32" label="Default Delivery Location Id">
        <items style="Lookup" dataController="Opexlocations" dataValueField="DelLocationID" dataTextField="SlaAcc" />
      </field>
      <field name="DefaultDeliveryLocationSlaAcc" type="String" readOnly="true" label="Default Delivery Location Sla Acc" length="8" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Opexrq Locns">
        <headerText>$DefaultGridViewDescription</headerText>
        <dataFields>
          <dataField fieldName="LocationCode" columns="8" />
          <dataField fieldName="LocationDesc" />
          <dataField fieldName="BudgetInd" aliasFieldName="BudgetIndbudgetDesc" />
          <dataField fieldName="WhseCode" columns="3" />
          <dataField fieldName="UserName" columns="10" />
          <dataField fieldName="TurnDate" columns="10" />
          <dataField fieldName="UniformYtd2" columns="15" />
          <dataField fieldName="NonStkYtd2" columns="15" />
          <dataField fieldName="UserName2" columns="10" />
          <dataField fieldName="TurnDate2" columns="10" />
          <dataField fieldName="UniformYtd3" columns="15" />
          <dataField fieldName="NonStkYtd3" columns="15" />
          <dataField fieldName="UserName3" columns="10" />
          <dataField fieldName="TurnDate3" columns="10" />
          <dataField fieldName="UniformYtd4" columns="15" />
          <dataField fieldName="NonStkYtd4" columns="15" />
          <dataField fieldName="UserName4" columns="10" />
          <dataField fieldName="TurnDate4" columns="10" />
          <dataField fieldName="UniformYtd5" columns="15" />
          <dataField fieldName="NonStkYtd5" columns="15" />
          <dataField fieldName="UserName5" columns="10" />
          <dataField fieldName="TurnDate5" columns="10" />
          <dataField fieldName="Email" />
          <dataField fieldName="Disabled" columns="1" />
          <dataField fieldName="Owner" columns="8" />
          <dataField fieldName="DivisionCode" aliasFieldName="DivisionDesc" />
          <dataField fieldName="DivisionCompanyid" columns="15" />
          <dataField fieldName="CompanyID" aliasFieldName="CompanyName" />
          <dataField fieldName="DefaultDeliveryLocationID" aliasFieldName="DefaultDeliveryLocationSlaAcc" />
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Opexrq Locns">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1" headerText="Opexrq Locns">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="LocationCode" columns="8" />
              <dataField fieldName="LocationDesc" />
              <dataField fieldName="BudgetInd" aliasFieldName="BudgetIndbudgetDesc" />
              <dataField fieldName="WhseCode" columns="3" />
              <dataField fieldName="UserName" columns="10" />
              <dataField fieldName="TurnDate" columns="10" />
              <dataField fieldName="UniformYtd2" columns="15" />
              <dataField fieldName="NonStkYtd2" columns="15" />
              <dataField fieldName="UserName2" columns="10" />
              <dataField fieldName="TurnDate2" columns="10" />
              <dataField fieldName="UniformYtd3" columns="15" />
              <dataField fieldName="NonStkYtd3" columns="15" />
              <dataField fieldName="UserName3" columns="10" />
              <dataField fieldName="TurnDate3" columns="10" />
              <dataField fieldName="UniformYtd4" columns="15" />
              <dataField fieldName="NonStkYtd4" columns="15" />
              <dataField fieldName="UserName4" columns="10" />
              <dataField fieldName="TurnDate4" columns="10" />
              <dataField fieldName="UniformYtd5" columns="15" />
              <dataField fieldName="NonStkYtd5" columns="15" />
              <dataField fieldName="UserName5" columns="10" />
              <dataField fieldName="TurnDate5" columns="10" />
              <dataField fieldName="Email" />
              <dataField fieldName="Disabled" columns="1" />
              <dataField fieldName="Owner" columns="8" />
              <dataField fieldName="DivisionCode" aliasFieldName="DivisionDesc" />
              <dataField fieldName="DivisionCompanyid" columns="15" />
              <dataField fieldName="CompanyID" aliasFieldName="CompanyName" />
              <dataField fieldName="DefaultDeliveryLocationID" aliasFieldName="DefaultDeliveryLocationSlaAcc" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexrq Locns">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="LocationCode" columns="8" />
              <dataField fieldName="LocationDesc" />
              <dataField fieldName="BudgetInd" aliasFieldName="BudgetIndbudgetDesc" />
              <dataField fieldName="WhseCode" columns="3" />
              <dataField fieldName="UserName" columns="10" />
              <dataField fieldName="TurnDate" columns="10" />
              <dataField fieldName="UniformYtd2" columns="15" />
              <dataField fieldName="NonStkYtd2" columns="15" />
              <dataField fieldName="UserName2" columns="10" />
              <dataField fieldName="TurnDate2" columns="10" />
              <dataField fieldName="UniformYtd3" columns="15" />
              <dataField fieldName="NonStkYtd3" columns="15" />
              <dataField fieldName="UserName3" columns="10" />
              <dataField fieldName="TurnDate3" columns="10" />
              <dataField fieldName="UniformYtd4" columns="15" />
              <dataField fieldName="NonStkYtd4" columns="15" />
              <dataField fieldName="UserName4" columns="10" />
              <dataField fieldName="TurnDate4" columns="10" />
              <dataField fieldName="UniformYtd5" columns="15" />
              <dataField fieldName="NonStkYtd5" columns="15" />
              <dataField fieldName="UserName5" columns="10" />
              <dataField fieldName="TurnDate5" columns="10" />
              <dataField fieldName="Email" />
              <dataField fieldName="Disabled" columns="1" />
              <dataField fieldName="Owner" columns="8" />
              <dataField fieldName="DivisionCode" aliasFieldName="DivisionDesc" />
              <dataField fieldName="DivisionCompanyid" columns="15" />
              <dataField fieldName="CompanyID" aliasFieldName="CompanyName" />
              <dataField fieldName="DefaultDeliveryLocationID" aliasFieldName="DefaultDeliveryLocationSlaAcc" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="RqRanks" conflictDetection="overwriteChanges" label="Rq Ranks" nativeSchema="opex" nativeTableName="rq_ranks" generateDataAccessObjects="true">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`rq_ranks`.`rowid` `Rowid`
	,`rq_ranks`.`rank_code` `RankCode`
	,`rq_ranks`.`rank_desc` `RankDesc`
	,`rq_ranks`.`staff_filter` `StaffFilter`
	,`staff_filter`.`staff_filter_description` `StaffFilterStaffFilterDescription`
from `opex`.`rq_ranks` `rq_ranks`
	left join `opex`.`item_staff_filter` `staff_filter` on `rq_ranks`.`staff_filter` = `staff_filter`.`staff_filter`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="Rowid" type="Int32" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="RankCode" type="String" allowNulls="false" label="Rank Code" length="8" showInSummary="true" />
      <field name="RankDesc" type="String" label="Rank Desc" length="32" showInSummary="true" />
      <field name="StaffFilter" type="String" label="Staff Filter" length="8" showInSummary="true" />
      <field name="StaffFilterStaffFilterDescription" type="String" readOnly="true" label="Staff Filter Staff Filter Description" length="200" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Rq Ranks">
        <headerText>$DefaultGridViewDescription</headerText>
        <dataFields>
          <dataField fieldName="RankCode" columns="8" />
          <dataField fieldName="RankDesc" columns="32" />
          <dataField fieldName="StaffFilter" aliasFieldName="StaffFilterStaffFilterDescription" />
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Rq Ranks">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1" headerText="Rq Ranks">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="RankCode" columns="8" />
              <dataField fieldName="RankDesc" columns="32" />
              <dataField fieldName="StaffFilter" aliasFieldName="StaffFilterStaffFilterDescription" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Rq Ranks">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="RankCode" columns="8" />
              <dataField fieldName="RankDesc" columns="32" />
              <dataField fieldName="StaffFilter" aliasFieldName="StaffFilterStaffFilterDescription" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
        <action id="a2" commandName="Edit" />
        <action id="a3" commandName="Delete" />
        <action id="a6" />
        <action id="a7" commandName="New" commandArgument="grid1" />
        <action id="a8" commandName="Duplicate" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a1" commandName="Edit" />
        <action id="a2" commandName="Delete" />
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag3" scope="ActionBar" headerText="New" flat="true">
        <action id="a1" commandName="New" commandArgument="createForm1" cssClass="NewIcon" />
      </actionGroup>
      <actionGroup id="ag4" scope="ActionBar" headerText="Edit/Delete" flat="true">
        <action id="a1" whenKeySelected="true" commandName="Edit" commandArgument="editForm1" cssClass="EditIcon" whenView="grid1" />
        <action id="a2" whenKeySelected="true" commandName="Delete" cssClass="DeleteIcon" whenView="grid1" />
      </actionGroup>
      <actionGroup id="ag5" scope="ActionBar" headerText="Actions">
        <action id="a1" commandName="ExportCsv" />
        <action id="a2" />
        <action id="a3" commandName="ExportRowset" />
        <action id="a4" commandName="ExportRss" />
        <action id="a5" />
        <action id="a6" commandName="Import" commandArgument="createForm1" />
        <action id="a7" commandName="DataSheet" />
        <action id="a8" commandName="Grid" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag7" scope="ActionBar" headerText="Report">
        <action id="a1" commandName="ReportAsPdf" />
        <action id="a2" commandName="ReportAsImage" />
        <action id="a3" commandName="ReportAsExcel" />
        <action id="a4" commandName="ReportAsWord" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="RequisitionLines" conflictDetection="overwriteChanges" label="Opexrq Rqitm2" nativeSchema="opex" nativeTableName="rq_rqitm_2" handler="RequisitionLinesBusinessRules" generateDataAccessObjects="false">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`rq_rqitm_2`.`rowid` `Rowid`
	,`rq_rqitm_2`.`item_code` `ItemCode`
	,`item`.`sti_desc` `StiDesc`
	,`rq_rqitm_2`.`size_code` `SizeCode`
	,`rq_rqitm_2`.`outs_qty` `OutsQty`
	,`rq_rqitm_2`.`comment_code` `CommentCode`
	,`comment`.`comment_desc` `CommentDesc`
	,`rq_rqitm_2`.`whse_code` `WhseCode`
	,`whse`.`stwh_desc` `Warehouse`
	,`rq_rqitm_2`.`status_code` `StatusCode`
	,`status`.`status_description` `StatusDescription`
	,`rq_rqitm_2`.`line_value` `LineValue`
	,`rq_rqitm_2`.`alloc_qty` `AllocQty`
	,`rq_rqitm_2`.`orig_qty` `OrigQty`
	,`rq_rqitm_2`.`req_item_cost` `ReqItemCost`
	,`rq_rqitm_2`.`budget_ind` `BudgetInd`
	,`rq_rqitm_2`.`return_dt` `ReturnDt`
	,`rq_rqitm_2`.`rq_header` `RqHeader`
	,`rq_header`.`staff_code` `RqHeaderstaffCode`
	,`rq_header`.`staff_uid` `rqHeaderStaffUid`
	,`rq_header`.`location_code` `rqHeaderLocationCode`
	,`rq_header`.`rqn_prefix` `rqHeaderRqnPrefix`
	,`rq_rqitm_2`.`date_time_placed` `DateTimePlaced`
	,`rq_rqitm_2`.`date_time_rcvd` `DateTimeRcvd`
	,`rq_rqitm_2`.`return_qty_total` `ReturnQtyTotal`
	,`rq_rqitm_2`.`serial_number_id` `SerialNumberID`
	,`serial_number`.`serial_number` `SerialNumberSerialNumber`
	,`serial_number`.`item_condition_code` `ConditionCode`
	,`rq_rqitm_2`.`gl_code` `GlCode`
	,`gl`.`gl_description` `glDescription`
	,`rq_rqitm_2`.`dispatch_id` `DispatchID`
	,`dispatch`.`status_code` `DispatchStatusCode`
	,`rq_rqitm_2`.`additional_text` `AdditionalText`
	,`item_condition_code`.`description` `ItemConditionCodeDescription`
	,`location_code`.`location_desc` `LocationCodeLocationDesc`
from `opex`.`rq_rqitm_2` `rq_rqitm_2`
	left join `opex`.`rq_comms` `comment` on `rq_rqitm_2`.`comment_code` = `comment`.`comment_code`
	left join `opex`.`st_whse` `whse` on `rq_rqitm_2`.`whse_code` = `whse`.`whse_code`
	left join `opex`.`rq_status` `status` on `rq_rqitm_2`.`status_code` = `status`.`status_code`
	left join `opex`.`rq_rqns` `rq_header` on `rq_rqitm_2`.`rq_header` = `rq_header`.`rowid`
	left join `opex`.`rq_locns` `location_code` on `rq_header`.`location_code` = `location_code`.`location_code`
	left join `opex`.`serial_numbers` `serial_number` on `rq_rqitm_2`.`serial_number_id` = `serial_number`.`id`
	left join `opex`.`item_condition_status` `item_condition_code` on `serial_number`.`item_condition_code` = `item_condition_code`.`item_condition_code`
	left join `opex`.`gl_codes` `gl` on `rq_rqitm_2`.`gl_code` = `gl`.`gl_code`
	left join `opex`.`requisition_dispatch_detail` `dispatch` on `rq_rqitm_2`.`dispatch_id` = `dispatch`.`dispatch_id`
	left join `opex`.`st_item` `item` on `rq_rqitm_2`.`item_code` = `item`.`item_code`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="Rowid" type="Int32" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="ItemCode" type="String" label="Item Code" length="16" showInSummary="true">
        <items style="Lookup" dataController="Item" newDataView="createForm1" dataValueField="ItemCode" dataTextField="ItemCode" copy="StiDesc=StiDesc" />
      </field>
      <field name="StiDesc" type="String" readOnly="true" label="Item Description" length="75" />
      <field name="SizeCode" type="String" allowNulls="false" label="Size Code" length="20" showInSummary="true" />
      <field name="OutsQty" type="Decimal" label="Outstanding" showInSummary="true" />
      <field name="CommentCode" type="String" label="Reason Code" length="3" showInSummary="true">
        <items style="Lookup" dataController="ReasonCodes" newDataView="createForm1" dataValueField="CommentCode" dataTextField="CommentCode" copy="CommentDesc=CommentDesc" />
      </field>
      <field name="CommentDesc" type="String" readOnly="true" label="Reason" length="20" />
      <field name="WhseCode" type="String" label="Warehouse Code" length="3" showInSummary="true" />
      <field name="Warehouse" type="String" readOnly="true" label="Warehouse" length="32" />
      <field name="StatusCode" type="String" label="Status Code" length="2" />
      <field name="StatusDescription" type="String" readOnly="true" label="Status" length="50" />
      <field name="LineValue" type="Decimal" label="Cost" dataFormatString="C2" />
      <field name="AllocQty" type="Decimal" label="Issued" />
      <field name="OrigQty" type="Decimal" allowNulls="false" label="Requested" />
      <field name="ReqItemCost" type="Decimal" dataFormatString="C2" label="Item Cost" />
      <field name="BudgetInd" type="String" label="Budget Ind" length="8" />
      <field name="ReturnDt" type="DateTime" label="Returned" />
      <field name="RqHeader" type="Int32" allowNulls="false" label="Requisition" />
      <field name="RqHeaderstaffCode" type="String" readOnly="true" label="Staff Code" length="8" />
      <field name="rqHeaderStaffUid" type="UInt32" readOnly="true" label="Staff UID" />
      <field name="rqHeaderLocationCode" type="String" readOnly="true" label="rq Header Location Code" length="8" />
      <field name="rqHeaderRqnPrefix" type="String" readOnly="true" label="rq Header Rqn Prefix" length="2" />
      <field name="DateTimePlaced" type="DateTime" label="Placed" dataFormatString="d" />
      <field name="DateTimeRcvd" type="DateTime" label="Dispatched" dataFormatString="d" />
      <field name="ReturnQtyTotal" type="Int32" label="Returned" />
      <field name="SerialNumberID" type="Int32" label="Serial Number Id">
        <items style="Lookup" dataController="SerialNumbersLocation" newDataView="createForm1" dataValueField="ID" dataTextField="ItemCode" copy="SerialNumberSerialNumber=SerialNumber, ConditionCode=ItemConditionCode, ItemConditionCodeDescription=ItemConditionDescription" />
      </field>
      <field name="SerialNumberSerialNumber" type="String" readOnly="true" label="Serial Number" length="20" />
      <field name="ConditionCode" type="String" readOnly="true" label="Serial Number Item Condition Code" length="1" />
      <field name="GlCode" type="String" label="GL Code" length="12">
        <items style="Lookup" dataController="GlCodes" newDataView="createForm1" dataValueField="GlCode" dataTextField="GlCode" copy="glDescription=GlDescription" />
      </field>
      <field name="glDescription" type="String" readOnly="true" label="GL description" length="50" />
      <field name="DispatchID" type="UInt32" label="Dispatch Id" />
      <field name="DispatchStatusCode" type="String" readOnly="true" label="Dispatch Status Code" length="2" />
      <field name="AdditionalText" type="String" label="Additional Text" length="500" />
      <field name="ItemConditionCodeDescription" type="String" readOnly="true" label="Item Condition" length="50" />
      <field name="LocationCodeLocationDesc" type="String" readOnly="true" label="Location Code Location Desc" length="75" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Requisitioned Items (Outstanding)" sortExpression="RqHeader desc, ItemCode desc" filter="`rq_rqitm_2`.`status_code`  not like &quot;N%&quot;&#xD;&#xA;AND&#xD;&#xA;(&#xD;&#xA;`rq_rqitm_2`.`status_code` in (&quot;OS&quot;,&quot;SU&quot;,&quot;EN&quot;,&quot;SQ&quot;,&quot;EA&quot;,&quot;WT&quot;,&quot;SN&quot;,&quot;TW&quot;,&quot;HD&quot;,&quot;CF&quot;,&quot;DS&quot;) OR&#xD;&#xA;(`rq_rqitm_2`.status_code  in (&quot;AL&quot;,&quot;PA&quot;,&quot;PK&quot; ) AND `rq_rqitm_2`.tailoring_for is null)&#xD;&#xA;)">
        <headerText>This is a list of personal requisitioned items that are outstanding</headerText>
        <dataFields>
          <dataField fieldName="RqHeader">
          </dataField>
          <dataField fieldName="ItemCode" columns="16" />
          <dataField fieldName="StiDesc" columns="50" rows="5">
          </dataField>
          <dataField fieldName="SizeCode" columns="20" />
          <dataField fieldName="StatusDescription" columns="50" rows="5">
          </dataField>
          <dataField fieldName="OrigQty" columns="15" />
          <dataField fieldName="AllocQty" columns="15" />
          <dataField fieldName="OutsQty" columns="15" />
          <dataField fieldName="ReqItemCost" columns="15" />
          <dataField fieldName="LineValue" columns="15" />
          <dataField fieldName="rqHeaderLocationCode" columns="8" hidden="true">
          </dataField>
          <dataField fieldName="rqHeaderRqnPrefix" columns="2" hidden="true">
          </dataField>
          <dataField fieldName="DateTimePlaced" columns="10" />
          <dataField fieldName="DateTimeRcvd" columns="10">
            <visibility>
              <expression test="[DateTimeRcvd] != null" type="ClientScript" />
            </visibility>
          </dataField>
          <dataField fieldName="LocationCodeLocationDesc" hidden="true">
          </dataField>
          <dataField fieldName="rqHeaderStaffUid" columns="15" hidden="true">
          </dataField>
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Requisiton Detail">
        <headerText />
        <categories>
          <category id="c1" headerText="Detail" tab="Detail">
            <description />
            <dataFields>
              <dataField fieldName="RqHeader" columns="15" />
              <dataField fieldName="ItemCode" columns="16" />
              <dataField fieldName="StiDesc" />
              <dataField fieldName="SizeCode" columns="20" />
              <dataField fieldName="StatusDescription" columns="50" />
              <dataField fieldName="CommentDesc" columns="20" />
              <dataField fieldName="rqHeaderLocationCode" columns="8" hidden="true">
              </dataField>
              <dataField fieldName="rqHeaderRqnPrefix" columns="2" hidden="true">
              </dataField>
              <dataField fieldName="AdditionalText" />
              <dataField fieldName="LocationCodeLocationDesc" hidden="true">
              </dataField>
            </dataFields>
          </category>
          <category headerText="Qty" id="c5" tab="Qty">
            <dataFields>
              <dataField fieldName="OrigQty" columns="15" />
              <dataField fieldName="AllocQty" columns="15" />
              <dataField fieldName="OutsQty" columns="15" />
              <dataField fieldName="ReturnQtyTotal" columns="15" />
            </dataFields>
          </category>
          <category headerText="Dates" tab="Dates" id="c2">
            <dataFields>
              <dataField fieldName="DateTimePlaced" columns="10" />
              <dataField fieldName="DateTimeRcvd" columns="10" />
              <dataField fieldName="ReturnDt" columns="10" />
            </dataFields>
          </category>
          <category headerText="Costs" tab="Costs" id="c3">
            <dataFields>
              <dataField fieldName="ReqItemCost" columns="15" />
              <dataField fieldName="LineValue" columns="15" />
            </dataFields>
          </category>
          <category headerText="Serial Numbers" tab="Serial Numbers" id="c4">
            <dataFields>
              <dataField fieldName="SerialNumberSerialNumber" columns="20" />
              <dataField fieldName="ItemConditionCodeDescription" columns="50" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexrq Rqitm2">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="ItemCode" columns="16" />
              <dataField fieldName="StiDesc" />
              <dataField fieldName="SizeCode" columns="20" />
              <dataField fieldName="OutsQty" columns="15" />
              <dataField fieldName="CommentCode" columns="3" />
              <dataField fieldName="CommentDesc" columns="20" />
              <dataField fieldName="WhseCode" columns="3" />
              <dataField fieldName="Warehouse" columns="32" />
              <dataField fieldName="StatusCode" columns="2" />
              <dataField fieldName="StatusDescription" columns="50" />
              <dataField fieldName="LineValue" columns="15" />
              <dataField fieldName="AllocQty" columns="15" />
              <dataField fieldName="OrigQty" columns="15" />
              <dataField fieldName="ReqItemCost" columns="15" />
              <dataField fieldName="BudgetInd" columns="8" />
              <dataField fieldName="ReturnDt" columns="10" />
              <dataField fieldName="RqHeader" aliasFieldName="RqHeaderstaffCode" />
              <dataField fieldName="rqHeaderStaffUid" columns="15" />
              <dataField fieldName="rqHeaderLocationCode" columns="8" />
              <dataField fieldName="rqHeaderRqnPrefix" columns="2" />
              <dataField fieldName="DateTimePlaced" columns="10" />
              <dataField fieldName="DateTimeRcvd" columns="10" />
              <dataField fieldName="ReturnQtyTotal" columns="15" />
              <dataField fieldName="SerialNumberID" aliasFieldName="CleanIdentifier-Error" />
              <dataField fieldName="SerialNumberSerialNumber" columns="20" />
              <dataField fieldName="ConditionCode" columns="1" />
              <dataField fieldName="GlCode" columns="12" />
              <dataField fieldName="glDescription" columns="50" />
              <dataField fieldName="DispatchID" columns="15" />
              <dataField fieldName="DispatchStatusCode" columns="2" />
              <dataField fieldName="AdditionalText" />
              <dataField fieldName="ItemConditionCodeDescription" columns="50" />
              <dataField fieldName="LocationCodeLocationDesc" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="gridAll" commandId="command1" type="Grid" label="Requisitioned Items (All)" baseViewId="grid1" sortExpression="RqHeader desc, ItemCode desc" filter="`rq_rqitm_2`.`status_code`  not like &quot;N%&quot;&#xD;&#xA;&#xD;&#xA;AND &#xD;&#xA;(NOT (`rq_rqitm_2`.status_code  in (&quot;AL&quot;,&quot;PA&quot;,&quot;PK&quot;) AND `rq_rqitm_2`.tailoring_for is not null))&#xD;&#xA;AND&#xD;&#xA;`rq_rqitm_2`.`status_code`  &lt;&gt; &quot;TC&quot;">
        <headerText>This is a list of all personal requisitioned items</headerText>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" headerText="More Information" />
        <action commandName="Email" id="a101" headerText="Ask A Question" description="Ask a Question ?" commandArgument="Ask" confirmation="_controller=OfficerEmailPrompt&#xD;&#xA;_title=Ask Question about an Item&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" causesValidation="false" whenKeySelected="false" cssClass="glyphicon-question-sign" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
        <action commandName="Email" id="a101" headerText="Ask A Question" description="Ask a Question ?" commandArgument="Ask" confirmation="_controller=OfficerEmailPrompt&#xD;&#xA;_title=Ask Question about an Item&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" causesValidation="false" whenKeySelected="false" cssClass="glyphicon-question-sign" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
    <businessRules>
      <rule id="r100" commandName="Email" type="Email" phase="Execute" name="AskAQuestion" commandArgument="Ask">From: "{Parameters_Forname} {Parameters_Surname}" {Parameters_OfficerEmail}
To: {Parameters_AskEmail}
Subject: {Parameters_Subject}
&lt;html&gt;
&lt;body&gt;
&lt;p&gt;
{Parameters_OfficerEmailHeader}
{Parameters_Message}
{Parameters_OfficerEmailFooter}
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</rule>
      <rule id="r102" commandName="Email" type="Code" phase="After" name="ConfirmEmail" />
      <rule id="r101" commandName="Custom" commandArgument="Test" type="Code" phase="Execute" />
    </businessRules>
  </dataController>
  <dataController name="Staff" conflictDetection="overwriteChanges" label="Opexrq Staff" nativeSchema="opex" nativeTableName="rq_staff" generateDataAccessObjects="true" handler="StaffBusinessRules">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`rq_staff`.`staff_uid` `StaffUid`
	,`rq_staff`.`staff_code` `StaffCode`
	,`rq_staff`.`staff_title` `StaffTitle`
	,`rq_staff`.`initials` `Initials`
	,`rq_staff`.`forname` `Forname`
	,`rq_staff`.`surname` `Surname`
	,`rq_staff`.`rank_code` `RankCode`
	,`rank`.`rank_desc` `RankDesc`
	,`rank_staff_filter`.`staff_filter` `RankStaffFilterstaffFilter`
	,`rq_staff`.`epl_number` `EplNumber`
	,`rq_staff`.`location_code` `LocationCode`
	,`location`.`location_desc` `LocationDesc`
	,`location`.`default_delivery_location_id` `LocationDefaultDeliveryLocationid`
	,`location`.`location_catalogue_id` `LocationCatalogueid`
	,`location`.`staff_location_catalogue_id` `LocationStaffLocationCatalogueid`
	,`location_division`.`division_desc` `LocationDivisionDesc`
	,`location_division_company`.`name` `LocationDivisionCompanyName`
	,`location_company`.`name` `LocationCompanyName`
	,`location_default_delivery_location`.`sla_acc` `LocationDefaultDeliveryLocationSlaAcc`
	,`location_budget_ind`.`budget_desc` `LocationBudgetIndbudgetDesc`
	,`rq_staff`.`join_date` `JoinDate`
	,`rq_staff`.`leave_date` `LeaveDate`
	,`rq_staff`.`comments` `Comments`
	,`rq_staff`.`email` `Email`
	,`rq_staff`.`company_id` `CompanyID`
	,`company`.`name` `CompanyName`
	,`rq_staff`.`userCredentials` `UserCredentials`
	,`rq_staff`.`telephone` `Telephone`
	,`rq_staff`.`internal` `Internal`
	,`rq_staff`.`opex_user` `OpexUser`
	,`rq_staff`.`opex_user_name` `OpexUserName`
	,`rq_staff`.`gender` `Gender`
	,`rq_staff`.`active` `Active`
	,`rq_staff`.`restrict_access` `RestrictAccess`
	,`rq_staff`.`access_control_type` `AccessControlType`
	,`location_catalogue`.`location_catalogue` `LocationCatalogueLocationCatalogue`
	,`location_catalogue`.`description` `LocationCatalogueDescription`
from `opex`.`rq_staff` `rq_staff`
	left join `opex`.`rq_ranks` `rank` on `rq_staff`.`rank_code` = `rank`.`rank_code`
	left join `opex`.`item_staff_filter` `rank_staff_filter` on `rank`.`staff_filter` = `rank_staff_filter`.`staff_filter`
	left join `opex`.`rq_locns` `location` on `rq_staff`.`location_code` = `location`.`location_code`
	left join `opex`.`divisions` `location_division` on `location`.`division_code` = `location_division`.`division_code`
	left join `opex`.`company` `location_division_company` on `location_division`.`company_id` = `location_division_company`.`id`
	left join `opex`.`company` `location_company` on `location`.`company_id` = `location_company`.`id`
	left join `opex`.`locations` `location_default_delivery_location` on `location`.`default_delivery_location_id` = `location_default_delivery_location`.`del_location_id`
	left join `opex`.`rq_budcd` `location_budget_ind` on `location`.`budget_ind` = `location_budget_ind`.`budget_code`
	left join `opex`.`location_catalogue` `location_catalogue` on `location`.`location_catalogue_id` = `location_catalogue`.`location_catalogue_id`
	left join `opex`.`company` `company` on `rq_staff`.`company_id` = `company`.`id`
</text>
      </command>
      <command id="staff_uidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="StaffUid" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="StaffUid" type="UInt32" allowNulls="false" isPrimaryKey="true" label="Staff Uid" readOnly="true" />
      <field name="StaffCode" type="String" label="Staff Code" length="8" showInSummary="true" />
      <field name="StaffTitle" type="String" label="Staff Title" length="4" showInSummary="true" />
      <field name="Initials" type="String" label="Initials" length="4" showInSummary="true" />
      <field name="Forname" type="String" label="Forname" length="30" showInSummary="true" />
      <field name="Surname" type="String" label="Surname" length="30" showInSummary="true" />
      <field name="RankCode" type="String" allowNulls="false" label="Rank Code" length="8">
        <items style="Lookup" dataController="RqRanks" newDataView="createForm1" dataValueField="RankCode" dataTextField="RankDesc" copy="" />
      </field>
      <field name="RankDesc" type="String" readOnly="true" label="Rank Desc" length="32" />
      <field name="RankStaffFilterstaffFilter" type="String" readOnly="true" label="Rank Staff Filterstaff Filter" length="8" />
      <field name="EplNumber" type="String" label="Epl Number" length="8" />
      <field name="LocationCode" type="String" allowNulls="false" label="Location Code" length="8">
        <items style="Lookup" dataController="OpexrqLocns" newDataView="createForm1" dataValueField="LocationCode" dataTextField="LocationDesc" copy="LocationDefaultDeliveryLocationid=DefaultDeliveryLocationID, LocationDivisionDesc=DivisionDesc, LocationDivisionCompanyName=CompanyName, LocationCompanyName=CompanyName, LocationDefaultDeliveryLocationSlaAcc=DefaultDeliveryLocationSlaAcc, LocationBudgetIndbudgetDesc=BudgetIndbudgetDesc, " />
      </field>
      <field name="LocationDesc" type="String" readOnly="true" label="Location Desc" length="75" />
      <field name="LocationDefaultDeliveryLocationid" type="UInt32" readOnly="true" label="Location Default Delivery Location id" />
      <field name="LocationCatalogueid" type="UInt32" readOnly="true" label="Location Catalogue id" />
      <field name="LocationStaffLocationCatalogueid" type="UInt32" readOnly="true" label="Location Staff Location Catalogue id" />
      <field name="LocationDivisionDesc" type="String" readOnly="true" label="Location Division Desc" length="35" />
      <field name="LocationDivisionCompanyName" type="String" readOnly="true" label="Location Division Company Name" length="20" />
      <field name="LocationCompanyName" type="String" readOnly="true" label="Location Company Name" length="20" />
      <field name="LocationDefaultDeliveryLocationSlaAcc" type="String" readOnly="true" label="Location Default Delivery Location Sla Acc" length="8" />
      <field name="LocationBudgetIndbudgetDesc" type="String" readOnly="true" label="Location Budget Indbudget Desc" length="50" />
      <field name="JoinDate" type="DateTime" label="Join Date" />
      <field name="LeaveDate" type="DateTime" label="Leave Date" />
      <field name="Comments" type="String" label="Comments" length="60" />
      <field name="Email" type="String" label="Email" length="255" />
      <field name="CompanyID" type="UInt32" label="Company Id" />
      <field name="CompanyName" type="String" readOnly="true" label="Company Name" length="20" />
      <field name="UserCredentials" type="String" label="user Credentials" length="100" />
      <field name="Telephone" type="String" label="Telephone" length="40" />
      <field name="Internal" type="String" label="Internal" length="1" />
      <field name="OpexUser" type="String" label="Opex User" length="1" />
      <field name="OpexUserName" type="String" label="Opex User Name" length="256" />
      <field name="Gender" type="String" label="Gender" length="1" />
      <field name="Active" type="String" label="Active" length="1" />
      <field name="RestrictAccess" type="String" label="Restrict Access" length="1" />
      <field name="AccessControlType" type="String" label="Access Control Type" length="1" />
      <field name="LocationCatalogueLocationCatalogue" type="String" readOnly="true" label="Location Catalogue Location Catalogue" length="8" />
      <field name="LocationCatalogueDescription" type="String" readOnly="true" label="Location Catalogue Description" length="100" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Opexrq Staff">
        <headerText>$DefaultGridViewDescription</headerText>
        <dataFields>
          <dataField fieldName="EplNumber" columns="8">
          </dataField>
          <dataField fieldName="Forname" columns="30" />
          <dataField fieldName="Surname" columns="30" />
          <dataField fieldName="RankCode" aliasFieldName="RankDesc" hidden="true">
          </dataField>
          <dataField fieldName="LocationCode">
          </dataField>
          <dataField fieldName="LocationStaffLocationCatalogueid" columns="15" />
          <dataField fieldName="JoinDate" columns="10" hidden="true">
          </dataField>
          <dataField fieldName="LeaveDate" columns="10" hidden="true">
          </dataField>
          <dataField fieldName="Comments" hidden="true">
          </dataField>
          <dataField fieldName="Email" hidden="true">
          </dataField>
          <dataField fieldName="Gender" columns="1" />
          <dataField fieldName="Active" columns="1" hidden="true">
          </dataField>
          <dataField fieldName="LocationCatalogueLocationCatalogue" columns="8" hidden="true">
          </dataField>
          <dataField fieldName="LocationCatalogueDescription" hidden="true">
          </dataField>
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Opexrq Staff">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1" headerText="Opexrq Staff">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="StaffCode" columns="8" />
              <dataField fieldName="StaffTitle" columns="4" />
              <dataField fieldName="Initials" columns="4" />
              <dataField fieldName="Forname" columns="30" />
              <dataField fieldName="Surname" columns="30" />
              <dataField fieldName="RankCode" aliasFieldName="RankDesc" />
              <dataField fieldName="RankStaffFilterstaffFilter" columns="8" />
              <dataField fieldName="EplNumber" columns="8" />
              <dataField fieldName="LocationCode" aliasFieldName="LocationDesc" />
              <dataField fieldName="LocationDefaultDeliveryLocationid" columns="15" />
              <dataField fieldName="LocationCatalogueid" columns="15" />
              <dataField fieldName="LocationStaffLocationCatalogueid" columns="15" />
              <dataField fieldName="LocationDivisionDesc" columns="35" />
              <dataField fieldName="LocationDivisionCompanyName" columns="20" />
              <dataField fieldName="LocationCompanyName" columns="20" />
              <dataField fieldName="LocationDefaultDeliveryLocationSlaAcc" columns="8" />
              <dataField fieldName="LocationBudgetIndbudgetDesc" columns="50" />
              <dataField fieldName="JoinDate" columns="10" />
              <dataField fieldName="LeaveDate" columns="10" />
              <dataField fieldName="Comments" />
              <dataField fieldName="Email" />
              <dataField fieldName="CompanyID" aliasFieldName="CompanyName" />
              <dataField fieldName="UserCredentials" />
              <dataField fieldName="Telephone" columns="40" />
              <dataField fieldName="Internal" columns="1" />
              <dataField fieldName="OpexUser" columns="1" />
              <dataField fieldName="OpexUserName" />
              <dataField fieldName="Gender" columns="1" />
              <dataField fieldName="Active" columns="1" />
              <dataField fieldName="RestrictAccess" columns="1" />
              <dataField fieldName="AccessControlType" columns="1" />
              <dataField fieldName="LocationCatalogueLocationCatalogue" columns="8" />
              <dataField fieldName="LocationCatalogueDescription" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexrq Staff">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="StaffCode" columns="8" />
              <dataField fieldName="StaffTitle" columns="4" />
              <dataField fieldName="Initials" columns="4" />
              <dataField fieldName="Forname" columns="30" />
              <dataField fieldName="Surname" columns="30" />
              <dataField fieldName="RankCode" aliasFieldName="RankDesc" />
              <dataField fieldName="RankStaffFilterstaffFilter" columns="8" />
              <dataField fieldName="EplNumber" columns="8" />
              <dataField fieldName="LocationCode" aliasFieldName="LocationDesc" />
              <dataField fieldName="LocationDefaultDeliveryLocationid" columns="15" />
              <dataField fieldName="LocationCatalogueid" columns="15" />
              <dataField fieldName="LocationStaffLocationCatalogueid" columns="15" />
              <dataField fieldName="LocationDivisionDesc" columns="35" />
              <dataField fieldName="LocationDivisionCompanyName" columns="20" />
              <dataField fieldName="LocationCompanyName" columns="20" />
              <dataField fieldName="LocationDefaultDeliveryLocationSlaAcc" columns="8" />
              <dataField fieldName="LocationBudgetIndbudgetDesc" columns="50" />
              <dataField fieldName="JoinDate" columns="10" />
              <dataField fieldName="LeaveDate" columns="10" />
              <dataField fieldName="Comments" />
              <dataField fieldName="Email" />
              <dataField fieldName="CompanyID" aliasFieldName="CompanyName" />
              <dataField fieldName="UserCredentials" />
              <dataField fieldName="Telephone" columns="40" />
              <dataField fieldName="Internal" columns="1" />
              <dataField fieldName="OpexUser" columns="1" />
              <dataField fieldName="OpexUserName" />
              <dataField fieldName="Gender" columns="1" />
              <dataField fieldName="Active" columns="1" />
              <dataField fieldName="RestrictAccess" columns="1" />
              <dataField fieldName="AccessControlType" columns="1" />
              <dataField fieldName="LocationCatalogueLocationCatalogue" columns="8" />
              <dataField fieldName="LocationCatalogueDescription" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="Profile" conflictDetection="overwriteChanges" label="Opexrq Stitm" nativeSchema="opex" nativeTableName="rq_stitm" handler="ProfileBusinessRules" generateDataAccessObjects="false">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`rq_stitm`.`item_code` `ItemCode`
	,`item_code`.`sti_desc` `ItemCodeStiDesc`
	,`rq_stitm`.`kit_code` `KitCode`
	,`rq_stitm`.`allowance` `Allowance`
	,`rq_stitm`.`remarks` `Remarks`
	,`rq_stitm`.`size_code` `SizeCode`
	,`rq_stitm`.`rowid` `Rowid`
	,`rq_stitm`.`staff_uid` `StaffUid`
from `opex`.`rq_stitm` `rq_stitm`
	left join `opex`.`st_item` `item_code` on `rq_stitm`.`item_code` = `item_code`.`item_code`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="ItemCode" type="String" allowNulls="false" label="Item Code" length="16" showInSummary="true">
        <items style="Lookup" dataController="Item" dataValueField="ItemCode" dataTextField="ItemCode" dataView="grid1" />
      </field>
      <field name="ItemCodeStiDesc" type="String" readOnly="true" label="Description" length="75" />
      <field name="KitCode" type="String" label="Kit Code" length="16" showInSummary="true" />
      <field name="Allowance" type="Int16" label="Allowance" showInSummary="true" />
      <field name="Remarks" type="String" label="Remarks" length="40" showInSummary="true" />
      <field name="SizeCode" type="String" label="Size Code" length="20" showInSummary="true" contextFields="ItemCode=ItemCode">
        <items style="Lookup" dataController="ItemSize" dataView="grid1" dataValueField="SizeCode" />
      </field>
      <field name="Rowid" type="Int32" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="StaffUid" type="UInt32" allowNulls="false" label="Staff Uid" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Profile" tags="view-style-card, &#xD;&#xA;view-style-charts-disabled,&#xD;&#xA;view-style-list-disabled,&#xD;&#xA;view-style-calendar-disabled,&#xD;&#xA;multi-select-none ">
        <headerText>This is a list of clothing sizes and tailoring remarks</headerText>
        <dataFields>
          <dataField fieldName="StaffUid" columns="15" hidden="true">
          </dataField>
          <dataField fieldName="ItemCode">
          </dataField>
          <dataField fieldName="ItemCodeStiDesc" rows="5" columns="50">
          </dataField>
          <dataField fieldName="SizeCode" columns="20" />
          <dataField fieldName="Remarks" columns="40" />
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Profile">
        <headerText>You can modify the size and add special tailoring requests here</headerText>
        <categories>
          <category id="c1">
            <description />
            <dataFields>
              <dataField fieldName="ItemCode" readOnly="true">
              </dataField>
              <dataField fieldName="SizeCode" columns="20" />
              <dataField fieldName="Remarks" columns="40" />
              <dataField fieldName="StaffUid" columns="15" hidden="true">
              </dataField>
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexrq Stitm">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="ItemCode" aliasFieldName="ItemCodeStiDesc" />
              <dataField fieldName="KitCode" columns="16" />
              <dataField fieldName="Allowance" columns="15" />
              <dataField fieldName="Remarks" columns="40" />
              <dataField fieldName="SizeCode" columns="20" />
              <dataField fieldName="StaffUid" columns="15" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
        <action id="a2" commandName="Edit" />
        <action commandName="Email" id="a101" headerText="Ask A Question" description="Ask a Question ?" commandArgument="Ask" confirmation="_controller=OfficerEmailPrompt&#xD;&#xA;_title=Ask Question about an Item&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" causesValidation="false" whenKeySelected="false" cssClass="glyphicon-question-sign" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a1" commandName="Edit" />
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag4" scope="ActionBar" headerText="Edit/Delete" flat="true">
        <action id="a1" whenKeySelected="true" commandName="Edit" commandArgument="editForm1" cssClass="EditIcon" whenView="grid1" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
    <businessRules>
      <rule id="r100" commandName="Email" type="Email" phase="Execute" name="AskAQuestion" commandArgument="Ask">From: "{Parameters_Forname} {Parameters_Surname}" {Parameters_OfficerEmail}
To: {Parameters_AskEmail}
Subject: {Parameters_Subject}
&lt;html&gt;
&lt;body&gt;
&lt;p&gt;
{Parameters_OfficerEmailHeader}
{Parameters_Message}
{Parameters_OfficerEmailFooter}
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</rule>
      <rule id="r102" commandName="Email" type="Code" phase="After" name="ConfirmEmail" />
    </businessRules>
  </dataController>
  <dataController name="TrolleyPersonal" conflictDetection="overwriteChanges" label="Opexrq Trolley" nativeSchema="opex" nativeTableName="rq_trolley" handler="TrolleyPersonalBusinessRules" generateDataAccessObjects="true">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`rq_trolley`.`rowid` `Rowid`
	,`rq_trolley`.`date_required` `DateRequired`
	,`rq_trolley`.`status_code` `StatusCode`
	,`rq_trolley`.`header_value` `HeaderValue`
	,`rq_trolley`.`urgent_req` `UrgentReq`
	,`rq_trolley`.`customer` `Customer`
	,`rq_trolley`.`del_code` `DelCode`
	,`rq_trolley`.`free_text` `FreeText`
	,`rq_trolley`.`job_no` `JobNo`
	,`rq_trolley`.`budget_ind` `BudgetInd`
	,`budget_ind`.`budget_desc` `BudgetIndbudgetDesc`
	,`rq_trolley`.`delivery_location` `DeliveryLocation`
	,`rq_trolley`.`staff_uid` `StaffUid`
	,`staff_u`.`location_code` `StaffUlocationCode`
	,`staff_u`.`forname` `StaffuForname`
	,`staff_u`.`surname` `StaffuSurname`
	,`staff_u`.`rank_code` `StaffuRankCode`
	,`staff_u`.`email` `StaffuEmail`
	,`staff_u`.`staff_code` `StaffuStaffCode`
	,`staff_ucompany`.`name` `StaffUcompanyName`
	,`staff_urank`.`rank_desc` `StaffUrankRankDesc`
	,`rq_trolley`.`role_id` `RoleID`
	,`role`.`cost_centre` `RoleCostCentre`
	,`role_staff_u`.`location_code` `RoleStaffUlocationCode`
	,`role1`.`name` `RoleName`
	,`role_location`.`location_desc` `RoleLocationDesc`
	,`rq_trolley`.`del_location_id` `DelLocationID`
	,`del_location`.`sla_acc` `DelLocationSlaAcc`
	,`del_location`.`sla_nam` `DelLocationSlaNam`
	,`role_rank`.`rank_desc` `RoleRankDesc`
	,`staff_ulocation`.`location_desc` `StaffUlocationLocationDesc`
	,`rq_trolley`.`default_comment_code` `DefaultCommentCode`
	,`default_comment_code`.`comment_desc` `DefaultCommentCodeCommentDesc`
from `opex`.`rq_trolley` `rq_trolley`
	left join `opex`.`rq_budcd` `budget_ind` on `rq_trolley`.`budget_ind` = `budget_ind`.`budget_code`
	left join `opex`.`rq_staff` `staff_u` on `rq_trolley`.`staff_uid` = `staff_u`.`staff_uid`
	left join `opex`.`rq_locns` `staff_ulocation` on `staff_u`.`location_code` = `staff_ulocation`.`location_code`
	left join `opex`.`company` `staff_ucompany` on `staff_u`.`company_id` = `staff_ucompany`.`id`
	left join `opex`.`rq_ranks` `staff_urank` on `staff_u`.`rank_code` = `staff_urank`.`rank_code`
	left join `opex`.`staff_roles` `role` on `rq_trolley`.`role_id` = `role`.`id`
	left join `opex`.`rq_staff` `role_staff_u` on `role`.`staff_uid` = `role_staff_u`.`staff_uid`
	left join `opex`.`roles` `role1` on `role`.`role_id` = `role1`.`id`
	left join `opex`.`rq_ranks` `role_rank` on `role`.`rank_code` = `role_rank`.`rank_code`
	left join `opex`.`rq_locns` `role_location` on `role`.`location_code` = `role_location`.`location_code`
	left join `opex`.`locations` `del_location` on `rq_trolley`.`del_location_id` = `del_location`.`del_location_id`
	left join `opex`.`rq_comms` `default_comment_code` on `rq_trolley`.`default_comment_code` = `default_comment_code`.`comment_code`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="Rowid" type="Int32" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="DateRequired" type="DateTime" label="Date Required" showInSummary="true" />
      <field name="StatusCode" type="String" label="Status Code" length="2" showInSummary="true" />
      <field name="HeaderValue" type="Decimal" allowNulls="false" label="Header Value" showInSummary="true" dataFormatString="C2" />
      <field name="UrgentReq" type="String" label="Urgent Req" length="1" showInSummary="true" />
      <field name="Customer" type="String" label="Customer" length="8" showInSummary="true" />
      <field name="DelCode" type="String" label="Del Code" length="8" />
      <field name="FreeText" type="String" label="Comments" length="255" />
      <field name="JobNo" type="String" label="Job No" length="10" />
      <field name="BudgetInd" type="String" label="Budget Ind" length="8">
        <items style="Lookup" dataController="RqBudcd" newDataView="createForm1" dataValueField="BudgetCode" dataTextField="BudgetDesc" />
      </field>
      <field name="BudgetIndbudgetDesc" type="String" readOnly="true" label="Budget Indbudget Desc" length="50" />
      <field name="DeliveryLocation" type="String" label="Delivery Location" length="8" />
      <field name="StaffUlocationCode" type="String" readOnly="true" label="Staff Ulocation Code" length="8" />
      <field name="StaffuForname" type="String" readOnly="true" label="Forename" length="30" />
      <field name="StaffuSurname" type="String" readOnly="true" label="Surname" length="30" />
      <field name="StaffuRankCode" type="String" readOnly="true" label="Rank Code" length="8" />
      <field name="StaffuEmail" type="String" readOnly="true" label="Email" length="255" />
      <field name="StaffuStaffCode" type="String" readOnly="true" label="Staff Code" length="8" />
      <field name="StaffUcompanyName" type="String" readOnly="true" label="Staff Ucompany Name" length="20" />
      <field name="StaffUrankRankDesc" type="String" readOnly="true" label="Rank" length="32" />
      <field name="RoleID" type="Int32" label="Change Role" contextFields="StaffUid=StaffUid">
        <items style="Lookup" dataController="OpexstaffRoles" dataValueField="ID" dataTextField="ID" copy="RoleName=RoleName,&#xD;&#xA;LocalRankCode=LocalRankCode,&#xD;&#xA;LocalRankDescription=LocalRankDescription,&#xD;&#xA;LocalBudgetCode=LocalBudgetCode,&#xD;&#xA;LocalLocation=LocalLocation,&#xD;&#xA;LocalLocationCode=LocalLocationCode&#xD;&#xA;" dataView="grid1" />
      </field>
      <field name="RoleCostCentre" type="String" readOnly="true" dataFormatString="c" label="Role Cost Centre" length="8" />
      <field name="RoleStaffUlocationCode" type="String" readOnly="true" label="Role Staff Ulocation Code" length="8" />
      <field name="RoleName" type="String" readOnly="true" label="Role Type" length="12" />
      <field name="RoleLocationDesc" type="String" readOnly="true" label="Location" length="75" />
      <field name="DelLocationID" type="UInt32" label="Del Location Id">
        <items style="Lookup" dataController="Opexlocations" dataValueField="DelLocationID" dataTextField="SlaNam" copy="DelLocationSlaNam=SlaNam&#xD;&#xA;DelLocationSlaAcc=SlaAcc" dataView="grid1" />
      </field>
      <field name="DelLocationSlaAcc" type="String" readOnly="true" label="Del Location Sla Acc" length="8" />
      <field name="DelLocationSlaNam" type="String" readOnly="true" label="Deliver To" length="75" />
      <field name="StaffUid" type="UInt32" allowNulls="false" label="Staff Uid" readOnly="true">
        <items style="Lookup" dataController="Staff" dataValueField="StaffUid" dataTextField="StaffCode" copy="StaffuForname=Forname, StaffuSurname=Surname, StaffuRankCode=RankCode, StaffuEmail=Email, StaffuStaffCode=StaffCode, StaffUcompanyName=LocationDivisionCompanyName, StaffUrankRankDesc=RankDesc, StaffUlocationLocationDesc=LocationDesc" dataView="grid1" />
      </field>
      <field name="RoleRankDesc" type="String" readOnly="true" label="Role Rank" length="32" />
      <field name="StaffUlocationLocationDesc" type="String" readOnly="true" label="Location" length="75" />
      <field name="DefaultCommentCode" type="String" label="Default Reason Code" length="3">
        <items style="Lookup" dataController="ReasonCodes" newDataView="createForm1" dataValueField="CommentCode" dataTextField="CommentDesc" />
      </field>
      <field name="DefaultCommentCodeCommentDesc" type="String" readOnly="true" label="Default Reason" length="20" />
      <field name="Local_TrolleyCount" type="UInt32" label="Items in Trolley" computed="true" dataFormatString="N0" isVirtual="true">
        <formula>select count(*) from rq_trolley_item t where t.staff_uid = `rq_trolley`.`staff_uid`</formula>
      </field>
      <field name="Local_RoleDescription" type="String" label="Role" computed="true" calculated="true" isVirtual="true" length="200">
        <formula>BuildRoleName(`role1`.`description`,
`role_location`.location_desc ,
`role_rank`.`rank_desc`)</formula>
      </field>
      <field name="LocalRankCode" type="String" label="Rank Code" isVirtual="true" computed="true" readOnly="true">
        <formula>COALESCE(`role`.rank_code,`role1`.rank_code,staff_u.rank_code)</formula>
      </field>
      <field name="LocalRankDescription" type="String" label="Rank " isVirtual="true" computed="true" readOnly="true">
        <formula>( Select  r.rank_desc from rq_ranks r Where r.rank_code = COALESCE(role.rank_code,role1.rank_code,staff_u.rank_code)) 	</formula>
      </field>
      <field name="LocalBudgetCode" type="String" label="Budget" isVirtual="true" computed="true" readOnly="true">
        <formula>COALESCE(role.cost_centre,role1.cost_centre ,(select l.budget_ind from rq_locns l  where l.location_code = `staff_u`.`location_code`  ))</formula>
      </field>
      <field name="LocalLocation" type="String" label="Location Code" computed="true" length="75" isVirtual="true">
        <formula>COALESCE(`role_location`.location_desc,`staff_ulocation`.location_desc )</formula>
      </field>
      <field name="LocalLocationCode" type="String" label="Location Code" computed="true" length="8" isVirtual="true">
        <formula>COALESCE(`role_location`.location_code,staff_u.location_code)</formula>
      </field>
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Delivery">
        <headerText>Delivery Information</headerText>
        <dataFields>
          <dataField fieldName="StaffUid" hidden="true">
          </dataField>
          <dataField fieldName="StaffuStaffCode" columns="8" />
          <dataField fieldName="StaffUrankRankDesc" columns="32" />
          <dataField fieldName="Local_RoleDescription" rows="5" columns="50">
          </dataField>
          <dataField fieldName="DelLocationSlaNam" columns="50" rows="5">
          </dataField>
          <dataField fieldName="DateRequired" columns="10" />
          <dataField fieldName="FreeText" columns="25">
          </dataField>
          <dataField fieldName="Local_TrolleyCount" columns="15" />
          <dataField fieldName="StaffuSurname" columns="30" hidden="true">
          </dataField>
          <dataField fieldName="HeaderValue" columns="15" textMode="Static">
          </dataField>
        </dataFields>
        <styles>
          <expression type="ClientScript" result="OPEXTrolleyContents" test="[Local_TrolleyCount] != 0" />
        </styles>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Delivery + Role Details">
        <headerText>You can update your delivery details and role information here</headerText>
        <categories>
          <category id="c1" headerText="Delivery Details" tab="Delivery">
            <description />
            <dataFields>
              <dataField fieldName="DelLocationID" aliasFieldName="DelLocationSlaNam">
              </dataField>
              <dataField fieldName="DateRequired" columns="10" />
              <dataField fieldName="FreeText" />
              <dataField fieldName="StaffuStaffCode" columns="8" hidden="true">
              </dataField>
              <dataField fieldName="DefaultCommentCode" aliasFieldName="DefaultCommentCodeCommentDesc" />
            </dataFields>
          </category>
          <category headerText="Role Information" id="c3" tab="Role">
            <dataFields>
              <dataField fieldName="RoleID" columns="15" aliasFieldName="Local_RoleDescription">
                <headerText>Alternate Role</headerText>
              </dataField>
              <dataField fieldName="RoleName" columns="12" />
              <dataField fieldName="LocalLocation" rows="5" />
              <dataField fieldName="LocalLocationCode" columns="8" />
              <dataField fieldName="LocalRankCode" rows="5" />
              <dataField fieldName="LocalRankDescription" rows="5">
              </dataField>
              <dataField fieldName="LocalBudgetCode" rows="5" />
            </dataFields>
          </category>
          <category headerText="Hidden" id="c2" tab="Hidden">
            <dataFields>
              <dataField fieldName="StatusCode" columns="2" />
              <dataField fieldName="UrgentReq" columns="1" />
              <dataField fieldName="Customer" columns="8" />
              <dataField fieldName="DelCode" columns="8" />
              <dataField fieldName="JobNo" columns="10" />
              <dataField fieldName="BudgetInd" aliasFieldName="BudgetIndbudgetDesc" />
              <dataField fieldName="StaffuForname" columns="30" />
              <dataField fieldName="StaffuSurname" columns="30" />
              <dataField fieldName="StaffuRankCode" columns="8" />
              <dataField fieldName="StaffuEmail" />
              <dataField fieldName="StaffUcompanyName" columns="20" />
              <dataField fieldName="DeliveryLocation" columns="8" />
              <dataField fieldName="StaffUrankRankDesc" columns="32" />
              <dataField fieldName="StaffUlocationLocationDesc" />
              <dataField fieldName="StaffUid" hidden="true">
              </dataField>
              <dataField fieldName="HeaderValue" columns="15" />
              <dataField fieldName="RoleCostCentre" columns="8" />
              <dataField fieldName="RoleRankDesc" columns="32" />
              <dataField fieldName="RoleLocationDesc" />
            </dataFields>
            <visibility>
              <expression test="false" type="ClientScript" />
            </visibility>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexrq Trolley">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="DateRequired" columns="10" />
              <dataField fieldName="StatusCode" columns="2" />
              <dataField fieldName="HeaderValue" columns="15" />
              <dataField fieldName="UrgentReq" columns="1" />
              <dataField fieldName="Customer" columns="8" />
              <dataField fieldName="DelCode" columns="8" />
              <dataField fieldName="FreeText" />
              <dataField fieldName="JobNo" columns="10" />
              <dataField fieldName="BudgetInd" aliasFieldName="BudgetIndbudgetDesc" />
              <dataField fieldName="DeliveryLocation" columns="8" />
              <dataField fieldName="StaffUid" aliasFieldName="StaffUlocationCode" />
              <dataField fieldName="StaffuForname" columns="30" />
              <dataField fieldName="StaffuSurname" columns="30" />
              <dataField fieldName="StaffuRankCode" columns="8" />
              <dataField fieldName="StaffuEmail" />
              <dataField fieldName="StaffuStaffCode" columns="8" />
              <dataField fieldName="StaffUcompanyName" columns="20" />
              <dataField fieldName="StaffUrankRankDesc" columns="32" />
              <dataField fieldName="RoleID" columns="15" />
              <dataField fieldName="RoleCostCentre" columns="8" />
              <dataField fieldName="RoleStaffUlocationCode" columns="8" />
              <dataField fieldName="RoleName" columns="12" />
              <dataField fieldName="RoleLocationDesc" />
              <dataField fieldName="DelLocationID" aliasFieldName="DelLocationSlaAcc" />
              <dataField fieldName="DelLocationSlaNam" />
              <dataField fieldName="RoleRankDesc" columns="32" />
              <dataField fieldName="StaffUlocationLocationDesc" />
              <dataField fieldName="DefaultCommentCode" aliasFieldName="DefaultCommentCodeCommentDesc" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag2" scope="Form">
        <action id="a1" commandName="Edit" />
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag100" scope="ActionBar" headerText="Trolley Actions" flat="true">
        <action id="a1" whenKeySelected="true" commandName="Edit" commandArgument="editForm1" cssClass="EditIcon" whenView="grid1" />
        <action commandName="Custom" commandArgument="FullScreen" headerText="Show Catalogue" id="a102" description="Full Screen" causesValidation="false" cssClass="material-icon-view-module" />
        <action commandName="Custom" commandArgument="SubmitPersonalTrolley" headerText="Submit Trolley" causesValidation="false" id="a100" confirmation="This will submit all the items in your trolley for approval and dispatch" cssClass="material-icon-shopping-cart" whenView="grid1" />
      </actionGroup>
      <actionGroup id="ag1" scope="Grid" flat="false">
        <action commandName="Custom" commandArgument="FullScreen" headerText="Show Catalogue" id="a102" description="Full Screen" causesValidation="false" cssClass="material-icon-view-module" whenView="grid1" />
      </actionGroup>
    </actions>
    <businessRules>
      <rule id="r100" commandName="Custom" commandArgument="SubmitPersonalTrolley" type="Code" phase="Execute" name="SubmitPersonalTrolley" />
      <rule id="r103" commandName="Custom" commandArgument="FullScreen" type="JavaScript" phase="Execute" name="FullScreen">debugger;
$app.touch.show({ controller: 'ItemCataloguePersonal', view: 'grid1' });</rule>
      <rule id="r101" commandName="Update" type="JavaScript" phase="Before" name="ConfirmRole">debugger;
if (this.selectFieldValueObject("RoleID").Modified)
{

success = this.result.confirm('Changing your role will empty your current Trolley ? ');
if (!success) 
{
  this.preventDefault();
}
}
</rule>
      <rule id="r102" commandName="Update" type="Code" phase="Execute" name="UpadateRole" />
    </businessRules>
  </dataController>
  <dataController name="TrolleyLinePersonal" conflictDetection="overwriteChanges" label="Opexrq Trolley Item" nativeSchema="opex" nativeTableName="rq_trolley_item" handler="TrolleyLinePersonalBusinessRules" generateDataAccessObjects="true">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`rq_trolley_item`.`rowid` `Rowid`
	,`rq_trolley_item`.`item_code` `ItemCode`
	,`item`.`sti_desc` `ItemStiDesc`
	,`rq_trolley_item`.`size_code` `SizeCode`
	,`rq_trolley_item`.`qty` `Qty`
	,`rq_trolley_item`.`comment_code` `CommentCode`
	,`comment`.`comment_desc` `CommentDesc`
	,`rq_trolley_item`.`line_value` `LineValue`
	,`rq_trolley_item`.`req_item_cost` `ReqItemCost`
	,`rq_trolley_item`.`UpdateStaffProfile` `UpdateStaffProfile`
	,`rq_trolley_item`.`staff_uid` `StaffUid`
	,`rq_trolley_item`.`type` `Type`
	,`rq_trolley_item`.`description` `Description`
	,`rq_trolley_item`.`additional_information` `AdditionalInformation`
	,`rq_trolley_item`.`gl_code` `glCode`
	,`rq_trolley_item`.`budget_code` `BudgetCode`
	,`rq_trolley_item`.`supplier` `Supplier`
from `opex`.`rq_trolley_item` `rq_trolley_item`
	left join `opex`.`st_item` `item` on `rq_trolley_item`.`item_code` = `item`.`item_code`
	left join `opex`.`rq_comms` `comment` on `rq_trolley_item`.`comment_code` = `comment`.`comment_code`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="Rowid" type="Int32" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="ItemCode" type="String" label="Item Code" length="16" showInSummary="true" causesCalculate="true">
        <items style="Lookup" dataController="ItemCataloguePersonal" dataValueField="ItemCode" dataTextField="ItemCode" dataView="grid1" copy="ItemStiDesc=StiDesc&#xD;&#xA;CommentCode=ChargeCode&#xD;&#xA;CommentDesc=ChargeCodeDescription&#xD;&#xA;&#xD;&#xA;" />
      </field>
      <field name="ItemStiDesc" type="String" readOnly="true" label="Item Description" length="75" />
      <field name="SizeCode" type="String" label="Size" length="20" showInSummary="true" contextFields="ItemCode=ItemCode" causesCalculate="true">
        <items style="Lookup" dataController="ItemSize" dataView="grid1" dataTextField="SizeCode" dataValueField="SizeCode" copy="ReqItemCost=Local_OPEXCost" />
      </field>
      <field name="Qty" type="Decimal" label="Qty" showInSummary="true" allowNulls="false">
        <codeDefault>1</codeDefault>
      </field>
      <field name="CommentCode" type="String" label="Reason Code" length="3" allowNulls="false">
        <items style="Lookup" dataController="ReasonCodes" dataValueField="CommentCode" dataTextField="CommentCode" copy="CommentDesc=CommentDesc" />
      </field>
      <field name="CommentDesc" type="String" readOnly="true" label="Reason" length="20" />
      <field name="LineValue" type="Decimal" allowNulls="false" dataFormatString="C2" label="Total Cost" showInSummary="true" />
      <field name="ReqItemCost" type="Decimal" allowNulls="false" dataFormatString="C2" label="Item Cost" />
      <field name="UpdateStaffProfile" type="String" label="Update Staff Profile" length="1">
        <codeValue />
        <codeDefault>"N"</codeDefault>
      </field>
      <field name="StaffUid" type="UInt32" allowNulls="false" label="Staff Uid">
        <codeValue />
        <codeDefault>Officer.staffRecord.StaffUid</codeDefault>
      </field>
      <field name="Type" type="String" label="Type" length="1">
        <items style="DropDownList">
          <item value="S" text="Stock" />
          <item value="N" text="Non Stock" />
        </items>
      </field>
      <field name="Description" type="String" label="Description" length="500" />
      <field name="AdditionalInformation" type="String" label="Additional Information" length="200" />
      <field name="glCode" type="String" label="GL Code" length="12">
        <items style="Lookup" dataController="GlCodes" dataView="grid1" dataTextField="GlCode" dataValueField="GlCode" />
      </field>
      <field name="BudgetCode" type="String" label="Budget Code" length="8">
        <items style="Lookup" dataController="RqBudcd" dataView="grid1" dataTextField="BudgetCode" dataValueField="BudgetCode" />
      </field>
      <field name="Supplier" type="String" label="Supplier" length="20" />
      <field name="Local_StaffProfileSize" type="String" label="Local Staff Profile Size" length="20" />
      <field name="Local_Description" type="String" label="Description" computed="true" isVirtual="true" length="75">
        <formula>CASE 
WHEN `rq_trolley_item`.`type` = "N" THEN
`rq_trolley_item`.`description`
ELSE 
`item`.`sti_desc` 
END</formula>
      </field>
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Trolley Items">
        <headerText>This is a list of items in your Trolley, click the three dots next to the item code to modify</headerText>
        <dataFields>
          <dataField fieldName="StaffUid" columns="15" hidden="true">
          </dataField>
          <dataField fieldName="ItemCode">
          </dataField>
          <dataField fieldName="Local_Description" rows="5" />
          <dataField fieldName="SizeCode" columns="20" />
          <dataField fieldName="Qty" columns="15" />
          <dataField fieldName="ReqItemCost" columns="15" />
          <dataField fieldName="LineValue" columns="15" />
          <dataField fieldName="CommentCode" columns="3" hidden="true">
          </dataField>
          <dataField fieldName="CommentDesc" columns="20" />
          <dataField fieldName="UpdateStaffProfile" columns="1" hidden="true">
          </dataField>
          <dataField fieldName="Type" columns="1" hidden="true">
          </dataField>
          <dataField fieldName="Description" hidden="true">
          </dataField>
          <dataField fieldName="AdditionalInformation" />
          <dataField fieldName="glCode" columns="12" />
          <dataField fieldName="BudgetCode" columns="8" />
          <dataField fieldName="Supplier" columns="20" />
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Item in Trolley">
        <headerText>You can update this trolley item here</headerText>
        <categories>
          <category id="c1">
            <description />
            <dataFields>
              <dataField fieldName="ItemCode" tag="lookup-details-hidden">
                <visibility>
                  <expression test="[Type] == &quot;S&quot;" type="ClientScript" />
                </visibility>
              </dataField>
              <dataField fieldName="ItemStiDesc" rows="5" tag="lookup-details-hidden">
                <visibility>
                  <expression test="[Type] == &quot;S&quot;" type="ClientScript" />
                </visibility>
              </dataField>
              <dataField fieldName="SizeCode" columns="20" tag="lookup-details-hidden">
                <visibility>
                  <expression test="[Type] == &quot;S&quot;" type="ClientScript" />
                </visibility>
              </dataField>
              <dataField fieldName="Description">
                <visibility>
                  <expression test="[Type] == &quot;N&quot;" type="ClientScript" />
                </visibility>
              </dataField>
              <dataField fieldName="Qty" columns="15" />
              <dataField fieldName="CommentCode" columns="3" tag="lookup-details-hidden">
              </dataField>
              <dataField fieldName="CommentDesc" columns="20" />
              <dataField fieldName="LineValue" columns="15" textMode="Static" hidden="true">
                <visibility>
                  <expression test="[Type] == &quot;S&quot;" type="ClientScript" />
                </visibility>
              </dataField>
              <dataField fieldName="ReqItemCost" columns="15">
                <readOnly>
                  <expression test="[Type] == &quot;S&quot;" type="ClientScript" />
                </readOnly>
              </dataField>
              <dataField fieldName="UpdateStaffProfile" columns="1" hidden="true">
              </dataField>
              <dataField fieldName="StaffUid" columns="15" hidden="true">
              </dataField>
              <dataField fieldName="Type" columns="1" hidden="true">
              </dataField>
              <dataField fieldName="AdditionalInformation" />
              <dataField fieldName="glCode" columns="12" />
              <dataField fieldName="BudgetCode" columns="8" />
              <dataField fieldName="Supplier" columns="20" />
              <dataField fieldName="Local_StaffProfileSize" columns="20" hidden="true">
              </dataField>
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="Add Item to Trolley" tags="material-icon-add-shopping-cart">
        <headerText>Add an item to your Trolley</headerText>
        <categories>
          <category id="c1">
            <description />
            <dataFields>
              <dataField fieldName="ItemCode">
              </dataField>
              <dataField fieldName="ItemStiDesc" rows="5" />
              <dataField fieldName="SizeCode" columns="20" />
              <dataField fieldName="Qty" columns="15" />
              <dataField fieldName="CommentCode" columns="3" />
              <dataField fieldName="CommentDesc" columns="20" />
              <dataField fieldName="ReqItemCost" columns="15" textMode="Static">
              </dataField>
              <dataField fieldName="LineValue" columns="15" textMode="Static">
              </dataField>
              <dataField fieldName="UpdateStaffProfile" columns="1" textMode="Static" hidden="true">
              </dataField>
              <dataField fieldName="StaffUid" columns="15" textMode="Static" hidden="true">
              </dataField>
              <dataField fieldName="Type" columns="1" hidden="true">
              </dataField>
              <dataField fieldName="AdditionalInformation" />
              <dataField fieldName="glCode" columns="12" />
              <dataField fieldName="BudgetCode" columns="8" />
              <dataField fieldName="Supplier" columns="20" />
              <dataField fieldName="Local_StaffProfileSize" columns="20" hidden="true">
              </dataField>
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="nonStockForm" type="Form" commandId="command1" label="Add Item to Trolley" tags="material-icon-add-shopping-cart">
        <headerText>Add an item to your Trolley</headerText>
        <categories>
          <category id="c1" headerText="Non Stock Item">
            <description />
            <dataFields>
              <dataField fieldName="StaffUid" columns="15" textMode="Static" hidden="true">
              </dataField>
              <dataField fieldName="Type" columns="1" hidden="true">
              </dataField>
              <dataField fieldName="Description" />
              <dataField fieldName="Qty" columns="15" />
              <dataField fieldName="CommentCode" columns="3" />
              <dataField fieldName="CommentDesc" columns="20" />
              <dataField fieldName="glCode" columns="12" />
              <dataField fieldName="BudgetCode" columns="8" />
              <dataField fieldName="Supplier" columns="20" />
              <dataField fieldName="ReqItemCost" columns="15">
              </dataField>
              <dataField fieldName="AdditionalInformation" />
              <dataField fieldName="LineValue" columns="15" hidden="true">
              </dataField>
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid" flat="false">
        <action id="a1" commandName="Select" commandArgument="editForm1" headerText="More Information" />
        <action id="a2" commandName="Edit" commandArgument="editForm1" />
        <action id="a3" commandName="Delete" />
        <action id="a8" commandName="Duplicate" commandArgument="createForm1" />
        <action commandName="Email" id="a101" headerText="Ask A Question" description="Ask a Question ?" commandArgument="Ask" confirmation="_controller=OfficerEmailPrompt&#xD;&#xA;_title=Ask Question about an Item&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" causesValidation="false" whenKeySelected="false" cssClass="glyphicon-question-sign" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a1" commandName="Edit" />
        <action id="a2" commandName="Delete" />
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
        <action commandName="Email" id="a101" headerText="Ask A Question" description="Ask a Question ?" commandArgument="Ask" confirmation="_controller=OfficerEmailPrompt&#xD;&#xA;_title=Ask Question about an Item&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" causesValidation="false" whenKeySelected="false" cssClass="glyphicon-question-sign" />
      </actionGroup>
      <actionGroup id="ag3" scope="ActionBar" headerText="New" flat="true">
        <action id="a1" commandName="New" commandArgument="createForm1" cssClass="material-icon-add-shopping-cart" headerText="Add Item" />
        <action id="a100" commandName="New" commandArgument="nonStockForm" cssClass="material-icon-add-shopping-cart" headerText="Add Non Stock Item" />
      </actionGroup>
      <actionGroup id="ag4" scope="ActionBar" headerText="Edit/Delete" flat="true">
        <action id="a1" whenKeySelected="true" commandName="Edit" commandArgument="editForm1" cssClass="EditIcon" whenView="grid1" />
        <action id="a2" whenKeySelected="true" commandName="Delete" cssClass="DeleteIcon" whenView="grid1" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
    <businessRules>
      <rule id="r100" commandName="Calculate" type="JavaScript" phase="Execute" name="CalculateLineCost">	
  var q = [Qty];
  var ic = [ReqItemCost];
  [LineValue]=q * ic;
</rule>
      <rule id="r101" commandName="Calculate" type="Code" phase="Execute" name="GetSizeCost" />
      <rule id="r103" commandName="Insert|Update" type="Code" phase="Execute" name="HideLocalFields" />
      <rule id="r104" commandName="Insert|Update|Delete" type="Code" phase="After" name="RefreshMaster" />
      <rule id="r105" commandName="Email" type="Code" phase="After" name="ConfirmEmail" />
      <rule id="r106" commandName="Email" type="Email" phase="Execute" name="AskAQuestion" commandArgument="Ask">From: "{Parameters_Forname} {Parameters_Surname}" {Parameters_OfficerEmail}
To: {Parameters_AskEmail}
Subject: {Parameters_Subject}
&lt;html&gt;
&lt;body&gt;
&lt;p&gt;
{Parameters_OfficerEmailHeader}
{Parameters_Message}
{Parameters_OfficerEmailFooter}
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</rule>
      <rule id="r107" commandName="New" type="Code" phase="Execute" name="GetDefaults" />
      <rule id="r102" commandName="Insert|Update" type="JavaScript" phase="Execute" name="UpdateStaffProfile">// Check the size selected against the default one 
// and set the updateStaffProfile if it needs to be updated on Dispatch
// if no entry in staff profile it will create one
debugger;

var sizeCode = [SizeCode];
var profileSizeCode = [Local_StaffProfileSize];
var itemCode = [ItemCode];
var type =[Type]

if (type != "N")
{
  if (profileSizeCode == null)
{
  [UpdateStaffProfile] = "Y";
}

else if (sizeCode != profileSizeCode) 
{
  success = this.result.confirm(
    'Update Staff History for {0} change from {1} to {2} ? ',itemCode,profileSizeCode,sizeCode);
  if (success) {
    [UpdateStaffProfile] = "Y";
  }
}
}
</rule>
      <rule id="r108" commandName="Email" commandArgument="Ask" type="JavaScript" phase="After" name="AllowMessageDisplay">this.preventDefault(); // #1585</rule>
      <rule id="r109" commandName="Insert|Update" view="nonStockForm|editForm1" type="JavaScript" phase="Before" name="CheckMandatoryFields">debugger;
var fieldValue = [glCode];
var lineType = [Type];
if ((fieldValue == null)  &amp;&amp; (lineType == "N")){
    // prevent the default action processing
    this.preventDefault();
    // set the focus on the field and display an error
    this.result.focus('glCode', 'GL Code Required');
  	return
}

    fieldValue = [BudgetCode];

if ((fieldValue == null)  &amp;&amp; (lineType == "N")){
    // prevent the default action processing
    this.preventDefault();
    // set the focus on the field and display an error
    this.result.focus('BudgetCode', 'Budget Code Required');
  	return
}

    fieldValue = [Description];
if ((fieldValue == null)  &amp;&amp; (lineType == "N")){
    // prevent the default action processing
    this.preventDefault();
    // set the focus on the field and display an error
    this.result.focus('Description', 'Description Required');
  	return
}

  var q = [Qty];
  var ic = [ReqItemCost];
  [LineValue]=q * ic;</rule>
    </businessRules>
  </dataController>
  <dataController name="TrolleyLineLocation" conflictDetection="overwriteChanges" label="Opexrq Trolley Item Location" nativeSchema="opex" nativeTableName="rq_trolley_item_location" handler="TrolleyLineLocationBusinessRules" generateDataAccessObjects="true">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`rq_trolley_item_location`.`rowid` `Rowid`
	,`rq_trolley_item_location`.`item_code` `ItemCode`
	,`item`.`sti_desc` `ItemStiDesc`
	,`rq_trolley_item_location`.`size_code` `SizeCode`
	,`rq_trolley_item_location`.`qty` `Qty`
	,`rq_trolley_item_location`.`comment_code` `CommentCode`
	,`comment`.`comment_desc` `CommentDesc`
	,`rq_trolley_item_location`.`line_value` `LineValue`
	,`rq_trolley_item_location`.`req_item_cost` `ReqItemCost`
	,`rq_trolley_item_location`.`requested_by` `RequestedBy`
	,`requested_by`.`staff_code` `RequestedbyStaffCode`
	,`requested_by`.`surname` `RequestedbySurname`
	,`rq_trolley_item_location`.`requested_date` `RequestedDate`
	,`rq_trolley_item_location`.`location_code` `LocationCode`
	,`rq_trolley_item_location`.`type` `Type`
	,`rq_trolley_item_location`.`description` `Description`
	,`rq_trolley_item_location`.`additional_information` `AdditionalInformation`
	,`rq_trolley_item_location`.`gl_code` `glCode`
	,`rq_trolley_item_location`.`budget_code` `BudgetCode`
	,`rq_trolley_item_location`.`supplier` `Supplier`
from `opex`.`rq_trolley_item_location` `rq_trolley_item_location`
	left join `opex`.`st_item` `item` on `rq_trolley_item_location`.`item_code` = `item`.`item_code`
	left join `opex`.`rq_comms` `comment` on `rq_trolley_item_location`.`comment_code` = `comment`.`comment_code`
	left join `opex`.`rq_staff` `requested_by` on `rq_trolley_item_location`.`requested_by` = `requested_by`.`staff_uid`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="Rowid" type="Int32" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="ItemCode" type="String" label="Item Code" length="16" showInSummary="true" causesCalculate="true">
        <items style="Lookup" dataController="ItemCatalogueLocation" dataValueField="ItemCode" dataTextField="ItemCode" dataView="grid1" copy="ItemStiDesc = ItemStiDesc&#xD;&#xA;CommentCode = ChargeCode&#xD;&#xA;CommentDesc = ChargeCodeDescription" />
      </field>
      <field name="ItemStiDesc" type="String" readOnly="true" label="Item Description" length="75" />
      <field name="SizeCode" type="String" label="Size" length="20" showInSummary="true" contextFields="ItemCode=ItemCode" causesCalculate="true">
        <items style="Lookup" dataController="ItemSize" dataView="grid1" dataTextField="SizeCode" dataValueField="SizeCode" copy="ReqItemCost=Local_OPEXCost" />
      </field>
      <field name="Qty" type="Decimal" label="Qty" showInSummary="true">
        <codeDefault>1</codeDefault>
      </field>
      <field name="CommentCode" type="String" label="Reason Code" length="3" showInSummary="true" allowNulls="false">
        <items style="Lookup" dataController="ReasonCodes" dataValueField="CommentCode" dataTextField="CommentDesc" />
      </field>
      <field name="CommentDesc" type="String" readOnly="true" label="Reason" length="20" />
      <field name="LineValue" type="Decimal" allowNulls="false" label="Total Cost" showInSummary="true" dataFormatString="C2" />
      <field name="ReqItemCost" type="Decimal" allowNulls="false" dataFormatString="c" label="Item Cost" />
      <field name="RequestedBy" type="UInt32" allowNulls="false" label="Requested By">
        <items style="Lookup" dataController="Staff" newDataView="createForm1" dataValueField="StaffUid" dataTextField="StaffCode" copy="RequestedbySurname=Surname" />
        <codeDefault>Officer.staffRecord.StaffUid</codeDefault>
      </field>
      <field name="RequestedbyStaffCode" type="String" readOnly="true" label="Requested By" length="8" />
      <field name="RequestedbySurname" type="String" readOnly="true" label="Surname" length="30" />
      <field name="RequestedDate" type="DateTime" label="Requested Date" />
      <field name="LocationCode" type="String" allowNulls="false" label="Location Code" length="8" />
      <field name="Type" type="String" label="Type" length="1" />
      <field name="Description" type="String" label="Description" length="500" />
      <field name="AdditionalInformation" type="String" label="Additional Information" length="200" />
      <field name="glCode" type="String" label="GL Code" length="12">
        <items style="Lookup" dataController="GlCodes" dataView="grid1" dataTextField="GlCode" dataValueField="GlCode" />
      </field>
      <field name="BudgetCode" type="String" label="Budget Code" length="8">
        <items style="Lookup" dataController="RqBudcd" dataView="grid1" dataTextField="BudgetCode" dataValueField="BudgetCode" />
      </field>
      <field name="Supplier" type="String" label="Supplier" length="20" />
      <field name="Local_Description" type="String" label="Description" computed="true" isVirtual="true" length="75">
        <formula>CASE 
WHEN `rq_trolley_item_location`.`type` = "N" THEN
`rq_trolley_item_location`.`description`
ELSE 
`item`.`sti_desc` 
END</formula>
      </field>
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Location Trolley">
        <headerText>This is a list of items in the Location Trolley, click the three dots next to the item code to modify</headerText>
        <dataFields>
          <dataField fieldName="ItemCode" tag="lookup-details-hidden">
          </dataField>
          <dataField fieldName="Local_Description" rows="5" />
          <dataField fieldName="SizeCode" columns="20" tag="lookup-details-hidden">
          </dataField>
          <dataField fieldName="Qty" columns="15" />
          <dataField fieldName="ReqItemCost" columns="15" />
          <dataField fieldName="LineValue" columns="15" />
          <dataField fieldName="CommentCode" aliasFieldName="CommentDesc" tag="lookup-details-hidden">
          </dataField>
          <dataField fieldName="RequestedBy" aliasFieldName="RequestedbyStaffCode" />
          <dataField fieldName="RequestedbySurname" columns="30" />
          <dataField fieldName="RequestedDate" columns="10" />
          <dataField fieldName="Type" columns="1" hidden="true">
          </dataField>
          <dataField fieldName="AdditionalInformation" />
          <dataField fieldName="glCode" columns="12" />
          <dataField fieldName="BudgetCode" columns="8" />
          <dataField fieldName="Supplier" columns="20" />
          <dataField fieldName="LocationCode" columns="8" hidden="true">
          </dataField>
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Trolly Item">
        <headerText>You can update this trolley item here</headerText>
        <categories>
          <category id="c1">
            <description />
            <dataFields>
              <dataField fieldName="LocationCode" columns="8" hidden="true">
              </dataField>
              <dataField fieldName="ItemCode" tag="lookup-details-hidden">
                <visibility>
                  <expression test="[Type] == &quot;S&quot;" type="ClientScript" />
                </visibility>
              </dataField>
              <dataField fieldName="SizeCode" columns="20" tag="lookup-details-hidden">
                <visibility>
                  <expression test="[Type] == &quot;S&quot;" type="ClientScript" />
                </visibility>
              </dataField>
              <dataField fieldName="Qty" columns="15" />
              <dataField fieldName="CommentCode" aliasFieldName="CommentDesc" tag="lookup-details-hidden">
              </dataField>
              <dataField fieldName="ReqItemCost" columns="15" textMode="Text">
                <readOnly>
                  <expression test="[Type] == &quot;S&quot;" type="ClientScript" />
                </readOnly>
              </dataField>
              <dataField fieldName="Description">
                <visibility>
                  <expression test="[Type] == &quot;N&quot;" type="ClientScript" />
                </visibility>
              </dataField>
              <dataField fieldName="AdditionalInformation" />
              <dataField fieldName="LineValue" columns="15">
                <visibility>
                  <expression test="[Type] == &quot;S&quot;" type="ClientScript" />
                </visibility>
              </dataField>
              <dataField fieldName="glCode" columns="12" />
              <dataField fieldName="BudgetCode" columns="8" />
              <dataField fieldName="Supplier" columns="20" />
              <dataField fieldName="Type" columns="1" hidden="true">
              </dataField>
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="Add Item to Trolley">
        <headerText>Add Items to Location Trolley</headerText>
        <categories>
          <category id="c1">
            <description />
            <dataFields>
              <dataField fieldName="ItemCode" aliasFieldName="ItemStiDesc" tag="lookup-details-hidden">
              </dataField>
              <dataField fieldName="SizeCode" columns="20">
              </dataField>
              <dataField fieldName="Qty" columns="15" />
              <dataField fieldName="CommentCode" aliasFieldName="CommentDesc" tag="lookup-details-hidden">
              </dataField>
              <dataField fieldName="ReqItemCost" columns="15" textMode="Static">
              </dataField>
              <dataField fieldName="LineValue" columns="15" textMode="Static">
              </dataField>
              <dataField fieldName="AdditionalInformation" />
              <dataField fieldName="glCode" columns="12" />
              <dataField fieldName="BudgetCode" columns="8" />
              <dataField fieldName="Supplier" columns="20" />
            </dataFields>
          </category>
          <category headerText="Hidden" id="c2">
            <visibility>
              <expression test="false" type="ClientScript" />
            </visibility>
            <dataFields>
              <dataField fieldName="LocationCode" columns="8" />
              <dataField fieldName="RequestedBy" hidden="true">
              </dataField>
              <dataField fieldName="RequestedbySurname" columns="30" />
              <dataField fieldName="RequestedDate" columns="10" />
              <dataField fieldName="Type" columns="1" />
              <dataField fieldName="Description">
                <headerText>Additional Information</headerText>
              </dataField>
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="nonStockForm" type="Form" commandId="command1" label="Add Item to Trolley">
        <headerText>Add Items to Location Trolley</headerText>
        <categories>
          <category id="c1" headerText="Add Description and Qty of the Item">
            <description />
            <dataFields>
              <dataField fieldName="Type" columns="1" hidden="true">
              </dataField>
              <dataField fieldName="Description" />
              <dataField fieldName="Qty" columns="15" />
              <dataField fieldName="CommentCode" aliasFieldName="CommentDesc" tag="lookup-details-hidden">
              </dataField>
              <dataField fieldName="glCode" columns="12" />
              <dataField fieldName="BudgetCode" columns="8" />
              <dataField fieldName="Supplier" columns="20" />
              <dataField fieldName="ReqItemCost" columns="15" textMode="Text">
              </dataField>
              <dataField fieldName="AdditionalInformation" />
            </dataFields>
          </category>
          <category headerText="Hidden" id="c2">
            <visibility>
              <expression test="false" type="ClientScript" />
            </visibility>
            <dataFields>
              <dataField fieldName="LocationCode" columns="8" />
              <dataField fieldName="RequestedBy" hidden="true">
              </dataField>
              <dataField fieldName="RequestedbySurname" columns="30" />
              <dataField fieldName="RequestedDate" columns="10" />
              <dataField fieldName="SizeCode" columns="20" />
              <dataField fieldName="ItemCode" aliasFieldName="ItemStiDesc" tag="lookup-details-hidden">
              </dataField>
              <dataField fieldName="LineValue" columns="15" textMode="Static">
              </dataField>
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid" flat="false">
        <action id="a1" commandName="Select" commandArgument="editForm1" headerText="More Information" />
        <action id="a2" commandName="Edit" commandArgument="editForm1" />
        <action id="a3" commandName="Delete" />
        <action id="a8" commandName="Duplicate" commandArgument="createForm1" />
        <action commandName="Email" id="a101" headerText="Ask A Question" description="Ask a Question ?" commandArgument="Ask" confirmation="_controller=OfficerEmailPrompt&#xD;&#xA;_title=Ask Question about an Item&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" causesValidation="false" whenKeySelected="false" cssClass="glyphicon-question-sign" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a1" commandName="Edit" />
        <action id="a2" commandName="Delete" />
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
        <action commandName="Email" id="a101" headerText="Ask A Question" description="Ask a Question ?" commandArgument="Ask" confirmation="_controller=OfficerEmailPrompt&#xD;&#xA;_title=Ask Question about an Item&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" causesValidation="false" whenKeySelected="false" cssClass="glyphicon-question-sign" />
      </actionGroup>
      <actionGroup id="ag3" scope="ActionBar" headerText="New" flat="true">
        <action id="a1" commandName="New" commandArgument="createForm1" cssClass="NewIcon" headerText="Add Item" />
        <action id="a100" commandName="New" commandArgument="nonStockForm" cssClass="NewIcon" headerText="Add Non Stock Item" />
      </actionGroup>
      <actionGroup id="ag4" scope="ActionBar" headerText="Edit/Delete" flat="true">
        <action id="a1" whenKeySelected="true" commandName="Edit" commandArgument="editForm1" cssClass="EditIcon" whenView="grid1" />
        <action id="a2" whenKeySelected="true" commandName="Delete" cssClass="DeleteIcon" whenView="grid1" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
    <businessRules>
      <rule id="r100" commandName="Calculate" type="JavaScript" phase="Execute" name="CalculateLineCost">var q = [Qty];
var ic = [ReqItemCost];
[LineValue]=q * ic;</rule>
      <rule id="r101" commandName="Calculate" type="Code" phase="Execute" name="GetSizeCost" />
      <rule id="r103" commandName="Insert|Update" type="Code" phase="Execute" name="HideLocalFields" />
      <rule id="r104" commandName="Insert|Update|Delete" type="Code" phase="After" name="RefreshMaster" />
      <rule id="r105" commandName="Email" type="Code" phase="After" name="ConfirmEmail" />
      <rule id="r106" commandName="Email" type="Email" phase="Execute" name="AskAQuestion" commandArgument="Ask">From: "{Parameters_Forname} {Parameters_Surname}" {Parameters_OfficerEmail}
To: {Parameters_AskEmail}
Subject: {Parameters_Subject}
&lt;html&gt;
&lt;body&gt;
&lt;p&gt;
{Parameters_OfficerEmailHeader}
{Parameters_Message}
{Parameters_OfficerEmailFooter}
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</rule>
      <rule id="r107" commandName="New" type="Code" phase="Execute" name="GetDefaults" />
      <rule id="r108" commandName="Update" type="Code" phase="Execute" name="UpdateRequester" />
      <rule id="r102" commandName="Email" commandArgument="Ask" type="JavaScript" phase="After" name="AllowMessageDisplay">this.preventDefault(); // #1585</rule>
      <rule id="r109" commandName="Insert|Update" view="nonStockForm|editForm1" type="JavaScript" phase="Before" name="CheckMandatoryFields">debugger;
var fieldValue = [glCode];
var lineType = [Type];
if ((fieldValue == null)  &amp;&amp; (lineType == "N")){
    // prevent the default action processing
    this.preventDefault();
    // set the focus on the field and display an error
    this.result.focus('glCode', 'GL Code Required');
  	return
}

    fieldValue = [BudgetCode];

if ((fieldValue == null)  &amp;&amp; (lineType == "N")){
    // prevent the default action processing
    this.preventDefault();
    // set the focus on the field and display an error
    this.result.focus('BudgetCode', 'Budget Code Required');
  	return
}

    fieldValue = [Description];
if ((fieldValue == null)  &amp;&amp; (lineType == "N")){
    // prevent the default action processing
    this.preventDefault();
    // set the focus on the field and display an error
    this.result.focus('Description', 'Description Required');
  	return
}

  var q = [Qty];
  var ic = [ReqItemCost];
  [LineValue]=q * ic;</rule>
    </businessRules>
  </dataController>
  <dataController name="TrolleyLocation" conflictDetection="overwriteChanges" label="Opexrq Trolley Location" nativeSchema="opex" nativeTableName="rq_trolley_location" handler="TrolleyLocationBusinessRules" generateDataAccessObjects="true">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`rq_trolley_location`.`date_required` `DateRequired`
	,`rq_trolley_location`.`status_code` `StatusCode`
	,`rq_trolley_location`.`header_value` `HeaderValue`
	,`rq_trolley_location`.`urgent_req` `UrgentReq`
	,`rq_trolley_location`.`free_text` `FreeText`
	,`rq_trolley_location`.`budget_code` `BudgetCode`
	,`budget`.`budget_desc` `BudgetDesc`
	,`rq_trolley_location`.`del_location_id` `DelLocationID`
	,`del_location`.`sla_acc` `DelLocationSlaAcc`
	,`del_location`.`sla_nam` `DelLocationSlaNam`
	,`rq_trolley_location`.`default_comment_code` `DefaultCommentCode`
	,`default_comment`.`comment_desc` `DefaultCommentDesc`
	,`rq_trolley_location`.`location_code` `LocationCode`
	,`location`.`location_code` `LocationCode1`
	,`rq_trolley_location`.`email` `Email`
	,`rq_trolley_location`.`rowid` `Rowid`
from `opex`.`rq_trolley_location` `rq_trolley_location`
	left join `opex`.`rq_budcd` `budget` on `rq_trolley_location`.`budget_code` = `budget`.`budget_code`
	left join `opex`.`locations` `del_location` on `rq_trolley_location`.`del_location_id` = `del_location`.`del_location_id`
	left join `opex`.`rq_comms` `default_comment` on `rq_trolley_location`.`default_comment_code` = `default_comment`.`comment_code`
	left join `opex`.`rq_locns` `location` on `rq_trolley_location`.`location_code` = `location`.`location_code`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="DateRequired" type="DateTime" label="Date Required" showInSummary="true" />
      <field name="StatusCode" type="String" label="Status Code" length="2" showInSummary="true" />
      <field name="HeaderValue" type="Decimal" allowNulls="false" label="Header Value" showInSummary="true" readOnly="true" dataFormatString="C2" />
      <field name="UrgentReq" type="String" label="Urgent Req" length="1" showInSummary="true" />
      <field name="FreeText" type="String" label="Free Text" length="255" showInSummary="true" />
      <field name="BudgetCode" type="String" label="Budget Code" length="8">
        <items style="Lookup" dataController="RqBudcd" newDataView="createForm1" dataValueField="BudgetCode" dataTextField="BudgetDesc" />
      </field>
      <field name="BudgetDesc" type="String" readOnly="true" label="Budget Desc" length="50" />
      <field name="DelLocationID" type="UInt32" label="Del Location Id">
        <items style="Lookup" dataController="Opexlocations" dataValueField="DelLocationID" dataTextField="SlaNam" copy="DelLocationSlaNam=SlaNam&#xD;&#xA;DelLocationSlaAcc=SlaAcc&#xD;&#xA;" dataView="grid1" />
      </field>
      <field name="DelLocationSlaAcc" type="String" readOnly="true" label="Del Location Sla Acc" length="8" />
      <field name="DelLocationSlaNam" type="String" readOnly="true" label="Deliver To" length="75" />
      <field name="DefaultCommentCode" type="String" label="Default Reason Code" length="3">
        <items style="Lookup" dataController="ReasonCodes" newDataView="createForm1" dataValueField="CommentCode" dataTextField="CommentDesc" />
      </field>
      <field name="DefaultCommentDesc" type="String" readOnly="true" label="Default Comment Desc" length="20" />
      <field name="LocationCode" type="String" allowNulls="false" label="Location Code" length="8" readOnly="true">
        <items style="Lookup" dataController="OpexrqLocns" newDataView="createForm1" dataValueField="LocationCode" dataTextField="LocationCode" copy="LocationCode1=LocationCode" />
      </field>
      <field name="LocationCode1" type="String" readOnly="true" label="Location Code" length="8" />
      <field name="Email" type="String" label="Delivery Advice" length="255" />
      <field name="Rowid" type="UInt32" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="Local_TrolleyCount" type="UInt32" label="Items in Trolley" computed="true" dataFormatString="N0">
        <formula>select count(*) from rq_trolley_item_location t where t.location_code = `rq_trolley_location`.`location_code`</formula>
      </field>
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Delivery Information">
        <headerText>Delivery Information</headerText>
        <dataFields>
          <dataField fieldName="LocationCode" columns="8">
          </dataField>
          <dataField fieldName="DelLocationSlaNam" columns="50" rows="5">
          </dataField>
          <dataField fieldName="DateRequired" columns="10" />
          <dataField fieldName="FreeText" columns="50" rows="5">
          </dataField>
          <dataField fieldName="DefaultCommentCode" columns="3" hidden="true">
          </dataField>
          <dataField fieldName="Local_TrolleyCount" columns="15" />
          <dataField fieldName="HeaderValue" columns="15" />
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Location Trolley">
        <headerText>You can modify the delivery details and add a default reason code here</headerText>
        <categories>
          <category id="c1" headerText="Delivery Details" tab="Delivery">
            <description />
            <dataFields>
              <dataField fieldName="DelLocationID" aliasFieldName="DelLocationSlaNam">
              </dataField>
              <dataField fieldName="DateRequired" columns="10" />
              <dataField fieldName="FreeText" />
              <dataField fieldName="DefaultCommentCode" aliasFieldName="DefaultCommentDesc">
              </dataField>
            </dataFields>
          </category>
          <category headerText="Costs + Budget" id="c3" tab="Costs + Budget">
            <dataFields>
              <dataField fieldName="HeaderValue" columns="15" />
              <dataField fieldName="BudgetCode" columns="8" />
              <dataField fieldName="BudgetDesc" columns="50" />
            </dataFields>
          </category>
          <category headerText="Hidden" id="c2" tab="Hidden">
            <dataFields>
              <dataField fieldName="StatusCode" columns="2" />
              <dataField fieldName="UrgentReq" columns="1" />
              <dataField fieldName="Email" />
            </dataFields>
            <visibility>
              <expression test="false" type="ClientScript" />
            </visibility>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexrq Trolley Location">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="DateRequired" columns="10" />
              <dataField fieldName="StatusCode" columns="2" />
              <dataField fieldName="HeaderValue" columns="15" />
              <dataField fieldName="UrgentReq" columns="1" />
              <dataField fieldName="FreeText" />
              <dataField fieldName="BudgetCode" aliasFieldName="BudgetDesc" />
              <dataField fieldName="DelLocationID" aliasFieldName="DelLocationSlaAcc" />
              <dataField fieldName="DelLocationSlaNam" />
              <dataField fieldName="DefaultCommentCode" aliasFieldName="DefaultCommentDesc" />
              <dataField fieldName="LocationCode" columns="8" />
              <dataField fieldName="LocationCode1" columns="8" />
              <dataField fieldName="Email" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag2" scope="Form">
        <action id="a1" commandName="Edit" />
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag4" scope="ActionBar" headerText="Edit/Delete" flat="true">
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag100" scope="ActionBar" headerText="Trolley Actions" flat="true">
        <action id="a1" whenKeySelected="true" commandName="Edit" commandArgument="editForm1" cssClass="EditIcon" whenView="grid1" />
        <action commandName="Custom" commandArgument="FullScreen" headerText="Show Catalogue" id="a102" description="Full Screen" causesValidation="false" cssClass="material-icon-view-module" />
        <action commandName="Custom" commandArgument="SubmitLocationTrolley" headerText="Submit Trolley" causesValidation="false" id="a100" confirmation="This will submit all the items in your trolley for approval and dispatch" cssClass="material-icon-shopping-cart" whenView="grid1" />
      </actionGroup>
      <actionGroup id="ag1" scope="Grid" flat="false">
        <action commandName="Custom" commandArgument="FullScreen" headerText="Show Catalogue" id="a102" description="Full Screen" causesValidation="false" cssClass="material-icon-view-module" />
        <action id="a1" commandName="Select" commandArgument="editForm1" headerText="More Information" />
        <action id="a2" commandName="Edit" commandArgument="editForm1" />
      </actionGroup>
    </actions>
    <businessRules>
      <rule id="r100" commandName="Custom" commandArgument="SubmitLocationTrolley" type="Code" phase="Execute" name="SubmitLocationTrolley" />
      <rule id="r103" commandName="Custom" commandArgument="FullScreen" type="JavaScript" phase="Execute" name="FullScreen">debugger;
$app.touch.show({ controller: 'ItemCatalogueLocation', view: 'grid1' });</rule>
    </businessRules>
  </dataController>
  <dataController name="RequisitionText" conflictDetection="overwriteChanges" label="Requisition Text" nativeSchema="opex" nativeTableName="rq_txitm" handler="RequisitionTextBusinessRules" generateDataAccessObjects="false">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`rq_txitm`.`rowid` `Rowid`
	,`rq_txitm`.`rq_header` `RqHeader`
	,`rq_header`.`staff_code` `RqHeaderstaffCode`
	,`rq_header`.`location_code` `rqHeaderLocationCode`
	,`rq_header`.`rqn_prefix` `rqHeaderRqnPrefix`
	,`rq_header`.`staff_uid` `rqHeaderStaffUid`
	,`rq_txitm`.`rqt_desc` `RqtDesc`
	,`rq_txitm`.`rqt_notes` `RqtNotes`
	,`rq_txitm`.`rqt_qty` `RqtQty`
	,`rq_txitm`.`rqt_value` `RqtValue`
	,`rq_txitm`.`rqt_act_val` `RqtActVal`
	,`rq_txitm`.`comment_code` `CommentCode`
	,`comment`.`comment_desc` `CommentDesc`
	,`rq_txitm`.`status` `Status`
	,`rq_status`.`status_description` `rqStatusDescription`
	,`rq_txitm`.`date_entered` `DateEntered`
	,`rq_txitm`.`date_approved` `DateApproved`
	,`rq_txitm`.`date_completed` `DateCompleted`
	,`rq_txitm`.`gl_code` `GlCode`
	,`rq_txitm`.`line_value` `LineValue`
	,`rq_txitm`.`actual_line_value` `ActualLineValue`
	,`rq_txitm`.`budget_ind` `BudgetInd`
	,`budget_ind`.`budget_desc` `BudgetIndbudgetDesc`
	,`rq_txitm`.`po_header_id` `PoHeaderID`
	,`requested_by`.`surname` `RequestedbySurname`
	,`requested_by`.`staff_code` `RequestedbyStaffCode`
from `opex`.`rq_txitm` `rq_txitm`
	left join `opex`.`rq_rqns` `rq_header` on `rq_txitm`.`rq_header` = `rq_header`.`rowid`
	left join `opex`.`rq_comms` `comment` on `rq_txitm`.`comment_code` = `comment`.`comment_code`
	left join `opex`.`rq_budcd` `budget_ind` on `rq_txitm`.`budget_ind` = `budget_ind`.`budget_code`
	left join `opex`.`rq_staff` `requested_by` on `rq_txitm`.`requested_by` = `requested_by`.`staff_uid`
	left join `opex`.`rq_status` `rq_status` on `rq_txitm`.`status` = `rq_status`.`status_code`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="Rowid" type="Int32" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="RqHeader" type="Int32" allowNulls="false" label="Requisition" showInSummary="true" />
      <field name="RqHeaderstaffCode" type="String" readOnly="true" label="Rq Header Staff Code" length="8" />
      <field name="rqHeaderLocationCode" type="String" readOnly="true" label="rq Header Location Code" length="8" />
      <field name="rqHeaderRqnPrefix" type="String" readOnly="true" label="Requisition Number" length="2" />
      <field name="rqHeaderStaffUid" type="UInt32" readOnly="true" label="StaffID" />
      <field name="RqtDesc" type="String" label="Description" length="2000" showInSummary="true" />
      <field name="RqtNotes" type="String" label="Additional Information" length="250" showInSummary="true" />
      <field name="RqtQty" type="Int32" allowNulls="false" label="Qty" showInSummary="true" />
      <field name="RqtValue" type="Decimal" allowNulls="false" label="Unit Cost" showInSummary="true" dataFormatString="C2" />
      <field name="RqtActVal" type="Decimal" label="Actual Unit Cost" />
      <field name="CommentCode" type="String" label="Reason Code" length="3">
        <items style="Lookup" dataController="ReasonCodes" newDataView="createForm1" dataValueField="CommentCode" dataTextField="CommentDesc" />
      </field>
      <field name="CommentDesc" type="String" readOnly="true" label="Reason" length="20" />
      <field name="Status" type="String" label="Status Code" length="2" />
      <field name="rqStatusDescription" type="String" readOnly="true" label="Status" length="50" />
      <field name="DateEntered" type="DateTime" label="Date Entered" />
      <field name="DateApproved" type="DateTime" label="Date Approved" />
      <field name="DateCompleted" type="DateTime" label="Date Completed" />
      <field name="GlCode" type="String" label="GL Code" length="12" />
      <field name="LineValue" type="Decimal" label="Line Value" dataFormatString="C2" />
      <field name="ActualLineValue" type="Decimal" label="Actual Line Value" />
      <field name="BudgetInd" type="String" label="Budget Code" length="8">
        <items style="Lookup" dataController="RqBudcd" newDataView="createForm1" dataValueField="BudgetCode" dataTextField="BudgetDesc" />
      </field>
      <field name="BudgetIndbudgetDesc" type="String" readOnly="true" label="Budget" length="50" />
      <field name="PoHeaderID" type="Int32" label="PO Reference" />
      <field name="RequestedbySurname" type="String" readOnly="true" label="Requested by Surname" length="30" />
      <field name="RequestedbyStaffCode" type="String" readOnly="true" label="Requested by Staff Code" length="8" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Non Stock Items (Outstanding)" sortExpression="RqHeader desc" filter="Status in (&quot;SU&quot;,&quot;IS&quot;,&quot;OO&quot;,&quot;PQ&quot;)">
        <headerText>This is a list of non stock items that have been requested</headerText>
        <dataFields>
          <dataField fieldName="RqHeader">
          </dataField>
          <dataField fieldName="RqtDesc" />
          <dataField fieldName="RqtQty" columns="15" />
          <dataField fieldName="RqtValue" columns="15" />
          <dataField fieldName="LineValue" columns="15" />
          <dataField fieldName="Status" aliasFieldName="rqStatusDescription" />
          <dataField fieldName="DateApproved" columns="10" />
          <dataField fieldName="DateCompleted" columns="10" />
          <dataField fieldName="PoHeaderID" columns="15" />
          <dataField fieldName="rqHeaderStaffUid" columns="15" hidden="true">
          </dataField>
          <dataField fieldName="rqHeaderLocationCode" columns="8" hidden="true">
          </dataField>
          <dataField fieldName="rqHeaderRqnPrefix" columns="2" hidden="true">
          </dataField>
          <dataField fieldName="GlCode" columns="12" />
          <dataField fieldName="BudgetInd" columns="8" />
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Requisition Text">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1" headerText="General" tab="General">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="RqHeader">
              </dataField>
              <dataField fieldName="RqtDesc" />
              <dataField fieldName="RqtQty" columns="15" />
              <dataField fieldName="RqtValue" columns="15" />
              <dataField fieldName="LineValue" columns="15" />
              <dataField fieldName="CommentCode" aliasFieldName="CommentDesc" />
              <dataField fieldName="Status" aliasFieldName="rqStatusDescription" />
            </dataFields>
          </category>
          <category headerText="Dates" id="c2" tab="Dates">
            <dataFields>
              <dataField fieldName="DateEntered" columns="10" />
              <dataField fieldName="DateApproved" columns="10" />
              <dataField fieldName="DateCompleted" columns="10" />
            </dataFields>
          </category>
          <category headerText="Detail" id="c3" tab="Detail">
            <dataFields>
              <dataField fieldName="RqtNotes" />
              <dataField fieldName="RequestedbySurname" columns="30" />
              <dataField fieldName="RequestedbyStaffCode" columns="8" />
              <dataField fieldName="BudgetInd" aliasFieldName="BudgetIndbudgetDesc" />
              <dataField fieldName="GlCode" columns="12" />
              <dataField fieldName="PoHeaderID" columns="15" />
            </dataFields>
          </category>
          <category headerText="Hidden" tab="Hidden" id="c4">
            <visibility>
              <expression test="false" type="ClientScript" />
            </visibility>
            <dataFields>
              <dataField fieldName="rqHeaderStaffUid" columns="15" />
              <dataField fieldName="rqHeaderRqnPrefix" columns="2" />
              <dataField fieldName="rqHeaderLocationCode" columns="8" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Requisition Text">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="RqHeader" aliasFieldName="RqHeaderstaffCode" />
              <dataField fieldName="rqHeaderLocationCode" columns="8" />
              <dataField fieldName="rqHeaderRqnPrefix" columns="2" />
              <dataField fieldName="rqHeaderStaffUid" columns="15" />
              <dataField fieldName="RqtDesc" />
              <dataField fieldName="RqtNotes" />
              <dataField fieldName="RqtQty" columns="15" />
              <dataField fieldName="RqtValue" columns="15" />
              <dataField fieldName="RqtActVal" columns="15" />
              <dataField fieldName="CommentCode" aliasFieldName="CommentDesc" />
              <dataField fieldName="Status" aliasFieldName="rqStatusDescription" />
              <dataField fieldName="DateEntered" columns="10" />
              <dataField fieldName="DateApproved" columns="10" />
              <dataField fieldName="DateCompleted" columns="10" />
              <dataField fieldName="GlCode" columns="12" />
              <dataField fieldName="LineValue" columns="15" />
              <dataField fieldName="ActualLineValue" columns="15" />
              <dataField fieldName="BudgetInd" aliasFieldName="BudgetIndbudgetDesc" />
              <dataField fieldName="PoHeaderID" columns="15" />
              <dataField fieldName="RequestedbySurname" columns="30" />
              <dataField fieldName="RequestedbyStaffCode" columns="8" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="GridAll" commandId="command1" type="Grid" label="All Non Stock Items" baseViewId="grid1" sortExpression="RqHeader desc" />
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
        <action commandName="Email" id="a101" headerText="Ask A Question" description="Ask a Question ?" commandArgument="Ask" confirmation="_controller=OfficerEmailPrompt&#xD;&#xA;_title=Ask Question about an Item&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" causesValidation="false" whenKeySelected="false" cssClass="glyphicon-question-sign" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag5" scope="ActionBar" headerText="Actions">
        <action id="a1" commandName="ExportCsv" />
        <action id="a2" />
        <action id="a3" commandName="ExportRowset" />
        <action id="a4" commandName="ExportRss" />
        <action id="a5" />
        <action id="a6" commandName="Import" commandArgument="createForm1" />
        <action id="a7" commandName="DataSheet" />
        <action id="a8" commandName="Grid" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag7" scope="ActionBar" headerText="Report">
        <action id="a1" commandName="ReportAsPdf" />
        <action id="a2" commandName="ReportAsImage" />
        <action id="a3" commandName="ReportAsExcel" />
        <action id="a4" commandName="ReportAsWord" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
    <businessRules>
      <rule id="r100" commandName="Email" type="Email" phase="Execute" name="AskAQuestion" commandArgument="Ask">From: "{Parameters_Forname} {Parameters_Surname}" {Parameters_OfficerEmail}
To: {Parameters_AskEmail}
Subject: {Parameters_Subject}
&lt;html&gt;
&lt;body&gt;
&lt;p&gt;
{Parameters_OfficerEmailHeader}
{Parameters_Message}
{Parameters_OfficerEmailFooter}
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</rule>
      <rule id="r102" commandName="Email" type="Code" phase="After" name="ConfirmEmail" />
    </businessRules>
  </dataController>
  <dataController name="SerialNumbersLocation" conflictDetection="overwriteChanges" label="Serial Numbers Location" nativeSchema="opex" nativeTableName="serial_numbers" handler="SerialNumbersLocationBusinessRules" generateDataAccessObjects="false">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`serial_numbers`.`id` `ID`
	,`serial_numbers`.`item_code` `ItemCode`
	,`item`.`sti_desc` `ItemStiDesc`
	,`serial_numbers`.`serial_number` `SerialNumber`
	,`serial_numbers`.`batch_reference` `BatchReference`
	,`batch_reference`.`serial_number` `BatchReferenceSerialNumber`
	,`batch_reference`.`supplier_code` `BatchReferenceSupplierCode`
	,`serial_numbers`.`last_review` `LastReview`
	,`serial_numbers`.`expiry_date` `ExpiryDate`
	,`serial_numbers`.`last_transaction` `LastTransaction`
	,`serial_numbers`.`first_issue` `FirstIssue`
	,`serial_numbers`.`notes` `Notes`
	,`serial_numbers`.`pla_acc` `PlaAcc`
	,`serial_numbers`.`status` `Status`
	,`sn_status`.`status` `snStatus`
	,`serial_numbers`.`staff_code` `StaffCode`
	,`serial_numbers`.`location_code` `LocationCode`
	,`location`.`location_desc` `LocationDesc`
	,`serial_numbers`.`registered` `Registered`
	,`serial_numbers`.`rq_number` `RqNumber`
	,`serial_numbers`.`item_condition_code` `ItemConditionCode`
	,`item_condition`.`description` `ItemConditionDescription`
	,`serial_numbers`.`size_code` `SizeCode`
	,`serial_numbers`.`whse_code` `WhseCode`
	,`whse`.`whse_code` `WhseCode1`
	,`whse`.`stwh_desc` `WhseStwhDesc`
	,`serial_numbers`.`do_not_issue` `DoNotIssue`
	,`serial_numbers`.`req_prefix` `ReqPrefix`
	,`serial_numbers`.`staff_uid` `StaffUid`
	,`staff_u`.`location_code` `StaffUlocationCode`
	,`staff_u`.`staff_code` `StaffuStaffCode`
	,`staff_u`.`epl_number` `StaffuEplNumber`
	,`staff_u`.`surname` `StaffuSurname`
	,`serial_numbers`.`has_actual_value` `HasActualValue`
	,`serial_numbers`.`actual_value` `ActualValue`
	,`serial_numbers`.`disposal_detail_id` `DisposalDetailID`
from `opex`.`serial_numbers` `serial_numbers`
	left join `opex`.`st_item` `item` on `serial_numbers`.`item_code` = `item`.`item_code`
	left join `opex`.`serial_numbers_batch` `batch_reference` on `serial_numbers`.`batch_reference` = `batch_reference`.`rowid`
	left join `opex`.`rq_locns` `location` on `serial_numbers`.`location_code` = `location`.`location_code`
	left join `opex`.`item_condition_status` `item_condition` on `serial_numbers`.`item_condition_code` = `item_condition`.`item_condition_code`
	left join `opex`.`st_whse` `whse` on `serial_numbers`.`whse_code` = `whse`.`whse_code`
	left join `opex`.`rq_staff` `staff_u` on `serial_numbers`.`staff_uid` = `staff_u`.`staff_uid`
	left join `opex`.`sn_status` `sn_status` on `serial_numbers`.`status` = `sn_status`.`code`
</text>
      </command>
      <command id="idIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="ID" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="ID" type="Int32" allowNulls="false" isPrimaryKey="true" label="Id" readOnly="true" />
      <field name="ItemCode" type="String" allowNulls="false" label="Item Code" length="16" showInSummary="true">
        <items style="Lookup" dataController="Item" newDataView="createForm1" dataValueField="ItemCode" dataTextField="StiDesc" />
      </field>
      <field name="ItemStiDesc" type="String" readOnly="true" label="Item" length="75" />
      <field name="SerialNumber" type="String" allowNulls="false" label="Serial Number" length="20" showInSummary="true" />
      <field name="BatchReference" type="Int32" label="Batch Reference" showInSummary="true" />
      <field name="BatchReferenceSerialNumber" type="String" readOnly="true" label="Batch Serial Number" length="20" />
      <field name="BatchReferenceSupplierCode" type="String" readOnly="true" label="Batch Supplier Code" length="10" />
      <field name="LastReview" type="DateTime" label="Last Review" showInSummary="true" />
      <field name="ExpiryDate" type="DateTime" label="Expiry Date" showInSummary="true" />
      <field name="LastTransaction" type="DateTime" label="Last Transaction" />
      <field name="FirstIssue" type="DateTime" label="First Issue" />
      <field name="Notes" type="String" label="Notes" length="600" />
      <field name="PlaAcc" type="String" label="Supplier" length="10" />
      <field name="Status" type="String" label="Status" length="2" />
      <field name="snStatus" type="String" readOnly="true" label="Status" length="20" />
      <field name="StaffCode" type="String" label="Staff Code" length="8" />
      <field name="LocationCode" type="String" label="Location Code" length="8">
        <items style="Lookup" dataController="OpexrqLocns" newDataView="createForm1" dataValueField="LocationCode" dataTextField="LocationDesc" />
      </field>
      <field name="LocationDesc" type="String" readOnly="true" label="Location" length="75" />
      <field name="Registered" type="DateTime" label="Registered" />
      <field name="RqNumber" type="Int32" label="Requisition Number" />
      <field name="ItemConditionCode" type="String" label="Item Condition Code" length="1" />
      <field name="ItemConditionDescription" type="String" readOnly="true" label="Item Condition" length="50" />
      <field name="SizeCode" type="String" label="Size Code" length="20" />
      <field name="WhseCode" type="String" label="Warehouse" length="3" />
      <field name="WhseCode1" type="String" readOnly="true" label="Warehouse" length="3" />
      <field name="WhseStwhDesc" type="String" readOnly="true" label="Whse Stwh Desc" length="32" />
      <field name="DoNotIssue" type="String" label="Do Not Issue" length="1" />
      <field name="ReqPrefix" type="String" label="Req Prefix" length="2" />
      <field name="StaffUid" type="UInt32" label="Staff Id">
        <items style="Lookup" dataController="Staff" newDataView="createForm1" dataValueField="StaffUid" dataTextField="LocationCode" copy="StaffuStaffCode=StaffCode, StaffuEplNumber=EplNumber, StaffuSurname=Surname" />
      </field>
      <field name="StaffUlocationCode" type="String" readOnly="true" label="Staff Location Code" length="8" />
      <field name="StaffuStaffCode" type="String" readOnly="true" label="Staff Code" length="8" />
      <field name="StaffuEplNumber" type="String" readOnly="true" label="Epl Number" length="8" />
      <field name="StaffuSurname" type="String" readOnly="true" label="Surname" length="30" />
      <field name="HasActualValue" type="String" label="Has Actual Value" length="1" />
      <field name="ActualValue" type="Decimal" label="Actual Value" />
      <field name="DisposalDetailID" type="UInt32" label="Disposal Detail" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="All" tags="view-style-grid, &#xD;&#xA;view-style-charts-disabled,&#xD;&#xA;view-style-list-disabled,&#xD;&#xA;view-style-cards-disabled,&#xD;&#xA;multi-select-none" filter="Status in (&quot;I&quot;,&quot;T&quot;)">
        <headerText>This is a list of all items (Issued and Assigned) for this location</headerText>
        <dataFields>
          <dataField fieldName="ItemCode" aliasFieldName="ItemStiDesc" />
          <dataField fieldName="SerialNumber" columns="20" />
          <dataField fieldName="ExpiryDate" columns="10" />
          <dataField fieldName="BatchReference" aliasFieldName="BatchReferenceSerialNumber" hidden="true">
          </dataField>
          <dataField fieldName="BatchReferenceSupplierCode" columns="10" hidden="true">
          </dataField>
          <dataField fieldName="Status" aliasFieldName="snStatus">
          </dataField>
          <dataField fieldName="DoNotIssue" columns="1" hidden="true">
          </dataField>
          <dataField fieldName="snStatus" columns="20" hidden="true">
          </dataField>
          <dataField fieldName="StaffUid" hidden="true">
          </dataField>
          <dataField fieldName="StaffuStaffCode" columns="8" hidden="true">
          </dataField>
          <dataField fieldName="StaffuEplNumber" columns="8">
          </dataField>
          <dataField fieldName="StaffuSurname" columns="30" />
          <dataField fieldName="LocationCode" columns="8" />
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Serial Numbers Location">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1" headerText="Serial Numbers Location">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="ItemCode" aliasFieldName="ItemStiDesc" />
              <dataField fieldName="SerialNumber" columns="20" />
              <dataField fieldName="BatchReference" aliasFieldName="BatchReferenceSerialNumber" />
              <dataField fieldName="BatchReferenceSupplierCode" columns="10" />
              <dataField fieldName="LastReview" columns="10" />
              <dataField fieldName="ExpiryDate" columns="10" />
              <dataField fieldName="LastTransaction" columns="10" />
              <dataField fieldName="FirstIssue" columns="10" />
              <dataField fieldName="Notes" />
              <dataField fieldName="PlaAcc" columns="10" />
              <dataField fieldName="Status" aliasFieldName="snStatus" />
              <dataField fieldName="StaffCode" columns="8" />
              <dataField fieldName="LocationCode" aliasFieldName="LocationDesc" />
              <dataField fieldName="Registered" columns="10" />
              <dataField fieldName="RqNumber" columns="15" />
              <dataField fieldName="ItemConditionCode" aliasFieldName="ItemConditionDescription" />
              <dataField fieldName="SizeCode" columns="20" />
              <dataField fieldName="WhseCode" aliasFieldName="WhseCode1" />
              <dataField fieldName="WhseStwhDesc" columns="32" />
              <dataField fieldName="DoNotIssue" columns="1" />
              <dataField fieldName="ReqPrefix" columns="2" />
              <dataField fieldName="StaffUid" aliasFieldName="StaffUlocationCode" />
              <dataField fieldName="StaffuStaffCode" columns="8" />
              <dataField fieldName="StaffuEplNumber" columns="8" />
              <dataField fieldName="StaffuSurname" columns="30" />
              <dataField fieldName="HasActualValue" columns="1" />
              <dataField fieldName="ActualValue" columns="15" />
              <dataField fieldName="DisposalDetailID" columns="15" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Serial Numbers Location">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="ItemCode" aliasFieldName="ItemStiDesc" />
              <dataField fieldName="SerialNumber" columns="20" />
              <dataField fieldName="BatchReference" aliasFieldName="BatchReferenceSerialNumber" />
              <dataField fieldName="BatchReferenceSupplierCode" columns="10" />
              <dataField fieldName="LastReview" columns="10" />
              <dataField fieldName="ExpiryDate" columns="10" />
              <dataField fieldName="LastTransaction" columns="10" />
              <dataField fieldName="FirstIssue" columns="10" />
              <dataField fieldName="Notes" />
              <dataField fieldName="PlaAcc" columns="10" />
              <dataField fieldName="Status" aliasFieldName="snStatus" />
              <dataField fieldName="StaffCode" columns="8" />
              <dataField fieldName="LocationCode" aliasFieldName="LocationDesc" />
              <dataField fieldName="Registered" columns="10" />
              <dataField fieldName="RqNumber" columns="15" />
              <dataField fieldName="ItemConditionCode" aliasFieldName="ItemConditionDescription" />
              <dataField fieldName="SizeCode" columns="20" />
              <dataField fieldName="WhseCode" aliasFieldName="WhseCode1" />
              <dataField fieldName="WhseStwhDesc" columns="32" />
              <dataField fieldName="DoNotIssue" columns="1" />
              <dataField fieldName="ReqPrefix" columns="2" />
              <dataField fieldName="StaffUid" aliasFieldName="StaffUlocationCode" />
              <dataField fieldName="StaffuStaffCode" columns="8" />
              <dataField fieldName="StaffuEplNumber" columns="8" />
              <dataField fieldName="StaffuSurname" columns="30" />
              <dataField fieldName="HasActualValue" columns="1" />
              <dataField fieldName="ActualValue" columns="15" />
              <dataField fieldName="DisposalDetailID" columns="15" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="gridAssigned" commandId="command1" type="Grid" label="Assigned to Officers" baseViewId="grid1" filter="StaffUlocationCode &lt;&gt; &quot;Location&quot;&#xD;&#xA;AND &#xD;&#xA;Status in (&quot;I&quot;,&quot;T&quot;)" />
      <view id="gridIssued" commandId="command1" type="Grid" label="Issued to Location" baseViewId="grid1" filter="StaffUlocationCode = &quot;Location&quot;&#xD;&#xA;AND &#xD;&#xA;Status in (&quot;I&quot;)" />
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" headerText="Info" />
        <action commandName="Custom" commandArgument="Assign" id="a101" headerText="Assign" whenKeySelected="true" confirmation="_controller=SerialNumbersAssignPrompt&#xD;&#xA;_title=Enter Officer to Assign To&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" whenClientScript="[StaffuStaffCode] == &quot;Location&quot;" />
        <action commandName="Custom" commandArgument="Replace" id="a100" headerText="Replace" whenKeySelected="true" confirmation="_controller=SerialNumbersReplacePrompt&#xD;&#xA;_title=Enter New Serial Number&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" whenClientScript="[StaffuStaffCode] != &quot;Location&quot;&#xD;&#xA;&amp;&amp;&#xD;&#xA;[Status] == &quot;I&quot;" />
        <action commandName="Custom" commandArgument="Return" id="a102" headerText="Return" whenKeySelected="true" whenClientScript="[Status] != &quot;T&quot;" confirmation="Not Implemented" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag5" scope="ActionBar" headerText="Actions">
        <action id="a1" commandName="ExportCsv" />
        <action id="a100" commandName="ReportAsPdf" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag100" scope="ActionBar" headerText="SerialNumberActions" flat="true">
        <action commandName="Custom" commandArgument="Assign" id="a101" headerText="Assign" whenKeySelected="true" confirmation="_controller=SerialNumbersAssignPrompt&#xD;&#xA;_title=Enter Officer to Assign To&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" whenClientScript="[StaffuStaffCode] == &quot;Location&quot;" />
        <action commandName="Custom" commandArgument="Replace" id="a100" headerText="Replace" whenKeySelected="true" confirmation="_controller=SerialNumbersReplacePrompt&#xD;&#xA;_title=Enter New Serial Number&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" whenClientScript="[StaffuStaffCode] != &quot;Location&quot;&#xD;&#xA;&amp;&amp;&#xD;&#xA;[Status] == &quot;I&quot;" />
        <action commandName="Custom" commandArgument="Return" id="a102" headerText="Return" whenKeySelected="true" confirmation="Not Implemented" whenClientScript="[Status] != &quot;T&quot;" />
        <action commandName="ReportAsPdf" id="a103" headerText="Transit Document" whenClientScript="[Status] == &quot;T&quot;" />
      </actionGroup>
    </actions>
    <businessRules>
      <rule id="r100" commandName="Custom" commandArgument="Replace" type="Code" phase="Execute" name="ReplaceSerialItem" />
      <rule id="r101" commandName="Custom" commandArgument="Assign" type="Code" phase="Execute" name="Assign" />
      <rule id="r102" commandName="Report" type="Code" phase="After" />
    </businessRules>
  </dataController>
  <dataController name="SerialNumbersStaff" conflictDetection="overwriteChanges" label="Serial Numbers Staff" nativeSchema="opex" nativeTableName="serial_numbers" handler="SerialNumbersStaffBusinessRules" generateDataAccessObjects="false">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`serial_numbers`.`id` `ID`
	,`serial_numbers`.`item_code` `ItemCode`
	,`item`.`sti_desc` `ItemStiDesc`
	,`serial_numbers`.`serial_number` `SerialNumber`
	,`serial_numbers`.`batch_reference` `BatchReference`
	,`batch_reference`.`whse_code` `BatchReferencewhseCode`
	,`serial_numbers`.`last_review` `LastReview`
	,`serial_numbers`.`expiry_date` `ExpiryDate`
	,`serial_numbers`.`last_transaction` `LastTransaction`
	,`serial_numbers`.`first_issue` `FirstIssue`
	,`serial_numbers`.`notes` `Notes`
	,`serial_numbers`.`pla_acc` `PlaAcc`
	,`serial_numbers`.`status` `Status`
	,`serial_numbers`.`staff_code` `StaffCode`
	,`serial_numbers`.`location_code` `LocationCode`
	,`location`.`location_code` `LocationCode1`
	,`location`.`location_desc` `LocationDesc`
	,`serial_numbers`.`registered` `Registered`
	,`serial_numbers`.`rq_number` `RqNumber`
	,`serial_numbers`.`item_condition_code` `ItemConditionCode`
	,`item_condition`.`description` `ItemConditionDescription`
	,`serial_numbers`.`size_code` `SizeCode`
	,`serial_numbers`.`whse_code` `WhseCode`
	,`whse`.`whse_code` `WhseCode1`
	,`serial_numbers`.`do_not_issue` `DoNotIssue`
	,`serial_numbers`.`req_prefix` `ReqPrefix`
	,`serial_numbers`.`staff_uid` `StaffUid`
	,`staff_u`.`location_code` `StaffUlocationCode`
	,`staff_u`.`staff_code` `StaffuStaffCode`
	,`staff_u`.`epl_number` `StaffuEplNumber`
	,`serial_numbers`.`has_actual_value` `HasActualValue`
	,`serial_numbers`.`actual_value` `ActualValue`
	,`serial_numbers`.`disposal_detail_id` `DisposalDetailID`
from `opex`.`serial_numbers` `serial_numbers`
	left join `opex`.`st_item` `item` on `serial_numbers`.`item_code` = `item`.`item_code`
	left join `opex`.`serial_numbers_batch` `batch_reference` on `serial_numbers`.`batch_reference` = `batch_reference`.`rowid`
	left join `opex`.`rq_locns` `location` on `serial_numbers`.`location_code` = `location`.`location_code`
	left join `opex`.`item_condition_status` `item_condition` on `serial_numbers`.`item_condition_code` = `item_condition`.`item_condition_code`
	left join `opex`.`st_whse` `whse` on `serial_numbers`.`whse_code` = `whse`.`whse_code`
	left join `opex`.`rq_staff` `staff_u` on `serial_numbers`.`staff_uid` = `staff_u`.`staff_uid`
</text>
      </command>
      <command id="idIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="ID" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="ID" type="Int32" allowNulls="false" isPrimaryKey="true" label="Id" readOnly="true" />
      <field name="ItemCode" type="String" allowNulls="false" label="Item Code" length="16" showInSummary="true">
        <items style="Lookup" dataController="Item" newDataView="createForm1" dataValueField="ItemCode" dataTextField="StiDesc" />
      </field>
      <field name="ItemStiDesc" type="String" readOnly="true" label="Item" length="75" />
      <field name="SerialNumber" type="String" allowNulls="false" label="Serial Number" length="20" showInSummary="true" />
      <field name="BatchReference" type="Int32" label="Batch Reference" showInSummary="true" />
      <field name="BatchReferencewhseCode" type="String" readOnly="true" label="Batch Referencewhse Code" length="3" />
      <field name="LastReview" type="DateTime" label="Last Review" showInSummary="true" />
      <field name="ExpiryDate" type="DateTime" label="Expiry Date" showInSummary="true" />
      <field name="LastTransaction" type="DateTime" label="Issued" />
      <field name="FirstIssue" type="DateTime" label="First Issue" />
      <field name="Notes" type="String" label="Notes" length="600" />
      <field name="PlaAcc" type="String" label="Supplier" length="10" />
      <field name="Status" type="String" label="Status" length="2" />
      <field name="StaffCode" type="String" label="Staff Code" length="8" />
      <field name="LocationCode" type="String" label="Location Code" length="8">
        <items style="Lookup" dataController="OpexrqLocns" newDataView="createForm1" dataValueField="LocationCode" dataTextField="LocationCode" copy="LocationDesc=LocationDesc" />
      </field>
      <field name="LocationCode1" type="String" readOnly="true" label="Location Code" length="8" />
      <field name="LocationDesc" type="String" readOnly="true" label="Location" length="75" />
      <field name="Registered" type="DateTime" label="Registered" />
      <field name="RqNumber" type="Int32" label="Requisition Number" />
      <field name="ItemConditionCode" type="String" label="Item Condition Code" length="1" />
      <field name="ItemConditionDescription" type="String" readOnly="true" label="Item Condition" length="50" />
      <field name="SizeCode" type="String" label="Size Code" length="20" />
      <field name="WhseCode" type="String" label="Warehouse" length="3" />
      <field name="WhseCode1" type="String" readOnly="true" label="Warehouse" length="3" />
      <field name="DoNotIssue" type="String" label="Do Not Issue" length="1" />
      <field name="ReqPrefix" type="String" label="Req Prefix" length="2" />
      <field name="StaffUid" type="UInt32" label="Staff Id">
        <items style="Lookup" dataController="Staff" newDataView="createForm1" dataValueField="StaffUid" dataTextField="LocationCode" copy="StaffuStaffCode=StaffCode, StaffuEplNumber=EplNumber" />
      </field>
      <field name="StaffUlocationCode" type="String" readOnly="true" label="Staff Ulocation Code" length="8" />
      <field name="StaffuStaffCode" type="String" readOnly="true" label="Staff u Staff Code" length="8" />
      <field name="StaffuEplNumber" type="String" readOnly="true" label="Staff u Epl Number" length="8" />
      <field name="HasActualValue" type="String" label="Has Actual Value" length="1" />
      <field name="ActualValue" type="Decimal" label="Actual Value" />
      <field name="DisposalDetailID" type="UInt32" label="Disposal Detail" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="PAVA (Issued)" filter="status in ( &quot;I&quot;,&quot;T&quot;)">
        <headerText>This is a list of Issued PAVA's</headerText>
        <dataFields>
          <dataField fieldName="StaffUid" columns="15" hidden="true">
          </dataField>
          <dataField fieldName="ItemCode">
          </dataField>
          <dataField fieldName="ItemStiDesc" rows="5" />
          <dataField fieldName="SerialNumber" columns="20" />
          <dataField fieldName="ExpiryDate" columns="10" />
          <dataField fieldName="Notes" />
          <dataField fieldName="Status" columns="2" />
          <dataField fieldName="StaffCode" columns="8" />
          <dataField fieldName="ItemConditionCode" aliasFieldName="ItemConditionDescription" />
          <dataField fieldName="StaffuEplNumber" columns="8" hidden="true">
          </dataField>
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Serial Numbers Staff">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1" headerText="Serial Numbers Staff">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="ItemCode" aliasFieldName="ItemStiDesc" />
              <dataField fieldName="SerialNumber" columns="20" />
              <dataField fieldName="BatchReference" columns="15" />
              <dataField fieldName="LastTransaction" columns="10">
              </dataField>
              <dataField fieldName="LastReview" columns="10" />
              <dataField fieldName="ExpiryDate" columns="10" />
              <dataField fieldName="FirstIssue" columns="10" />
              <dataField fieldName="PlaAcc" columns="10" />
              <dataField fieldName="Status" columns="2" />
              <dataField fieldName="ItemConditionCode" aliasFieldName="ItemConditionDescription" />
            </dataFields>
          </category>
          <category headerText="Hidden" id="c2" tab="Hidden">
            <visibility>
              <expression test="false" type="ClientScript" />
            </visibility>
            <dataFields>
              <dataField fieldName="BatchReferencewhseCode" columns="3" />
              <dataField fieldName="StaffCode" columns="8" />
              <dataField fieldName="LocationCode" aliasFieldName="LocationCode1" />
              <dataField fieldName="LocationDesc" />
              <dataField fieldName="Registered" columns="10" />
              <dataField fieldName="RqNumber" columns="15" />
              <dataField fieldName="SizeCode" columns="20" />
              <dataField fieldName="WhseCode" columns="3" />
              <dataField fieldName="WhseCode1" columns="3" />
              <dataField fieldName="DoNotIssue" columns="1" />
              <dataField fieldName="ReqPrefix" columns="2" />
              <dataField fieldName="StaffUid" aliasFieldName="StaffUlocationCode" />
              <dataField fieldName="StaffuStaffCode" columns="8" />
              <dataField fieldName="StaffuEplNumber" columns="8" />
              <dataField fieldName="HasActualValue" columns="1" />
              <dataField fieldName="ActualValue" columns="15" />
              <dataField fieldName="DisposalDetailID" columns="15" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Serial Numbers Staff">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="ItemCode" aliasFieldName="ItemStiDesc" />
              <dataField fieldName="SerialNumber" columns="20" />
              <dataField fieldName="BatchReference" columns="15" />
              <dataField fieldName="BatchReferencewhseCode" columns="3" />
              <dataField fieldName="LastReview" columns="10" />
              <dataField fieldName="ExpiryDate" columns="10" />
              <dataField fieldName="LastTransaction" columns="10" />
              <dataField fieldName="FirstIssue" columns="10" />
              <dataField fieldName="Notes" />
              <dataField fieldName="PlaAcc" columns="10" />
              <dataField fieldName="Status" columns="2" />
              <dataField fieldName="StaffCode" columns="8" />
              <dataField fieldName="LocationCode" aliasFieldName="LocationCode1" />
              <dataField fieldName="LocationDesc" />
              <dataField fieldName="Registered" columns="10" />
              <dataField fieldName="RqNumber" columns="15" />
              <dataField fieldName="ItemConditionCode" aliasFieldName="ItemConditionDescription" />
              <dataField fieldName="SizeCode" columns="20" />
              <dataField fieldName="WhseCode" columns="3" />
              <dataField fieldName="WhseCode1" columns="3" />
              <dataField fieldName="DoNotIssue" columns="1" />
              <dataField fieldName="ReqPrefix" columns="2" />
              <dataField fieldName="StaffUid" aliasFieldName="StaffUlocationCode" />
              <dataField fieldName="StaffuStaffCode" columns="8" />
              <dataField fieldName="StaffuEplNumber" columns="8" />
              <dataField fieldName="HasActualValue" columns="1" />
              <dataField fieldName="ActualValue" columns="15" />
              <dataField fieldName="DisposalDetailID" columns="15" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="Info" />
        <action commandName="Custom" commandArgument="Replace" id="a101" headerText="Replace" whenKeySelected="true" confirmation="_controller=SerialNumbersReplacePrompt&#xD;&#xA;_title=Enter New Serial Number&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" />
        <action commandName="Custom" commandArgument="Return" id="a100" headerText="Return" whenKeySelected="true" />
        <action commandName="Custom" commandArgument="Add" id="a102" headerText="Add" whenKeySelected="true" confirmation="_controller=SerialNumbersReplacePrompt&#xD;&#xA;_title=Enter New Serial Number&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag100" scope="ActionBar" headerText="SerialNumberActions" flat="true">
        <action commandName="Custom" commandArgument="Replace" id="a100" headerText="Replace" whenKeySelected="true" confirmation="_controller=SerialNumbersReplacePrompt&#xD;&#xA;_title=Enter New Serial Number&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" />
        <action commandName="Custom" commandArgument="Return" id="a102" headerText="Return" whenKeySelected="true" />
        <action commandName="Custom" commandArgument="Add" id="a101" headerText="Add" whenKeySelected="true" confirmation="_controller=SerialNumbersReplacePrompt&#xD;&#xA;_title=Enter New Serial Number&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" />
      </actionGroup>
    </actions>
    <businessRules>
      <rule id="r100" commandName="Custom" commandArgument="Replace" type="Code" phase="Execute" name="ReplaceSerialItem" />
    </businessRules>
  </dataController>
  <dataController name="opex_site_content" conflictDetection="overwriteChanges" label="Opex Site Content" nativeSchema="opex" nativeTableName="site_content">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`site_content`.`site_content_id` `site_content_id`
	,`site_content`.`file_name` `file_name`
	,`site_content`.`path` `path`
	,`site_content`.`content_type` `content_type`
	,`site_content`.`length` `length`
	,`site_content`.`data` `data`
	,`site_content`.`text` `text`
	,`site_content`.`roles` `roles`
	,`site_content`.`role_exceptions` `role_exceptions`
	,`site_content`.`users` `users`
	,`site_content`.`user_exceptions` `user_exceptions`
	,`site_content`.`schedule` `schedule`
	,`site_content`.`schedule_exceptions` `schedule_exceptions`
	,`site_content`.`cache_profile` `cache_profile`
	,`site_content`.`created_date` `created_date`
	,`site_content`.`modified_date` `modified_date`
from `opex`.`site_content` `site_content`
</text>
      </command>
      <command id="site_content_idIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="site_content_id" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="site_content_id" type="Int32" allowNulls="false" isPrimaryKey="true" label="Site Content Id" readOnly="true" />
      <field name="file_name" type="String" allowNulls="false" label="File Name" length="150" showInSummary="true" />
      <field name="path" type="String" label="Path" length="150" showInSummary="true" />
      <field name="content_type" type="String" label="Content Type" length="150" showInSummary="true" />
      <field name="length" type="Int32" label="Length" showInSummary="true" />
      <field name="data" type="Byte[]" onDemand="true" sourceFields="site_content_id" onDemandHandler="site_contentdata" onDemandStyle="Thumbnail" allowQBE="false" allowSorting="false" label="Data" showInSummary="true" />
      <field name="text" type="String" label="Text" length="0" />
      <field name="roles" type="String" label="Roles" length="100" />
      <field name="role_exceptions" type="String" label="Role Exceptions" length="100" />
      <field name="users" type="String" label="Users" length="100" />
      <field name="user_exceptions" type="String" label="User Exceptions" length="100" />
      <field name="schedule" type="String" label="Schedule" length="150" />
      <field name="schedule_exceptions" type="String" label="Schedule Exceptions" length="150" />
      <field name="cache_profile" type="String" label="Cache Profile" length="50" />
      <field name="created_date" type="DateTime" label="Created Date" />
      <field name="modified_date" type="DateTime" label="Modified Date" />
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Opex Site Content" sortExpression="Path, FileName">
        <headerText>$DefaultGridViewDescription</headerText>
        <dataFields>
          <dataField fieldName="file_name" />
          <dataField fieldName="path" />
          <dataField fieldName="content_type" />
          <dataField fieldName="length" columns="15" />
          <dataField fieldName="data" columns="15" />
          <dataField fieldName="text" columns="0" />
          <dataField fieldName="roles" />
          <dataField fieldName="role_exceptions" />
          <dataField fieldName="users" />
          <dataField fieldName="user_exceptions" />
          <dataField fieldName="schedule" />
          <dataField fieldName="schedule_exceptions" />
          <dataField fieldName="cache_profile" columns="50" />
          <dataField fieldName="created_date" columns="10" />
          <dataField fieldName="modified_date" columns="10" />
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Opex Site Content">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1" headerText="Opex Site Content">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="file_name" />
              <dataField fieldName="path" />
              <dataField fieldName="content_type" />
              <dataField fieldName="length" columns="15" />
              <dataField fieldName="data" columns="15" />
              <dataField fieldName="text" columns="0" />
              <dataField fieldName="roles" />
              <dataField fieldName="role_exceptions" />
              <dataField fieldName="users" />
              <dataField fieldName="user_exceptions" />
              <dataField fieldName="schedule" />
              <dataField fieldName="schedule_exceptions" />
              <dataField fieldName="cache_profile" columns="50" />
              <dataField fieldName="created_date" columns="10" />
              <dataField fieldName="modified_date" columns="10" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opex Site Content">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="file_name" />
              <dataField fieldName="path" />
              <dataField fieldName="content_type" />
              <dataField fieldName="length" columns="15" />
              <dataField fieldName="data" columns="15" />
              <dataField fieldName="text" columns="0" />
              <dataField fieldName="roles" />
              <dataField fieldName="role_exceptions" />
              <dataField fieldName="users" />
              <dataField fieldName="user_exceptions" />
              <dataField fieldName="schedule" />
              <dataField fieldName="schedule_exceptions" />
              <dataField fieldName="cache_profile" columns="50" />
              <dataField fieldName="created_date" columns="10" />
              <dataField fieldName="modified_date" columns="10" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
        <action id="a2" commandName="Edit" />
        <action id="a3" commandName="Delete" />
        <action id="a6" />
        <action id="a7" commandName="New" commandArgument="grid1" />
        <action id="a8" commandName="Duplicate" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a1" commandName="Edit" />
        <action id="a2" commandName="Delete" />
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag3" scope="ActionBar" headerText="New" flat="true">
        <action id="a1" commandName="New" commandArgument="createForm1" cssClass="NewIcon" />
      </actionGroup>
      <actionGroup id="ag4" scope="ActionBar" headerText="Edit/Delete" flat="true">
        <action id="a1" whenKeySelected="true" commandName="Edit" commandArgument="editForm1" cssClass="EditIcon" whenView="grid1" />
        <action id="a2" whenKeySelected="true" commandName="Delete" cssClass="DeleteIcon" whenView="grid1" />
      </actionGroup>
      <actionGroup id="ag5" scope="ActionBar" headerText="Actions">
        <action id="a1" commandName="ExportCsv" />
        <action id="a2" />
        <action id="a3" commandName="ExportRowset" />
        <action id="a4" commandName="ExportRss" />
        <action id="a5" />
        <action id="a6" commandName="Import" commandArgument="createForm1" />
        <action id="a7" commandName="DataSheet" />
        <action id="a8" commandName="Grid" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag7" scope="ActionBar" headerText="Report">
        <action id="a1" commandName="ReportAsPdf" />
        <action id="a2" commandName="ReportAsImage" />
        <action id="a3" commandName="ReportAsExcel" />
        <action id="a4" commandName="ReportAsWord" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="Item" conflictDetection="overwriteChanges" label="Opexst Item" nativeSchema="opex" nativeTableName="st_item">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`st_item`.`rowid` `Rowid`
	,`st_item`.`item_code` `ItemCode`
	,`st_item`.`sti_desc` `StiDesc`
	,`st_item`.`sti_grp1` `StiGrp1`
	,`sti_grp1`.`stg1_grp1_desc` `StiGrp1Stg1Grp1Desc`
	,`st_item`.`sti_grp2` `StiGrp2`
	,`sti_grp2`.`stg2_grp2_desc` `StiGrp2Stg2Grp2Desc`
	,`st_item`.`vat_code` `VatCode`
	,`st_item`.`standard_price` `StandardPrice`
	,`st_item`.`average_cost` `AverageCost`
	,`st_item`.`last_cost` `LastCost`
	,`st_item`.`standard_cost` `StandardCost`
	,`st_item`.`sti_on_stp` `StiOnStp`
	,`st_item`.`sti_stnd_ord_qty` `StiStndOrdQty`
	,`st_item`.`sti_stk_lv` `StiStkLv`
	,`st_item`.`sti_fre_stk` `StiFreStk`
	,`st_item`.`sti_pl_nl_cd` `StiPlNlCd`
	,`st_item`.`sti_cs_nl_cd` `StiCsNlCd`
	,`st_item`.`sti_ci_nl_cd` `StiCiNlCd`
	,`st_item`.`sti_cv_nl_cd` `StiCvNlCd`
	,`st_item`.`sti_disc_cd` `StiDiscCd`
	,`st_item`.`sti_stk_typ` `StiStkTyp`
	,`st_item`.`sti_alt_itm` `StiAltItm`
	,`st_item`.`sti_fifo_low` `StiFifoLow`
	,`st_item`.`sti_fifo_high` `StiFifoHigh`
	,`st_item`.`order_unit` `OrderUnit`
	,`st_item`.`store_unit` `StoreUnit`
	,`st_item`.`price_unit` `PriceUnit`
	,`st_item`.`order_per` `OrderPer`
	,`st_item`.`price_per` `PricePer`
	,`st_item`.`store_per` `StorePer`
	,`st_item`.`size_scale` `SizeScale`
	,`st_item`.`last_receipt_date` `LastReceiptDate`
	,`st_item`.`budget_ind` `BudgetInd`
	,`st_item`.`item_oncost` `ItemOncost`
	,`st_item`.`group_oncost` `GroupOncost`
	,`st_item`.`contract_code` `ContractCode`
	,`st_item`.`max_issue_lv` `MaxIssueLv`
	,`st_item`.`max_order_qty` `MaxOrderQty`
	,`st_item`.`max_stk_lv` `MaxStkLv`
	,`st_item`.`total_issues` `TotalIssues`
	,`st_item`.`frozen_qty` `FrozenQty`
	,`st_item`.`frozen_date` `FrozenDate`
	,`st_item`.`inventory_date` `InventoryDate`
	,`st_item`.`suspense_code` `SuspenseCode`
	,`st_item`.`inventory_code` `InventoryCode`
	,`st_item`.`adjustment_code` `AdjustmentCode`
	,`st_item`.`oncost_code` `OncostCode`
	,`st_item`.`sti_desc2` `StiDesc2`
	,`st_item`.`last_stock_take` `LastStockTake`
	,`st_item`.`wh_code` `WhCode`
	,`wh`.`whse_code` `WhWhseCode`
	,`wh_warehouse_type`.`type_description` `WhWarehouseTypetypeDescription`
	,`st_item`.`staff_allowance` `StaffAllowance`
	,`st_item`.`certification_control` `CertificationControl`
	,`st_item`.`certification_code` `CertificationCode`
	,`certification`.`name` `CertificationName`
	,`st_item`.`serial_numbers` `SerialNumbers`
	,`st_item`.`cost_fifo` `CostFifo`
	,`st_item`.`staff_filter` `StaffFilter`
	,`staff_filter`.`staff_filter` `StaffFilterstaffFilter`
	,`st_item`.`review_period` `ReviewPeriod`
	,`review_period`.`period_code` `ReviewPeriodperiodCode`
	,`st_item`.`company_id` `CompanyID`
	,`company`.`name` `CompanyName`
	,`st_item`.`old_stock_id` `OldStockID`
	,`st_item`.`item_gl_code` `ItemGlCode`
	,`item_gl`.`nla_prt1` `ItemGlNlaPrt1`
	,`st_item`.`item_gender_filter` `ItemGenderFilter`
	,`st_item`.`archive_flag` `ArchiveFlag`
	,`st_item`.`picture1` `Picture1`
	,`st_item`.`vat_id` `VatID`
	,`st_item`.`abc_volume` `AbcVolume`
	,`st_item`.`abc_value` `AbcValue`
	,`st_item`.`abc_transactions` `AbcTransactions`
	,`st_item`.`order_unit_id` `OrderUnitID`
	,`st_item`.`store_unit_id` `StoreUnitID`
	,`store_unit`.`unit_desc` `StoreUnitDesc`
	,`st_item`.`picture` `Picture`
	,`st_item`.`location_catalogue_id` `LocationCatalogueid`
	,`location_catalogue`.`location_catalogue` `LocationCatalogueLocationCatalogue`
	,`location_catalogue`.`description` `LocationCatalogueDescription`
	,`st_item`.`charge_id` `Chargeid`
	,`charge`.`charge_code` `ChargeCode`
	,`charge`.`charge_code_description` `ChargeCodeDescription`
	,`st_item`.`staff_location_catalogue_id` `StaffLocationCatalogueid`
from `opex`.`st_item` `st_item`
	left join `opex`.`st_gp1cd` `sti_grp1` on `st_item`.`sti_grp1` = `sti_grp1`.`sti_grp1`
	left join `opex`.`st_gp2cd` `sti_grp2` on `st_item`.`sti_grp2` = `sti_grp2`.`sti_grp2`
	left join `opex`.`st_whse` `wh` on `st_item`.`wh_code` = `wh`.`whse_code`
	left join `opex`.`warehouse_types` `wh_warehouse_type` on `wh`.`warehouse_type` = `wh_warehouse_type`.`type_id`
	left join `opex`.`st_certs` `certification` on `st_item`.`certification_code` = `certification`.`code`
	left join `opex`.`item_staff_filter` `staff_filter` on `st_item`.`staff_filter` = `staff_filter`.`staff_filter`
	left join `opex`.`review_periods` `review_period` on `st_item`.`review_period` = `review_period`.`period_code`
	left join `opex`.`company` `company` on `st_item`.`company_id` = `company`.`id`
	left join `opex`.`gl_codes` `item_gl` on `st_item`.`item_gl_code` = `item_gl`.`gl_code`
	left join `opex`.`st_units` `store_unit` on `st_item`.`store_unit_id` = `store_unit`.`rowid`
	left join `opex`.`location_catalogue` `location_catalogue` on `st_item`.`location_catalogue_id` = `location_catalogue`.`location_catalogue_id`
	left join `opex`.`st_charge_code` `charge` on `st_item`.`charge_id` = `charge`.`charge_id`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="Rowid" type="UInt64" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="ItemCode" type="String" allowNulls="false" label="Item Code" length="16" />
      <field name="StiDesc" type="String" label="Description" length="75" showInSummary="true" />
      <field name="StiGrp1" type="String" label="Group" length="3" showInSummary="true" />
      <field name="StiGrp1Stg1Grp1Desc" type="String" readOnly="true" label="Group" length="20" />
      <field name="StiGrp2" type="String" label="Sti Grp2" length="3" showInSummary="true" />
      <field name="StiGrp2Stg2Grp2Desc" type="String" readOnly="true" label="Group" length="20" />
      <field name="VatCode" type="String" label="Vat Code" length="1" showInSummary="true" />
      <field name="StandardPrice" type="Decimal" dataFormatString="c" label="Standard Price" />
      <field name="AverageCost" type="Decimal" dataFormatString="c" label="Average Cost" />
      <field name="LastCost" type="Decimal" dataFormatString="c" label="Last Cost" />
      <field name="StandardCost" type="Decimal" dataFormatString="c" label="Standard Cost" />
      <field name="StiOnStp" type="String" label="On Stop" length="1" />
      <field name="StiStndOrdQty" type="Decimal" allowNulls="false" label="Sti Stnd Ord Qty" />
      <field name="StiStkLv" type="Decimal" allowNulls="false" label="Sti Stk Lv" />
      <field name="StiFreStk" type="Decimal" allowNulls="false" label="Stock Level" />
      <field name="StiPlNlCd" type="String" label="Sti Pl Nl Cd" length="12" />
      <field name="StiCsNlCd" type="String" label="Sti Cs Nl Cd" length="12" />
      <field name="StiCiNlCd" type="String" label="Sti Ci Nl Cd" length="12" />
      <field name="StiCvNlCd" type="String" label="Sti Cv Nl Cd" length="12" />
      <field name="StiDiscCd" type="String" label="Sti Disc Cd" length="2" />
      <field name="StiStkTyp" type="String" label="Sti Stk Typ" length="1" />
      <field name="StiAltItm" type="String" label="Sti Alt Itm" length="1" />
      <field name="StiFifoLow" type="Int16" label="Sti Fifo Low" />
      <field name="StiFifoHigh" type="Int16" label="Sti Fifo High" />
      <field name="OrderUnit" type="String" label="Order Unit" length="4" />
      <field name="StoreUnit" type="String" label="Store Unit" length="4" />
      <field name="PriceUnit" type="String" dataFormatString="c" label="Price Unit" length="4" />
      <field name="OrderPer" type="Decimal" label="Order Per" />
      <field name="PricePer" type="Decimal" dataFormatString="c" label="Price Per" />
      <field name="StorePer" type="Decimal" label="Store Per" />
      <field name="SizeScale" type="String" label="Size Scale" length="15" />
      <field name="LastReceiptDate" type="DateTime" label="Last Receipt Date" />
      <field name="BudgetInd" type="String" label="Budget Ind" length="8" />
      <field name="ItemOncost" type="String" dataFormatString="c" label="Item Oncost" length="2" />
      <field name="GroupOncost" type="String" dataFormatString="c" label="Group Oncost" length="1" />
      <field name="ContractCode" type="String" label="Contract Code" length="10" />
      <field name="MaxIssueLv" type="Decimal" label="Max Issue Lv" />
      <field name="MaxOrderQty" type="Decimal" label="Max Order Qty" />
      <field name="MaxStkLv" type="Decimal" label="Max Stk Lv" />
      <field name="TotalIssues" type="Decimal" label="Total Issues" />
      <field name="FrozenQty" type="Decimal" label="Frozen Qty" />
      <field name="FrozenDate" type="DateTime" label="Frozen Date" />
      <field name="InventoryDate" type="DateTime" label="Inventory Date" />
      <field name="SuspenseCode" type="String" label="Suspense Code" length="12" />
      <field name="InventoryCode" type="String" label="Inventory Code" length="12" />
      <field name="AdjustmentCode" type="String" label="Adjustment Code" length="12" />
      <field name="OncostCode" type="String" dataFormatString="c" label="Oncost Code" length="12" />
      <field name="StiDesc2" type="String" label="Description" length="75" />
      <field name="LastStockTake" type="DateTime" label="Last Stock Take" />
      <field name="WhCode" type="String" allowNulls="false" label="Wh Code" length="3" />
      <field name="WhWhseCode" type="String" readOnly="true" label="Wh Whse Code" length="3" />
      <field name="WhWarehouseTypetypeDescription" type="String" readOnly="true" label="Wh Warehouse Typetype Description" length="50" />
      <field name="StaffAllowance" type="Int32" label="Staff Allowance" />
      <field name="CertificationControl" type="String" label="Certification Control" length="1" />
      <field name="CertificationCode" type="Int32" label="Certification Code" />
      <field name="CertificationName" type="String" readOnly="true" label="Certification Name" length="25" />
      <field name="SerialNumbers" type="String" label="Serial Numbers" length="1" />
      <field name="CostFifo" type="Decimal" dataFormatString="c" label="Cost Fifo" />
      <field name="StaffFilter" type="String" label="Staff Filter" length="8" />
      <field name="StaffFilterstaffFilter" type="String" readOnly="true" label="Staff Filterstaff Filter" length="8" />
      <field name="ReviewPeriod" type="String" label="Review Period" length="1" />
      <field name="ReviewPeriodperiodCode" type="String" readOnly="true" label="Review Periodperiod Code" length="1" />
      <field name="CompanyID" type="UInt32" label="Company Id" />
      <field name="CompanyName" type="String" readOnly="true" label="Company Name" length="20" />
      <field name="OldStockID" type="String" label="Old Stock Id" length="15" />
      <field name="ItemGlCode" type="String" label="Item Gl Code" length="12">
        <items style="Lookup" dataController="GlCodes" newDataView="createForm1" dataValueField="GlCode" />
      </field>
      <field name="ItemGlNlaPrt1" type="String" readOnly="true" label="Item Gl Nla Prt1" length="4" />
      <field name="ItemGenderFilter" type="String" label="Item Gender Filter" length="1" />
      <field name="ArchiveFlag" type="String" label="Archive Flag" length="1" />
      <field name="Picture1" type="Byte[]" onDemand="true" sourceFields="Rowid" onDemandHandler="st_itemPicture1" onDemandStyle="Thumbnail" allowQBE="false" allowSorting="false" label="Picture1" />
      <field name="VatID" type="Int32" label="Vat Id" />
      <field name="AbcVolume" type="String" label="Abc Volume" length="1" />
      <field name="AbcValue" type="String" label="Abc Value" length="1" />
      <field name="AbcTransactions" type="String" label="Abc Transactions" length="1" />
      <field name="OrderUnitID" type="UInt32" label="Order Unit Id" />
      <field name="StoreUnitID" type="UInt32" label="Store Unit Id" />
      <field name="StoreUnitDesc" type="String" readOnly="true" label="Pack Size" length="32" />
      <field name="Picture" type="Byte[]" onDemand="true" sourceFields="Rowid" onDemandHandler="st_itemPicture" onDemandStyle="Thumbnail" allowQBE="false" allowSorting="false" label="Picture" />
      <field name="LocationCatalogueid" type="UInt32" label="Location Catalogue id" />
      <field name="LocationCatalogueLocationCatalogue" type="String" readOnly="true" label="Location Catalogue Location Catalogue" length="8" />
      <field name="LocationCatalogueDescription" type="String" readOnly="true" label="Location Catalogue Description" length="100" />
      <field name="Chargeid" type="UInt32" label="Charge id" />
      <field name="ChargeCode" type="String" readOnly="true" label="Charge Code" length="2" />
      <field name="ChargeCodeDescription" type="String" readOnly="true" label="Charge Code Description" length="100" />
      <field name="StaffLocationCatalogueid" type="UInt32" label="Staff Location Catalogue id" />
      <field name="Local_OPEXCost" type="Currency" label="Cost" computed="true" isVirtual="true" dataFormatString="C2">
        <formula>OPEXCost(`st_item`.`item_code`,null,null)</formula>
      </field>
      <field name="Local_Description" type="String" label="Description" computed="true" isVirtual="true">
        <formula>concat(	`st_item`.`sti_desc` ," ",COALESCE(`st_item`.`sti_desc2`," "))</formula>
      </field>
      <field name="Local_Groups" type="String" label="Groups" computed="true" isVirtual="true" calculated="true">
        <formula>concat(COALESCE(`sti_grp1`.`stg1_grp1_desc`," ")
   , " "
  ,COALESCE(`sti_grp2`.`stg2_grp2_desc`," ") )</formula>
      </field>
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Catalogue" sortExpression="ItemCode asc" filter="StiOnStp =&quot;N&quot;">
        <headerText />
        <dataFields>
          <dataField fieldName="Picture" columns="15" />
          <dataField fieldName="ItemCode" columns="16" />
          <dataField fieldName="StiGrp1" aliasFieldName="StiGrp1Stg1Grp1Desc">
          </dataField>
          <dataField fieldName="StiDesc" />
          <dataField fieldName="LocationCatalogueid" aliasFieldName="LocationCatalogueLocationCatalogue" />
          <dataField fieldName="LocationCatalogueDescription" />
          <dataField fieldName="Chargeid" aliasFieldName="ChargeCode" />
          <dataField fieldName="ChargeCodeDescription" />
          <dataField fieldName="StaffLocationCatalogueid" columns="15" />
          <dataField fieldName="Local_OPEXCost" columns="15" />
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Catalogue">
        <headerText>You can ask a question about this item or add it to your trolley using the buttons below</headerText>
        <categories>
          <category id="Detail" headerText="Detail" tab="Detail">
            <description>Information about this Item</description>
            <dataFields>
              <dataField fieldName="ItemCode" columns="16" />
              <dataField fieldName="Local_Description" rows="5" />
              <dataField fieldName="StiFreStk" columns="15" />
              <dataField fieldName="StoreUnitID" aliasFieldName="StoreUnitDesc" />
              <dataField fieldName="LocationCatalogueid" aliasFieldName="LocationCatalogueLocationCatalogue" hidden="true">
              </dataField>
              <dataField fieldName="LocationCatalogueDescription" hidden="true">
              </dataField>
              <dataField fieldName="Chargeid" aliasFieldName="ChargeCode" />
              <dataField fieldName="ChargeCodeDescription" />
              <dataField fieldName="StaffLocationCatalogueid" columns="15" />
              <dataField fieldName="Local_OPEXCost" rows="5" />
              <dataField fieldName="Local_Groups" rows="5" />
              <dataField fieldName="StiDesc" hidden="true">
              </dataField>
            </dataFields>
          </category>
          <category headerText="Pictures" id="c1" tab="Pictures">
            <description>Images for his Item</description>
            <dataFields>
              <dataField fieldName="Picture" columns="15" />
              <dataField fieldName="Picture1" columns="15" />
            </dataFields>
            <visibility>
              <expression test="[Picture] != null" type="ClientScript" />
            </visibility>
          </category>
          <category headerText="Hidden" tab="Hidden" id="c2">
            <visibility>
              <expression test="false" type="ClientScript" />
            </visibility>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexst Item">
        <headerText>hello</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="ItemCode" columns="16" />
              <dataField fieldName="StiDesc" />
              <dataField fieldName="StiGrp1" aliasFieldName="StiGrp1Stg1Grp1Desc" />
              <dataField fieldName="StiGrp2" aliasFieldName="StiGrp2Stg2Grp2Desc" />
              <dataField fieldName="VatCode" columns="1" />
              <dataField fieldName="StandardPrice" columns="15" />
              <dataField fieldName="AverageCost" columns="15" />
              <dataField fieldName="LastCost" columns="15" />
              <dataField fieldName="StandardCost" columns="15" />
              <dataField fieldName="StiOnStp" columns="1" />
              <dataField fieldName="StiStndOrdQty" columns="15" />
              <dataField fieldName="StiStkLv" columns="15" />
              <dataField fieldName="StiFreStk" columns="15" />
              <dataField fieldName="StiPlNlCd" columns="12" />
              <dataField fieldName="StiCsNlCd" columns="12" />
              <dataField fieldName="StiCiNlCd" columns="12" />
              <dataField fieldName="StiCvNlCd" columns="12" />
              <dataField fieldName="StiDiscCd" columns="2" />
              <dataField fieldName="StiStkTyp" columns="1" />
              <dataField fieldName="StiAltItm" columns="1" />
              <dataField fieldName="StiFifoLow" columns="15" />
              <dataField fieldName="StiFifoHigh" columns="15" />
              <dataField fieldName="OrderUnit" columns="4" />
              <dataField fieldName="StoreUnit" columns="4" />
              <dataField fieldName="PriceUnit" columns="4" />
              <dataField fieldName="OrderPer" columns="15" />
              <dataField fieldName="PricePer" columns="15" />
              <dataField fieldName="StorePer" columns="15" />
              <dataField fieldName="SizeScale" columns="15" />
              <dataField fieldName="LastReceiptDate" columns="10" />
              <dataField fieldName="BudgetInd" columns="8" />
              <dataField fieldName="ItemOncost" columns="2" />
              <dataField fieldName="GroupOncost" columns="1" />
              <dataField fieldName="ContractCode" columns="10" />
              <dataField fieldName="MaxIssueLv" columns="15" />
              <dataField fieldName="MaxOrderQty" columns="15" />
              <dataField fieldName="MaxStkLv" columns="15" />
              <dataField fieldName="TotalIssues" columns="15" />
              <dataField fieldName="FrozenQty" columns="15" />
              <dataField fieldName="FrozenDate" columns="10" />
              <dataField fieldName="InventoryDate" columns="10" />
              <dataField fieldName="SuspenseCode" columns="12" />
              <dataField fieldName="InventoryCode" columns="12" />
              <dataField fieldName="AdjustmentCode" columns="12" />
              <dataField fieldName="OncostCode" columns="12" />
              <dataField fieldName="StiDesc2" />
              <dataField fieldName="LastStockTake" columns="10" />
              <dataField fieldName="WhCode" aliasFieldName="WhWhseCode" />
              <dataField fieldName="WhWarehouseTypetypeDescription" columns="50" />
              <dataField fieldName="StaffAllowance" columns="15" />
              <dataField fieldName="CertificationControl" columns="1" />
              <dataField fieldName="CertificationCode" aliasFieldName="CertificationName" />
              <dataField fieldName="SerialNumbers" columns="1" />
              <dataField fieldName="CostFifo" columns="15" />
              <dataField fieldName="StaffFilter" columns="8" />
              <dataField fieldName="StaffFilterstaffFilter" columns="8" />
              <dataField fieldName="ReviewPeriod" aliasFieldName="ReviewPeriodperiodCode" />
              <dataField fieldName="CompanyID" aliasFieldName="CompanyName" />
              <dataField fieldName="OldStockID" columns="15" />
              <dataField fieldName="ItemGlCode" aliasFieldName="ItemGlNlaPrt1" />
              <dataField fieldName="ItemGenderFilter" columns="1" />
              <dataField fieldName="ArchiveFlag" columns="1" />
              <dataField fieldName="Picture1" columns="15" />
              <dataField fieldName="VatID" columns="15" />
              <dataField fieldName="AbcVolume" columns="1" />
              <dataField fieldName="AbcValue" columns="1" />
              <dataField fieldName="AbcTransactions" columns="1" />
              <dataField fieldName="OrderUnitID" columns="15" />
              <dataField fieldName="StoreUnitID" aliasFieldName="StoreUnitDesc" />
              <dataField fieldName="Picture" columns="15" />
              <dataField fieldName="LocationCatalogueid" aliasFieldName="LocationCatalogueLocationCatalogue" />
              <dataField fieldName="LocationCatalogueDescription" />
              <dataField fieldName="Chargeid" aliasFieldName="ChargeCode" />
              <dataField fieldName="ChargeCodeDescription" />
              <dataField fieldName="StaffLocationCatalogueid" columns="15" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" headerText="More Information" />
        <action commandName="Custom" commandArgument="Add" headerText="Add to Trolley" causesValidation="false" id="a100" whenClientScript="false" />
        <action commandName="Custom" commandArgument="Ask" headerText="Ask a Question " causesValidation="false" id="a101" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
        <action commandName="Custom" commandArgument="Add" headerText="Add to Trolley" causesValidation="false" id="a100" whenClientScript="false" />
        <action commandName="Custom" commandArgument="Ask" headerText="Ask a Question " causesValidation="false" id="a101" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag100" scope="ActionBar" headerText="Item Actions" flat="true">
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="ItemSize" conflictDetection="overwriteChanges" label="Opexst Itmsz" nativeSchema="opex" nativeTableName="st_itmsz">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`st_itmsz`.`rowid` `Rowid`
	,`st_itmsz`.`item_code` `ItemCode`
	,`st_itmsz`.`size_code` `SizeCode`
	,`st_itmsz`.`average_cost` `AverageCost`
	,`st_itmsz`.`last_cost` `LastCost`
	,`st_itmsz`.`standard_cost` `StandardCost`
	,`st_itmsz`.`on_stop` `OnStop`
	,`st_itmsz`.`last_purch_date` `LastPurchDate`
	,`st_itmsz`.`danger_level` `DangerLevel`
	,`st_itmsz`.`std_order_qty` `StdOrderQty`
	,`st_itmsz`.`total_level` `TotalLevel`
	,`st_itmsz`.`open_balance` `OpenBalance`
	,`st_itmsz`.`allocated_qty` `AllocatedQty`
	,`st_itmsz`.`free_qty` `FreeQty`
	,`st_itmsz`.`on_order_qty` `OnOrderQty`
	,`st_itmsz`.`total_issues` `TotalIssues`
	,`st_itmsz`.`lead_time` `LeadTime`
	,`st_itmsz`.`fifo_low` `FifoLow`
	,`st_itmsz`.`fifo_high` `FifoHigh`
	,`st_itmsz`.`vat_code` `VatCode`
	,`st_itmsz`.`standard_price` `StandardPrice`
	,`st_itmsz`.`max_issue_lv` `MaxIssueLv`
	,`st_itmsz`.`max_order_qty` `MaxOrderQty`
	,`st_itmsz`.`max_stk_lv` `MaxStkLv`
	,`st_itmsz`.`last_receipt_date` `LastReceiptDate`
	,`st_itmsz`.`frozen_qty` `FrozenQty`
	,`st_itmsz`.`frozen_date` `FrozenDate`
	,`st_itmsz`.`stock_type` `StockType`
	,`st_itmsz`.`abc_cls` `AbcCls`
	,`st_itmsz`.`abc_cls_dt` `AbcClsDt`
	,`st_itmsz`.`size_sort_order` `SizeSortOrder`
	,`st_itmsz`.`cost_fifo` `CostFifo`
	,`st_itmsz`.`last_stock_take` `LastStockTake`
from `opex`.`st_itmsz` `st_itmsz`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="Rowid" type="UInt64" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="ItemCode" type="String" allowNulls="false" label="Item Code" length="16" showInSummary="true" />
      <field name="SizeCode" type="String" allowNulls="false" label="Size Code" length="20" showInSummary="true" />
      <field name="AverageCost" type="Decimal" dataFormatString="c" label="Average Cost" showInSummary="true" />
      <field name="LastCost" type="Decimal" dataFormatString="c" label="Last Cost" showInSummary="true" />
      <field name="StandardCost" type="Decimal" dataFormatString="c" label="Standard Cost" showInSummary="true" />
      <field name="OnStop" type="String" label="On Stop" length="1" />
      <field name="LastPurchDate" type="DateTime" label="Last Purch Date" />
      <field name="DangerLevel" type="Decimal" label="Danger Level" />
      <field name="StdOrderQty" type="Decimal" label="Std Order Qty" />
      <field name="TotalLevel" type="Decimal" label="Total Level" />
      <field name="OpenBalance" type="Decimal" label="Open Balance" />
      <field name="AllocatedQty" type="Decimal" label="Allocated Qty" />
      <field name="FreeQty" type="Decimal" label="Free Qty" />
      <field name="OnOrderQty" type="Decimal" label="On Order Qty" />
      <field name="TotalIssues" type="Decimal" label="Total Issues" />
      <field name="LeadTime" type="Int16" label="Lead Time" />
      <field name="FifoLow" type="Int16" label="Fifo Low" />
      <field name="FifoHigh" type="Int16" label="Fifo High" />
      <field name="VatCode" type="String" label="Vat Code" length="1" />
      <field name="StandardPrice" type="Decimal" dataFormatString="c" label="Standard Price" />
      <field name="MaxIssueLv" type="Decimal" label="Max Issue Lv" />
      <field name="MaxOrderQty" type="Decimal" label="Max Order Qty" />
      <field name="MaxStkLv" type="Decimal" label="Max Stk Lv" />
      <field name="LastReceiptDate" type="DateTime" label="Last Receipt Date" />
      <field name="FrozenQty" type="Decimal" label="Frozen Qty" />
      <field name="FrozenDate" type="DateTime" label="Frozen Date" />
      <field name="StockType" type="String" label="Stock Type" length="1" />
      <field name="AbcCls" type="String" label="Abc Cls" length="1" />
      <field name="AbcClsDt" type="DateTime" label="Abc Cls Dt" />
      <field name="SizeSortOrder" type="Int32" label="Size Sort Order" />
      <field name="CostFifo" type="Decimal" dataFormatString="c" label="Cost Fifo" />
      <field name="LastStockTake" type="DateTime" label="Last Stock Take" />
      <field name="Local_OPEXCost" type="Currency" label="Item Cost" computed="true" dataFormatString="C2">
        <formula>OPEXCost(`st_itmsz`.`item_code`,`st_itmsz`.`size_code`,null)</formula>
      </field>
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Sizes" sortExpression="SizeSortOrder,SizeCode">
        <headerText>This is a list of sizes for this item</headerText>
        <dataFields>
          <dataField fieldName="ItemCode" columns="16" />
          <dataField fieldName="SizeCode" columns="20" />
          <dataField fieldName="FreeQty" columns="15" />
          <dataField fieldName="Local_OPEXCost" columns="15">
          </dataField>
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Opexst Itmsz">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1">
            <description />
            <dataFields>
              <dataField fieldName="ItemCode" columns="16" />
              <dataField fieldName="SizeCode" columns="20" />
              <dataField fieldName="Local_OPEXCost" columns="15">
              </dataField>
              <dataField fieldName="FreeQty" columns="15">
              </dataField>
            </dataFields>
          </category>
          <category headerText="Hidden" id="c2">
            <visibility>
              <expression test="false" type="ClientScript" />
            </visibility>
            <dataFields>
              <dataField fieldName="AbcCls" columns="1" />
              <dataField fieldName="AverageCost" columns="15" />
              <dataField fieldName="LastCost" columns="15" />
              <dataField fieldName="StandardCost" columns="15" />
              <dataField fieldName="OnStop" columns="1" />
              <dataField fieldName="LastPurchDate" columns="10" />
              <dataField fieldName="DangerLevel" columns="15" />
              <dataField fieldName="StdOrderQty" columns="15" />
              <dataField fieldName="TotalLevel" columns="15" />
              <dataField fieldName="OpenBalance" columns="15" />
              <dataField fieldName="AllocatedQty" columns="15" />
              <dataField fieldName="OnOrderQty" columns="15" />
              <dataField fieldName="TotalIssues" columns="15" />
              <dataField fieldName="LeadTime" columns="15" />
              <dataField fieldName="FifoLow" columns="15" />
              <dataField fieldName="FifoHigh" columns="15" />
              <dataField fieldName="VatCode" columns="1" />
              <dataField fieldName="StandardPrice" columns="15" />
              <dataField fieldName="MaxIssueLv" columns="15" />
              <dataField fieldName="MaxOrderQty" columns="15" />
              <dataField fieldName="MaxStkLv" columns="15" />
              <dataField fieldName="LastReceiptDate" columns="10" />
              <dataField fieldName="FrozenQty" columns="15" />
              <dataField fieldName="FrozenDate" columns="10" />
              <dataField fieldName="StockType" columns="1" />
              <dataField fieldName="AbcClsDt" columns="10" />
              <dataField fieldName="SizeSortOrder" columns="15" />
              <dataField fieldName="CostFifo" columns="15" />
              <dataField fieldName="LastStockTake" columns="10" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexst Itmsz">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="ItemCode" columns="16" />
              <dataField fieldName="SizeCode" columns="20" />
              <dataField fieldName="AverageCost" columns="15" />
              <dataField fieldName="LastCost" columns="15" />
              <dataField fieldName="StandardCost" columns="15" />
              <dataField fieldName="OnStop" columns="1" />
              <dataField fieldName="LastPurchDate" columns="10" />
              <dataField fieldName="DangerLevel" columns="15" />
              <dataField fieldName="StdOrderQty" columns="15" />
              <dataField fieldName="TotalLevel" columns="15" />
              <dataField fieldName="OpenBalance" columns="15" />
              <dataField fieldName="AllocatedQty" columns="15" />
              <dataField fieldName="FreeQty" columns="15" />
              <dataField fieldName="OnOrderQty" columns="15" />
              <dataField fieldName="TotalIssues" columns="15" />
              <dataField fieldName="LeadTime" columns="15" />
              <dataField fieldName="FifoLow" columns="15" />
              <dataField fieldName="FifoHigh" columns="15" />
              <dataField fieldName="VatCode" columns="1" />
              <dataField fieldName="StandardPrice" columns="15" />
              <dataField fieldName="MaxIssueLv" columns="15" />
              <dataField fieldName="MaxOrderQty" columns="15" />
              <dataField fieldName="MaxStkLv" columns="15" />
              <dataField fieldName="LastReceiptDate" columns="10" />
              <dataField fieldName="FrozenQty" columns="15" />
              <dataField fieldName="FrozenDate" columns="10" />
              <dataField fieldName="StockType" columns="1" />
              <dataField fieldName="AbcCls" columns="1" />
              <dataField fieldName="AbcClsDt" columns="10" />
              <dataField fieldName="SizeSortOrder" columns="15" />
              <dataField fieldName="CostFifo" columns="15" />
              <dataField fieldName="LastStockTake" columns="10" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="OpexstaffRoles" conflictDetection="overwriteChanges" label="Opexstaff Roles" nativeSchema="opex" nativeTableName="staff_roles">
    <commands>
      <command id="command1" type="Text">
        <text>
select
	`staff_roles`.`id` `ID`
	,`staff_roles`.`role_id` `RoleID`
	,`role`.`name` `RoleName`
	,`staff_roles`.`staff_uid` `StaffUid`
	,`staff_u`.`location_code` `StaffUlocationCode`
	,`staff_roles`.`cost_centre` `CostCentre`
	,`cost_centre`.`budget_desc` `CostCentrebudgetDesc`
	,`staff_roles`.`location_code` `LocationCode`
	,`location_code`.`location_desc` `LocationCodeLocationDesc`
	,`staff_roles`.`rank_code` `RankCode`
	,`rank`.`rank_code` `RankCode1`
from `opex`.`staff_roles` `staff_roles`
	left join `opex`.`roles` `role` on `staff_roles`.`role_id` = `role`.`id`
	left join `opex`.`rq_staff` `staff_u` on `staff_roles`.`staff_uid` = `staff_u`.`staff_uid`
	left join `opex`.`rq_budcd` `cost_centre` on `staff_roles`.`cost_centre` = `cost_centre`.`budget_code`
	left join `opex`.`rq_ranks` `rank` on `staff_roles`.`rank_code` = `rank`.`rank_code`
	left join `opex`.`rq_locns` `location_code` on `staff_roles`.`location_code` = `location_code`.`location_code`
</text>
      </command>
      <command id="idIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="ID" />
        </output>
      </command>
    </commands>
    <fields>
      <field name="RoleID" type="Int32" label="Role Id" showInSummary="true">
        <items dataController="Opexroles" />
      </field>
      <field name="RoleName" type="String" readOnly="true" label="Role Name" length="12" />
      <field name="StaffUid" type="UInt32" label="Staff Uid" showInSummary="true">
        <items style="Lookup" dataController="Staff" newDataView="createForm1" dataValueField="StaffUid" dataTextField="StaffUid" copy="StaffUlocationCode=LocationCode" />
      </field>
      <field name="StaffUlocationCode" type="String" readOnly="true" label="Location Code" length="8" />
      <field name="CostCentre" type="String" dataFormatString="c" label="Cost Centre Code" length="8" showInSummary="true">
        <items style="Lookup" dataController="RqBudcd" newDataView="createForm1" dataValueField="BudgetCode" dataTextField="BudgetDesc" />
      </field>
      <field name="CostCentrebudgetDesc" type="String" readOnly="true" label="Cost Centre" length="50" />
      <field name="LocationCode" type="String" label="Location Code" length="8" showInSummary="true">
        <items dataController="OpexrqLocns" newDataView="createForm1" dataValueField="LocationCode" dataTextField="LocationDesc" />
      </field>
      <field name="LocationCodeLocationDesc" type="String" readOnly="true" label="Location" length="75" />
      <field name="RankCode" type="String" label="Rank Code" length="8" showInSummary="true">
        <items style="Lookup" dataController="RqRanks" newDataView="createForm1" dataValueField="RankCode" dataTextField="RankCode" copy="RankCode1=RankCode" />
      </field>
      <field name="RankCode1" type="String" readOnly="true" label="Rank Code" length="8" />
      <field name="LocalRoleDescription" type="String" label="Role Description" computed="true" isVirtual="true">
        <formula>BuildRoleName(`role`.`description`,`location_code`.location_desc ,`rank`.`rank_desc`)</formula>
      </field>
      <field name="ID" type="Int32" allowNulls="false" isPrimaryKey="true" label="Id" readOnly="true" />
      <field name="LocalRankCode" type="String" label="Rank Code" computed="true">
        <formula>COALESCE(staff_roles.rank_code,role.rank_code,staff_u.rank_code)</formula>
      </field>
      <field name="LocalRankDescription" type="String" label="Rank Code" computed="true" isVirtual="true">
        <formula> ( Select  r.rank_desc from rq_ranks r Where r.rank_code = COALESCE(staff_roles.rank_code,role.rank_code,staff_u.rank_code)) </formula>
      </field>
      <field name="LocalBudgetCode" type="String" label="Local Budget Code" computed="true" isVirtual="true">
        <formula>COALESCE(staff_roles.cost_centre,role.cost_centre ,(select l.budget_ind from rq_locns l  where l.location_code = `staff_u`.`location_code`  ))</formula>
      </field>
      <field name="LocalLocationCode" type="String" label="Location Code" computed="true" length="8">
        <formula>COALESCE(staff_roles.location_code,staff_u.location_code)</formula>
      </field>
      <field name="LocalLocation" type="String" label="Location Code" computed="true" length="75">
        <formula>COALESCE(`location_code`.location_desc,(select l.location_desc from rq_locns l  where l.location_code = `staff_u`.`location_code`  ))</formula>
      </field>
    </fields>
    <views>
      <view id="grid1" type="Grid" commandId="command1" label="Staff Roles" tags="view-style-grid, &#xD;&#xA;view-style-charts-disabled,&#xD;&#xA;view-style-list-disabled,&#xD;&#xA;multi-select-none ">
        <headerText />
        <dataFields>
          <dataField fieldName="StaffUid" columns="15" hidden="true">
          </dataField>
          <dataField fieldName="ID" columns="15">
          </dataField>
          <dataField fieldName="LocalRoleDescription" rows="5" />
          <dataField fieldName="RoleID" aliasFieldName="RoleName" />
          <dataField fieldName="LocationCode" aliasFieldName="LocationCodeLocationDesc" hidden="true">
          </dataField>
          <dataField fieldName="LocalRankCode" rows="5" />
          <dataField fieldName="LocalRankDescription" rows="5" />
          <dataField fieldName="LocalBudgetCode" rows="5" />
          <dataField fieldName="LocalLocation" rows="5" />
          <dataField fieldName="LocalLocationCode" columns="8" />
        </dataFields>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" commandName="Select" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="MyProfile" conflictDetection="overwriteChanges" label="My Profile" handler="MyProfileBusinessRules">
    <commands />
    <fields>
      <field name="UserName" type="String" allowNulls="false" label="^UserName^User Name^UserName^" />
      <field name="RememberMe" type="Boolean" allowNulls="false" default="0" label="^RememberMe^Remember me next time^RememberMe^">
        <items style="CheckBox" />
      </field>
      <field name="Password" type="String" allowNulls="false" label="^Password^Password^Password^" />
      <field name="ConfirmPassword" type="String" allowNulls="false" label="^ConfirmPassword^Confirm Password^ConfirmPassword^" />
      <field name="OldPassword" type="String" allowNulls="false" label="^OldPassword^Old Password^OldPassword^" />
      <field name="Email" type="String" label="^Email^Email^Email^" allowNulls="false" />
      <field name="PasswordQuestion" type="String" label="^PasswordQuestion^Password Question^PasswordQuestion^" allowNulls="false" />
      <field name="PasswordAnswer" type="String" label="^PasswordAnswer^Password Answer^PasswordAnswer^" allowNulls="false" />
      <field name="DisplayRememberMe" type="Boolean" />
      <field name="OAuthEnabled" type="Boolean" />
      <field name="OAuthProvider" type="String" allowNulls="false" label="^Account^Account^Account^">
        <items style="RadioButtonList">
          <item value="facebook" text="Facebook" />
          <item value="google" text="Google" />
          <item value="msgraph" text="Microsoft" />
          <item value="linkedin" text="LinkedIn" />
          <item value="windowslive" text="Windows Live" />
          <item value="sharepoint" text="SharePoint" />
          <item value="dnn" text="DotNetNuke" />
          <item value="identityserver" text="Identity Server" />
          <item value="cloudidentity" text="Cloud Identity" />
          <item value="other" text="Other" />
        </items>
      </field>
    </fields>
    <views>
      <view id="loginForm" type="Form" access="Public" label="^LoginLink^Login^LoginLink^" tags=" modal-fit-content modal-max-xs material-icon-lock-outline discard-changes-prompt-none">
        <categories>
          <category id="c1" headerText="Enter Your Login Details" flow="NewColumn">
            <dataFields>
              <dataField fieldName="OAuthEnabled" hidden="true" />
              <dataField fieldName="OAuthProvider" hidden="true" tag="lookup-auto-advance" columns="1" />
              <dataField fieldName="UserName" />
              <dataField fieldName="Password" textMode="Password">
                <visibility>
                  <expression test="$app.touch.settings('membership.disableLoginPassword') != true" />
                </visibility>
              </dataField>
              <dataField fieldName="RememberMe">
                <visibility>
                  <expression test="$row.DisplayRememberMe != false" />
                </visibility>
              </dataField>
              <dataField fieldName="DisplayRememberMe" hidden="true" />
            </dataFields>
          </category>
        </categories>
        <headerText>Enter your OPEX Signon Details</headerText>
      </view>
      <view id="signUpForm" type="Form" commandId="command1" access="Public" label="^SignUpViewLabel^Account Sign Up^SignUpViewLabel^" tags="material-icon-person-add">
        <headerText>^SignUpViewHeaderText^Please fill this form and click OK button to sign up for an account. Click Cancel to return to the previous screen.^SignUpViewHeaderText^</headerText>
        <categories>
          <category id="c1" headerText="^SignUpViewNewUserInfoCategoryHeaderText^New User Information^SignUpViewNewUserInfoCategoryHeaderText^" flow="NewColumn">
            <description>^SignUpViewNewUserInfoCategoryDescription^Please enter user name and password. Note that password must be at least 7 characters long and include one non-alphanumeric character. Only approved users will be able to login into the website.^SignUpViewNewUserInfoCategoryDescription^</description>
            <dataFields>
              <dataField fieldName="UserName" columns="20" />
              <dataField fieldName="Password" columns="20" textMode="Password" />
              <dataField fieldName="ConfirmPassword" columns="20" textMode="Password" />
            </dataFields>
          </category>
          <category id="c2" headerText="^SignUpViewPasswordRecoveryCategoryHeaderText^Password Recovery^SignUpViewPasswordRecoveryCategoryHeaderText^">
            <description>
													
                        ^SignUpViewPasswordRecoveryCategoryDescription^These fields are required to help you to recover a forgotten password. During the recovery process you will be asked to enter a user name. 
						If a user account exists then a security question is requested to be answered. A correct answer will trigger an email with a temporary password send to the registered email.^SignUpViewPasswordRecoveryCategoryDescription^
                      
												</description>
            <dataFields>
              <dataField fieldName="Email" />
              <dataField fieldName="PasswordQuestion" />
              <dataField fieldName="PasswordAnswer" textMode="Password" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="passwordRequestForm" type="Form" commandId="command1" access="Public" label="^PasswordRequestViewLabel^Password Recovery: Step 1 of 2^PasswordRequestViewLabel^" tags="material-icon-lock discard-changes-prompt-none">
        <headerText>^PasswordRequestViewHeaderText^Please fill this form and click Continue button to recover the forgotten password. Click Cancel to return to the previous screen.^PasswordRequestViewHeaderText^</headerText>
        <categories>
          <category id="c1" headerText="^PasswordRequestViewForgotPasswordCategoryHeaderText^Forgot your password?^PasswordRequestViewForgotPasswordCategoryHeaderText^" flow="NewColumn">
            <description>^PasswordRequestViewForgotPasswordCategoryDescription^Please enter a user name. &lt;br/&gt;&lt;br/&gt;&lt;br/&gt;^PasswordRequestViewForgotPasswordCategoryDescription^</description>
            <dataFields>
              <dataField fieldName="UserName" columns="20" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="identityConfirmationForm" type="Form" commandId="command1" access="Public" label="^IdentityConfirmViewLabel^Password Recovery: Step 2 of 2^IdentityConfirmViewLabel^" tags="material-icon-lock-open discard-changes-prompt-none">
        <headerText>^IdentityConfirmViewHeaderText^Please fill this form and click Submit button to recover the forgotten password. Click Cancel to return to the previous screen.^IdentityConfirmViewHeaderText^</headerText>
        <categories>
          <category id="c1" headerText="^IdentityConfirmationViewIdentityConfirmCategoryHeaderText^Identity Confirmation^IdentityConfirmationViewIdentityConfirmCategoryHeaderText^" flow="NewColumn">
            <description>^IdentityConfirmationViewIdentityConfirmCategoryDescription^Answer the following question to receive your password. &lt;br/&gt;&lt;br/&gt;&lt;br/&gt;^IdentityConfirmationViewIdentityConfirmCategoryDescription^</description>
            <dataFields>
              <dataField fieldName="UserName" columns="20" readOnly="true" />
              <dataField fieldName="PasswordQuestion" readOnly="true" />
              <dataField fieldName="PasswordAnswer" textMode="Password" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="myAccountForm" type="Form" commandId="command1" label="^MyAccountViewLabel^My Account^MyAccountViewLabel^" tags="material-icon-perm-identity discard-changes-prompt-none">
        <headerText>^MyAccountViewHeaderText^Please review your membership information below. Click Update My Account to change this record, or click Cancel to return back.^MyAccountViewHeaderText^</headerText>
        <categories>
          <category id="c1" headerText="^MyAccountViewCurrentPasswordCategoryHeaderText^1. Current Password^MyAccountViewCurrentPasswordCategoryHeaderText^" flow="NewColumn">
            <description>^MyAccountViewCurrentPasswordCategoryDescription^Please enter your current password to create new password, update your email address, or change password recovery question and answer.^MyAccountViewCurrentPasswordCategoryDescription^</description>
            <dataFields>
              <dataField fieldName="UserName" readOnly="true" />
              <dataField fieldName="OldPassword" columns="20" textMode="Password">
                <headerText>^Password^Password^Password^</headerText>
              </dataField>
            </dataFields>
          </category>
          <category id="c2" headerText="^MyAccountViewNewPasswordCategoryHeaderText^2. New Password (Optional)^MyAccountViewNewPasswordCategoryHeaderText^">
            <description>^MyAccountViewNewPasswordCategoryDescription^Please enter new password. Note that password must be at least 7 characters long and include one non-alphanumeric character.^MyAccountViewNewPasswordCategoryDescription^</description>
            <dataFields>
              <dataField fieldName="Password" columns="20" textMode="Password">
                <headerText>^NewPassword^New Password^NewPassword^</headerText>
              </dataField>
              <dataField fieldName="ConfirmPassword" columns="20" textMode="Password">
                <headerText>^ConfirmNewPassword^Confirm New Password^ConfirmNewPassword^</headerText>
              </dataField>
            </dataFields>
          </category>
          <category id="c3" headerText="^MyAccountViewPasswordRecoveryCategoryHeaderText^3. Email &amp; Password Recovery (Optional)^MyAccountViewPasswordRecoveryCategoryHeaderText^">
            <description>
													
                        ^MyAccountViewPasswordRecoveryCategoryDescription^During the recovery of a forgotten password you will be asked to enter your user name. 
						If a user account exists then a password question must be answered. A correct answer will trigger an email with a temporary password send to you.^MyAccountViewPasswordRecoveryCategoryDescription^
                      
												</description>
            <dataFields>
              <dataField fieldName="Email" />
              <dataField fieldName="PasswordQuestion" />
              <dataField fieldName="PasswordAnswer" textMode="Password">
                <headerText>^MaskedPasswordAnswer^Password Answer (not displayed for your protection)^MaskedPasswordAnswer^</headerText>
              </dataField>
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions>
      <actionGroup id="ag1" scope="Form">
        <action id="a2" whenLastCommandName="New" whenLastCommandArgument="signUpForm" commandName="Cancel" />
        <action id="a3" whenLastCommandName="Insert" whenLastCommandArgument="SignUp" commandName="Cancel" />
        <action id="a4" whenLastCommandName="New" whenLastCommandArgument="passwordRequestForm" commandName="Cancel" />
        <action id="a5" whenLastCommandName="New" whenLastCommandArgument="passwordRequestForm" commandName="Custom" commandArgument="RequestPassword" headerText="^RequestPasswordActionHeaderText^Next^RequestPasswordActionHeaderText^" cssClass="material-icon-arrow-forward" />
        <action id="a6" whenLastCommandName="Edit" whenLastCommandArgument="identityConfirmationForm" commandName="Custom" commandArgument="BackToRequestPassword" headerText="^BackToRequestPasswordActionHeaderText^Back^BackToRequestPasswordActionHeaderText^" causesValidation="false" />
        <action id="a7" whenLastCommandName="Edit" whenLastCommandArgument="identityConfirmationForm" commandName="Custom" commandArgument="ConfirmIdentity" headerText="^ConfirmIdentityActionHeaderText^Finish^ConfirmIdentityActionHeaderText^" cssClass="material-icon-check" />
        <action id="a8" whenLastCommandName="Edit" whenLastCommandArgument="myAccountForm" commandName="Update" headerText="^UpdateMyAccountActionHeaderText^Update My Account^UpdateMyAccountActionHeaderText^" causesValidation="false" />
        <action id="a9" whenLastCommandName="Edit" whenLastCommandArgument="myAccountForm" commandName="Cancel" />
        <action id="a10" commandName="Custom" headerText="Login OPEX" commandArgument="Login" whenLastCommandName="New" whenLastCommandArgument="loginForm" causesValidation="true" key="Enter" cssClass="material-icon-arrow-forward" />
        <action id="a12" commandName="Custom" headerText="^ForgotYourPassword^Forgot your password?^ForgotYourPassword^" commandArgument="ForgotPassword" whenLastCommandName="New" whenLastCommandArgument="loginForm" causesValidation="false" />
      </actionGroup>
    </actions>
    <businessRules>
      <rule id="r100" commandName="Custom" commandArgument="Login" type="JavaScript" phase="Execute">this.preventDefault();
var resources = Web.MembershipResources.Messages,
    oauthProvider = $row.OAuthProvider;
if (oauthProvider &amp;&amp; oauthProvider != 'other')
    window.location = $app.resolveClientUrl('~/appservices/saas/' + oauthProvider);
else
    $app.login($row.UserName, $row.Password, $row.RememberMe==true,
      function () {
        setTimeout(function() {
          $app._navigated = true;
          window.location.replace($app.touch.returnUrl() || __baseUrl);
        });
      },
      function () {
        $app.alert(resources.InvalidUserNameAndPassword, function() {$app.input.focus({fieldName:'UserName'})});
      });

		
                
                </rule>
      <rule id="r101" commandName="Custom" commandArgument="SignUp" type="JavaScript" phase="Execute">
										
this.preventDefault();
$app.touch.show({
  controller: 'MyProfile',
  startCommand: 'New',
  startArgument: 'signUpForm'
});

									</rule>
      <rule id="r102" commandName="Custom" commandArgument="ForgotPassword" type="JavaScript" phase="Execute">
										
this.preventDefault();
$app.touch.show({
  controller: 'MyProfile',
  startCommand: 'New',
  startArgument: 'passwordRequestForm'
});

									</rule>
    </businessRules>
  </dataController>
  <dataController name="StaffAccessControl" label="StaffAccessControl" conflictDetection="overwriteChanges" generateDataAccessObjects="true">
    <commands xmlns="urn:schemas-codeontime-com:data-aquarium">
      <command id="command1" type="Text">
        <text>
select
	`rq_staff`.`staff_uid` `StaffUid`
	,`rq_staff`.`staff_code` `StaffCode`
	,`rq_staff`.`staff_title` `StaffTitle`
	,`rq_staff`.`initials` `Initials`
	,`rq_staff`.`forname` `Forname`
	,`rq_staff`.`surname` `Surname`
	,`rq_staff`.`rank_code` `RankCode`
	,`rank`.`rank_desc` `RankDesc`
	,`rank_staff_filter`.`staff_filter` `RankStaffFilterstaffFilter`
	,`rq_staff`.`epl_number` `EplNumber`
	,`rq_staff`.`location_code` `LocationCode`
	,`location`.`location_desc` `LocationDesc`
	,`location`.`default_delivery_location_id` `LocationDefaultDeliveryLocationid`
	,`location`.`location_catalogue_id` `LocationCatalogueid`
	,`location`.`staff_location_catalogue_id` `LocationStaffLocationCatalogueid`
	,`location_division`.`division_desc` `LocationDivisionDesc`
	,`location_division_company`.`name` `LocationDivisionCompanyName`
	,`location_company`.`name` `LocationCompanyName`
	,`location_default_delivery_location`.`sla_acc` `LocationDefaultDeliveryLocationSlaAcc`
	,`location_budget_ind`.`budget_desc` `LocationBudgetIndbudgetDesc`
	,`rq_staff`.`join_date` `JoinDate`
	,`rq_staff`.`leave_date` `LeaveDate`
	,`rq_staff`.`comments` `Comments`
	,`rq_staff`.`email` `Email`
	,`rq_staff`.`company_id` `CompanyID`
	,`company`.`name` `CompanyName`
	,`rq_staff`.`userCredentials` `UserCredentials`
	,`rq_staff`.`telephone` `Telephone`
	,`rq_staff`.`internal` `Internal`
	,`rq_staff`.`opex_user` `OpexUser`
	,`rq_staff`.`opex_user_name` `OpexUserName`
	,`rq_staff`.`gender` `Gender`
	,`rq_staff`.`active` `Active`
	,`rq_staff`.`restrict_access` `RestrictAccess`
	,`rq_staff`.`access_control_type` `AccessControlType`
	,`location_catalogue`.`location_catalogue` `LocationCatalogueLocationCatalogue`
	,`location_catalogue`.`description` `LocationCatalogueDescription`
from `opex`.`rq_staff` `rq_staff`
	left join `opex`.`rq_ranks` `rank` on `rq_staff`.`rank_code` = `rank`.`rank_code`
	left join `opex`.`item_staff_filter` `rank_staff_filter` on `rank`.`staff_filter` = `rank_staff_filter`.`staff_filter`
	left join `opex`.`rq_locns` `location` on `rq_staff`.`location_code` = `location`.`location_code`
	left join `opex`.`divisions` `location_division` on `location`.`division_code` = `location_division`.`division_code`
	left join `opex`.`company` `location_division_company` on `location_division`.`company_id` = `location_division_company`.`id`
	left join `opex`.`company` `location_company` on `location`.`company_id` = `location_company`.`id`
	left join `opex`.`locations` `location_default_delivery_location` on `location`.`default_delivery_location_id` = `location_default_delivery_location`.`del_location_id`
	left join `opex`.`rq_budcd` `location_budget_ind` on `location`.`budget_ind` = `location_budget_ind`.`budget_code`
	left join `opex`.`location_catalogue` `location_catalogue` on `location`.`location_catalogue_id` = `location_catalogue`.`location_catalogue_id`
	left join `opex`.`company` `company` on `rq_staff`.`company_id` = `company`.`id`
</text>
      </command>
      <command id="staff_uidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="StaffUid" />
        </output>
      </command>
    </commands>
    <fields xmlns="urn:schemas-codeontime-com:data-aquarium">
      <field name="StaffUid" type="UInt32" allowNulls="false" isPrimaryKey="true" label="Staff Uid" readOnly="true" />
      <field name="StaffCode" type="String" label="Staff Code" length="8" showInSummary="true" />
      <field name="StaffTitle" type="String" label="Staff Title" length="4" showInSummary="true" />
      <field name="Initials" type="String" label="Initials" length="4" showInSummary="true" />
      <field name="Forname" type="String" label="Forname" length="30" showInSummary="true" />
      <field name="Surname" type="String" label="Surname" length="30" showInSummary="true" />
      <field name="RankCode" type="String" allowNulls="false" label="Rank Code" length="8">
        <items style="Lookup" dataController="RqRanks" newDataView="createForm1" dataValueField="RankCode" dataTextField="RankDesc" copy="" />
      </field>
      <field name="RankDesc" type="String" readOnly="true" label="Rank Desc" length="32" />
      <field name="RankStaffFilterstaffFilter" type="String" readOnly="true" label="Rank Staff Filterstaff Filter" length="8" />
      <field name="EplNumber" type="String" label="Epl Number" length="8" />
      <field name="LocationCode" type="String" allowNulls="false" label="Location Code" length="8">
        <items style="Lookup" dataController="OpexrqLocns" newDataView="createForm1" dataValueField="LocationCode" dataTextField="LocationDesc" copy="LocationDefaultDeliveryLocationid=DefaultDeliveryLocationID, LocationDivisionDesc=DivisionDesc, LocationDivisionCompanyName=CompanyName, LocationCompanyName=CompanyName, LocationDefaultDeliveryLocationSlaAcc=DefaultDeliveryLocationSlaAcc, LocationBudgetIndbudgetDesc=BudgetIndbudgetDesc, " />
      </field>
      <field name="LocationDesc" type="String" readOnly="true" label="Location Desc" length="75" />
      <field name="LocationDefaultDeliveryLocationid" type="UInt32" readOnly="true" label="Location Default Delivery Location id" />
      <field name="LocationCatalogueid" type="UInt32" readOnly="true" label="Location Catalogue id" />
      <field name="LocationStaffLocationCatalogueid" type="UInt32" readOnly="true" label="Location Staff Location Catalogue id" />
      <field name="LocationDivisionDesc" type="String" readOnly="true" label="Location Division Desc" length="35" />
      <field name="LocationDivisionCompanyName" type="String" readOnly="true" label="Location Division Company Name" length="20" />
      <field name="LocationCompanyName" type="String" readOnly="true" label="Location Company Name" length="20" />
      <field name="LocationDefaultDeliveryLocationSlaAcc" type="String" readOnly="true" label="Location Default Delivery Location Sla Acc" length="8" />
      <field name="LocationBudgetIndbudgetDesc" type="String" readOnly="true" label="Location Budget Indbudget Desc" length="50" />
      <field name="JoinDate" type="DateTime" label="Join Date" />
      <field name="LeaveDate" type="DateTime" label="Leave Date" />
      <field name="Comments" type="String" label="Comments" length="60" />
      <field name="Email" type="String" label="Email" length="255" />
      <field name="CompanyID" type="UInt32" label="Company Id" />
      <field name="CompanyName" type="String" readOnly="true" label="Company Name" length="20" />
      <field name="UserCredentials" type="String" label="user Credentials" length="100" />
      <field name="Telephone" type="String" label="Telephone" length="40" />
      <field name="Internal" type="String" label="Internal" length="1" />
      <field name="OpexUser" type="String" label="Opex User" length="1" />
      <field name="OpexUserName" type="String" label="Opex User Name" length="256" />
      <field name="Gender" type="String" label="Gender" length="1" />
      <field name="Active" type="String" label="Active" length="1" />
      <field name="RestrictAccess" type="String" label="Restrict Access" length="1" />
      <field name="AccessControlType" type="String" label="Access Control Type" length="1" />
      <field name="LocationCatalogueLocationCatalogue" type="String" readOnly="true" label="Location Catalogue Location Catalogue" length="8" />
      <field name="LocationCatalogueDescription" type="String" readOnly="true" label="Location Catalogue Description" length="100" />
    </fields>
    <views xmlns="urn:schemas-codeontime-com:data-aquarium">
      <view id="grid1" type="Grid" commandId="command1" label="Opexrq Staff" access="Public">
        <headerText>$DefaultGridViewDescription</headerText>
        <dataFields>
          <dataField fieldName="StaffCode" columns="8" />
          <dataField fieldName="StaffTitle" columns="4" />
          <dataField fieldName="Initials" columns="4" />
          <dataField fieldName="Forname" columns="30" />
          <dataField fieldName="Surname" columns="30" />
          <dataField fieldName="RankCode" aliasFieldName="RankDesc" />
          <dataField fieldName="RankStaffFilterstaffFilter" columns="8" />
          <dataField fieldName="EplNumber" columns="8" />
          <dataField fieldName="LocationCode" aliasFieldName="LocationDesc" />
          <dataField fieldName="LocationDefaultDeliveryLocationid" columns="15" />
          <dataField fieldName="LocationCatalogueid" columns="15" />
          <dataField fieldName="LocationStaffLocationCatalogueid" columns="15" />
          <dataField fieldName="LocationDivisionDesc" columns="35" />
          <dataField fieldName="LocationDivisionCompanyName" columns="20" />
          <dataField fieldName="LocationCompanyName" columns="20" />
          <dataField fieldName="LocationDefaultDeliveryLocationSlaAcc" columns="8" />
          <dataField fieldName="LocationBudgetIndbudgetDesc" columns="50" />
          <dataField fieldName="JoinDate" columns="10" />
          <dataField fieldName="LeaveDate" columns="10" />
          <dataField fieldName="Comments" />
          <dataField fieldName="Email" />
          <dataField fieldName="CompanyID" aliasFieldName="CompanyName" />
          <dataField fieldName="UserCredentials" />
          <dataField fieldName="Telephone" columns="40" />
          <dataField fieldName="Internal" columns="1" />
          <dataField fieldName="OpexUser" columns="1" />
          <dataField fieldName="OpexUserName" />
          <dataField fieldName="Gender" columns="1" />
          <dataField fieldName="Active" columns="1" />
          <dataField fieldName="RestrictAccess" columns="1" />
          <dataField fieldName="AccessControlType" columns="1" />
          <dataField fieldName="LocationCatalogueLocationCatalogue" columns="8" />
          <dataField fieldName="LocationCatalogueDescription" />
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Opexrq Staff">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1" headerText="Opexrq Staff">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="StaffCode" columns="8" />
              <dataField fieldName="StaffTitle" columns="4" />
              <dataField fieldName="Initials" columns="4" />
              <dataField fieldName="Forname" columns="30" />
              <dataField fieldName="Surname" columns="30" />
              <dataField fieldName="RankCode" aliasFieldName="RankDesc" />
              <dataField fieldName="RankStaffFilterstaffFilter" columns="8" />
              <dataField fieldName="EplNumber" columns="8" />
              <dataField fieldName="LocationCode" aliasFieldName="LocationDesc" />
              <dataField fieldName="LocationDefaultDeliveryLocationid" columns="15" />
              <dataField fieldName="LocationCatalogueid" columns="15" />
              <dataField fieldName="LocationStaffLocationCatalogueid" columns="15" />
              <dataField fieldName="LocationDivisionDesc" columns="35" />
              <dataField fieldName="LocationDivisionCompanyName" columns="20" />
              <dataField fieldName="LocationCompanyName" columns="20" />
              <dataField fieldName="LocationDefaultDeliveryLocationSlaAcc" columns="8" />
              <dataField fieldName="LocationBudgetIndbudgetDesc" columns="50" />
              <dataField fieldName="JoinDate" columns="10" />
              <dataField fieldName="LeaveDate" columns="10" />
              <dataField fieldName="Comments" />
              <dataField fieldName="Email" />
              <dataField fieldName="CompanyID" aliasFieldName="CompanyName" />
              <dataField fieldName="UserCredentials" />
              <dataField fieldName="Telephone" columns="40" />
              <dataField fieldName="Internal" columns="1" />
              <dataField fieldName="OpexUser" columns="1" />
              <dataField fieldName="OpexUserName" />
              <dataField fieldName="Gender" columns="1" />
              <dataField fieldName="Active" columns="1" />
              <dataField fieldName="RestrictAccess" columns="1" />
              <dataField fieldName="AccessControlType" columns="1" />
              <dataField fieldName="LocationCatalogueLocationCatalogue" columns="8" />
              <dataField fieldName="LocationCatalogueDescription" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexrq Staff">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="StaffCode" columns="8" />
              <dataField fieldName="StaffTitle" columns="4" />
              <dataField fieldName="Initials" columns="4" />
              <dataField fieldName="Forname" columns="30" />
              <dataField fieldName="Surname" columns="30" />
              <dataField fieldName="RankCode" aliasFieldName="RankDesc" />
              <dataField fieldName="RankStaffFilterstaffFilter" columns="8" />
              <dataField fieldName="EplNumber" columns="8" />
              <dataField fieldName="LocationCode" aliasFieldName="LocationDesc" />
              <dataField fieldName="LocationDefaultDeliveryLocationid" columns="15" />
              <dataField fieldName="LocationCatalogueid" columns="15" />
              <dataField fieldName="LocationStaffLocationCatalogueid" columns="15" />
              <dataField fieldName="LocationDivisionDesc" columns="35" />
              <dataField fieldName="LocationDivisionCompanyName" columns="20" />
              <dataField fieldName="LocationCompanyName" columns="20" />
              <dataField fieldName="LocationDefaultDeliveryLocationSlaAcc" columns="8" />
              <dataField fieldName="LocationBudgetIndbudgetDesc" columns="50" />
              <dataField fieldName="JoinDate" columns="10" />
              <dataField fieldName="LeaveDate" columns="10" />
              <dataField fieldName="Comments" />
              <dataField fieldName="Email" />
              <dataField fieldName="CompanyID" aliasFieldName="CompanyName" />
              <dataField fieldName="UserCredentials" />
              <dataField fieldName="Telephone" columns="40" />
              <dataField fieldName="Internal" columns="1" />
              <dataField fieldName="OpexUser" columns="1" />
              <dataField fieldName="OpexUserName" />
              <dataField fieldName="Gender" columns="1" />
              <dataField fieldName="Active" columns="1" />
              <dataField fieldName="RestrictAccess" columns="1" />
              <dataField fieldName="AccessControlType" columns="1" />
              <dataField fieldName="LocationCatalogueLocationCatalogue" columns="8" />
              <dataField fieldName="LocationCatalogueDescription" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions xmlns="urn:schemas-codeontime-com:data-aquarium">
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
        <action id="a2" commandName="Edit" />
        <action id="a3" commandName="Delete" />
        <action id="a6" />
        <action id="a7" commandName="New" commandArgument="grid1" />
        <action id="a8" commandName="Duplicate" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a1" commandName="Edit" />
        <action id="a2" commandName="Delete" />
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag3" scope="ActionBar" headerText="New" flat="true">
        <action id="a1" commandName="New" commandArgument="createForm1" cssClass="NewIcon" />
      </actionGroup>
      <actionGroup id="ag4" scope="ActionBar" headerText="Edit/Delete" flat="true">
        <action id="a1" whenKeySelected="true" commandName="Edit" commandArgument="editForm1" cssClass="EditIcon" whenView="grid1" />
        <action id="a2" whenKeySelected="true" commandName="Delete" cssClass="DeleteIcon" whenView="grid1" />
      </actionGroup>
      <actionGroup id="ag5" scope="ActionBar" headerText="Actions">
        <action id="a1" commandName="ExportCsv" />
        <action id="a2" />
        <action id="a3" commandName="ExportRowset" />
        <action id="a4" commandName="ExportRss" />
        <action id="a5" />
        <action id="a6" commandName="Import" commandArgument="createForm1" />
        <action id="a7" commandName="DataSheet" />
        <action id="a8" commandName="Grid" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag7" scope="ActionBar" headerText="Report">
        <action id="a1" commandName="ReportAsPdf" />
        <action id="a2" commandName="ReportAsImage" />
        <action id="a3" commandName="ReportAsExcel" />
        <action id="a4" commandName="ReportAsWord" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="ItemCataloguePersonal" label="ItemCataloguePersonal" conflictDetection="overwriteChanges" handler="ItemCatalogueBusinessRules" generateDataAccessObjects="true">
    <commands xmlns="urn:schemas-codeontime-com:data-aquarium">
      <command id="command1" type="Text">
        <text>
select
	`st_item`.`rowid` `Rowid`
	,`st_item`.`item_code` `ItemCode`
	,`st_item`.`sti_desc` `StiDesc`
	,`st_item`.`sti_grp1` `StiGrp1`
	,`sti_grp1`.`stg1_grp1_desc` `StiGrp1Stg1Grp1Desc`
	,`st_item`.`sti_grp2` `StiGrp2`
	,`sti_grp2`.`stg2_grp2_desc` `StiGrp2Stg2Grp2Desc`
	,`st_item`.`vat_code` `VatCode`
	,`st_item`.`standard_price` `StandardPrice`
	,`st_item`.`average_cost` `AverageCost`
	,`st_item`.`last_cost` `LastCost`
	,`st_item`.`standard_cost` `StandardCost`
	,`st_item`.`sti_on_stp` `StiOnStp`
	,`st_item`.`sti_stnd_ord_qty` `StiStndOrdQty`
	,`st_item`.`sti_stk_lv` `StiStkLv`
	,`st_item`.`sti_fre_stk` `StiFreStk`
	,`st_item`.`sti_pl_nl_cd` `StiPlNlCd`
	,`st_item`.`sti_cs_nl_cd` `StiCsNlCd`
	,`st_item`.`sti_ci_nl_cd` `StiCiNlCd`
	,`st_item`.`sti_cv_nl_cd` `StiCvNlCd`
	,`st_item`.`sti_disc_cd` `StiDiscCd`
	,`st_item`.`sti_stk_typ` `StiStkTyp`
	,`st_item`.`sti_alt_itm` `StiAltItm`
	,`st_item`.`sti_fifo_low` `StiFifoLow`
	,`st_item`.`sti_fifo_high` `StiFifoHigh`
	,`st_item`.`order_unit` `OrderUnit`
	,`st_item`.`store_unit` `StoreUnit`
	,`st_item`.`price_unit` `PriceUnit`
	,`st_item`.`order_per` `OrderPer`
	,`st_item`.`price_per` `PricePer`
	,`st_item`.`store_per` `StorePer`
	,`st_item`.`size_scale` `SizeScale`
	,`st_item`.`last_receipt_date` `LastReceiptDate`
	,`st_item`.`budget_ind` `BudgetInd`
	,`st_item`.`item_oncost` `ItemOncost`
	,`st_item`.`group_oncost` `GroupOncost`
	,`st_item`.`contract_code` `ContractCode`
	,`st_item`.`max_issue_lv` `MaxIssueLv`
	,`st_item`.`max_order_qty` `MaxOrderQty`
	,`st_item`.`max_stk_lv` `MaxStkLv`
	,`st_item`.`total_issues` `TotalIssues`
	,`st_item`.`frozen_qty` `FrozenQty`
	,`st_item`.`frozen_date` `FrozenDate`
	,`st_item`.`inventory_date` `InventoryDate`
	,`st_item`.`suspense_code` `SuspenseCode`
	,`st_item`.`inventory_code` `InventoryCode`
	,`st_item`.`adjustment_code` `AdjustmentCode`
	,`st_item`.`oncost_code` `OncostCode`
	,`st_item`.`sti_desc2` `StiDesc2`
	,`st_item`.`last_stock_take` `LastStockTake`
	,`st_item`.`wh_code` `WhCode`
	,`wh`.`whse_code` `WhWhseCode`
	,`wh_warehouse_type`.`type_description` `WhWarehouseTypetypeDescription`
	,`st_item`.`staff_allowance` `StaffAllowance`
	,`st_item`.`certification_control` `CertificationControl`
	,`st_item`.`certification_code` `CertificationCode`
	,`certification`.`name` `CertificationName`
	,`st_item`.`serial_numbers` `SerialNumbers`
	,`st_item`.`cost_fifo` `CostFifo`
	,`st_item`.`staff_filter` `StaffFilter`
	,`staff_filter`.`staff_filter` `StaffFilterstaffFilter`
	,`st_item`.`review_period` `ReviewPeriod`
	,`review_period`.`period_code` `ReviewPeriodperiodCode`
	,`st_item`.`company_id` `CompanyID`
	,`company`.`name` `CompanyName`
	,`st_item`.`old_stock_id` `OldStockID`
	,`st_item`.`item_gl_code` `ItemGlCode`
	,`item_gl`.`nla_prt1` `ItemGlNlaPrt1`
	,`st_item`.`item_gender_filter` `ItemGenderFilter`
	,`st_item`.`archive_flag` `ArchiveFlag`
	,`st_item`.`picture1` `Picture1`
	,`st_item`.`vat_id` `VatID`
	,`st_item`.`abc_volume` `AbcVolume`
	,`st_item`.`abc_value` `AbcValue`
	,`st_item`.`abc_transactions` `AbcTransactions`
	,`st_item`.`order_unit_id` `OrderUnitID`
	,`st_item`.`store_unit_id` `StoreUnitID`
	,`store_unit`.`unit_desc` `StoreUnitDesc`
	,`st_item`.`picture` `Picture`
	,`st_item`.`location_catalogue_id` `LocationCatalogueid`
	,`location_catalogue`.`location_catalogue` `LocationCatalogueLocationCatalogue`
	,`location_catalogue`.`description` `LocationCatalogueDescription`
	,`st_item`.`charge_id` `Chargeid`
	,`charge`.`charge_code` `ChargeCode`
	,`charge`.`charge_code_description` `ChargeCodeDescription`
	,`st_item`.`staff_location_catalogue_id` `StaffLocationCatalogueid`
from `opex`.`st_item` `st_item`
	left join `opex`.`st_gp1cd` `sti_grp1` on `st_item`.`sti_grp1` = `sti_grp1`.`sti_grp1`
	left join `opex`.`st_gp2cd` `sti_grp2` on `st_item`.`sti_grp2` = `sti_grp2`.`sti_grp2`
	left join `opex`.`st_whse` `wh` on `st_item`.`wh_code` = `wh`.`whse_code`
	left join `opex`.`warehouse_types` `wh_warehouse_type` on `wh`.`warehouse_type` = `wh_warehouse_type`.`type_id`
	left join `opex`.`st_certs` `certification` on `st_item`.`certification_code` = `certification`.`code`
	left join `opex`.`item_staff_filter` `staff_filter` on `st_item`.`staff_filter` = `staff_filter`.`staff_filter`
	left join `opex`.`review_periods` `review_period` on `st_item`.`review_period` = `review_period`.`period_code`
	left join `opex`.`company` `company` on `st_item`.`company_id` = `company`.`id`
	left join `opex`.`gl_codes` `item_gl` on `st_item`.`item_gl_code` = `item_gl`.`gl_code`
	left join `opex`.`st_units` `store_unit` on `st_item`.`store_unit_id` = `store_unit`.`rowid`
	left join `opex`.`location_catalogue` `location_catalogue` on `st_item`.`location_catalogue_id` = `location_catalogue`.`location_catalogue_id`
	left join `opex`.`st_charge_code` `charge` on `st_item`.`charge_id` = `charge`.`charge_id`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields xmlns="urn:schemas-codeontime-com:data-aquarium">
      <field name="Rowid" type="UInt64" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="ItemCode" type="String" allowNulls="false" label="Item Code" length="16" />
      <field name="StiDesc" type="String" label="Description" length="75" showInSummary="true" />
      <field name="StiGrp1" type="String" label="Group" length="3" showInSummary="true" />
      <field name="StiGrp1Stg1Grp1Desc" type="String" readOnly="true" label="Group" length="20" />
      <field name="StiGrp2" type="String" label="Sti Grp2" length="3" showInSummary="true" />
      <field name="StiGrp2Stg2Grp2Desc" type="String" readOnly="true" label="Group" length="20" />
      <field name="VatCode" type="String" label="Vat Code" length="1" showInSummary="true" />
      <field name="StandardPrice" type="Decimal" dataFormatString="c" label="Standard Price" />
      <field name="AverageCost" type="Decimal" dataFormatString="c" label="Average Cost" />
      <field name="LastCost" type="Decimal" dataFormatString="c" label="Last Cost" />
      <field name="StandardCost" type="Decimal" dataFormatString="c" label="Standard Cost" />
      <field name="StiOnStp" type="String" label="On Stop" length="1" />
      <field name="StiStndOrdQty" type="Decimal" allowNulls="false" label="Sti Stnd Ord Qty" />
      <field name="StiStkLv" type="Decimal" allowNulls="false" label="Sti Stk Lv" />
      <field name="StiFreStk" type="Decimal" allowNulls="false" label="Stock Level" />
      <field name="StiPlNlCd" type="String" label="Sti Pl Nl Cd" length="12" />
      <field name="StiCsNlCd" type="String" label="Sti Cs Nl Cd" length="12" />
      <field name="StiCiNlCd" type="String" label="Sti Ci Nl Cd" length="12" />
      <field name="StiCvNlCd" type="String" label="Sti Cv Nl Cd" length="12" />
      <field name="StiDiscCd" type="String" label="Sti Disc Cd" length="2" />
      <field name="StiStkTyp" type="String" label="Sti Stk Typ" length="1" />
      <field name="StiAltItm" type="String" label="Sti Alt Itm" length="1" />
      <field name="StiFifoLow" type="Int16" label="Sti Fifo Low" />
      <field name="StiFifoHigh" type="Int16" label="Sti Fifo High" />
      <field name="OrderUnit" type="String" label="Order Unit" length="4" />
      <field name="StoreUnit" type="String" label="Store Unit" length="4" />
      <field name="PriceUnit" type="String" dataFormatString="c" label="Price Unit" length="4" />
      <field name="OrderPer" type="Decimal" label="Order Per" />
      <field name="PricePer" type="Decimal" dataFormatString="c" label="Price Per" />
      <field name="StorePer" type="Decimal" label="Store Per" />
      <field name="SizeScale" type="String" label="Size Scale" length="15" />
      <field name="LastReceiptDate" type="DateTime" label="Last Receipt Date" />
      <field name="BudgetInd" type="String" label="Budget Ind" length="8" />
      <field name="ItemOncost" type="String" dataFormatString="c" label="Item Oncost" length="2" />
      <field name="GroupOncost" type="String" dataFormatString="c" label="Group Oncost" length="1" />
      <field name="ContractCode" type="String" label="Contract Code" length="10" />
      <field name="MaxIssueLv" type="Decimal" label="Max Issue Lv" />
      <field name="MaxOrderQty" type="Decimal" label="Max Order Qty" />
      <field name="MaxStkLv" type="Decimal" label="Max Stk Lv" />
      <field name="TotalIssues" type="Decimal" label="Total Issues" />
      <field name="FrozenQty" type="Decimal" label="Frozen Qty" />
      <field name="FrozenDate" type="DateTime" label="Frozen Date" />
      <field name="InventoryDate" type="DateTime" label="Inventory Date" />
      <field name="SuspenseCode" type="String" label="Suspense Code" length="12" />
      <field name="InventoryCode" type="String" label="Inventory Code" length="12" />
      <field name="AdjustmentCode" type="String" label="Adjustment Code" length="12" />
      <field name="OncostCode" type="String" dataFormatString="c" label="Oncost Code" length="12" />
      <field name="StiDesc2" type="String" label="Description" length="75" />
      <field name="LastStockTake" type="DateTime" label="Last Stock Take" />
      <field name="WhCode" type="String" allowNulls="false" label="Wh Code" length="3" />
      <field name="WhWhseCode" type="String" readOnly="true" label="Wh Whse Code" length="3" />
      <field name="WhWarehouseTypetypeDescription" type="String" readOnly="true" label="Wh Warehouse Typetype Description" length="50" />
      <field name="StaffAllowance" type="Int32" label="Staff Allowance" />
      <field name="CertificationControl" type="String" label="Certification Control" length="1" />
      <field name="CertificationCode" type="Int32" label="Certification Code" />
      <field name="CertificationName" type="String" readOnly="true" label="Certification Name" length="25" />
      <field name="SerialNumbers" type="String" label="Serial Numbers" length="1" />
      <field name="CostFifo" type="Decimal" dataFormatString="c" label="Cost Fifo" />
      <field name="StaffFilter" type="String" label="Staff Filter" length="8" />
      <field name="StaffFilterstaffFilter" type="String" readOnly="true" label="Staff Filterstaff Filter" length="8" />
      <field name="ReviewPeriod" type="String" label="Review Period" length="1" />
      <field name="ReviewPeriodperiodCode" type="String" readOnly="true" label="Review Periodperiod Code" length="1" />
      <field name="CompanyID" type="UInt32" label="Company Id" />
      <field name="CompanyName" type="String" readOnly="true" label="Company Name" length="20" />
      <field name="OldStockID" type="String" label="Old Stock Id" length="15" />
      <field name="ItemGlCode" type="String" label="Item Gl Code" length="12">
        <items style="Lookup" dataController="GlCodes" newDataView="createForm1" dataValueField="GlCode" />
      </field>
      <field name="ItemGlNlaPrt1" type="String" readOnly="true" label="Item Gl Nla Prt1" length="4" />
      <field name="ItemGenderFilter" type="String" label="Item Gender Filter" length="1" />
      <field name="ArchiveFlag" type="String" label="Archive Flag" length="1" />
      <field name="Picture1" type="Byte[]" onDemand="true" sourceFields="Rowid" onDemandHandler="st_itemPicture1" onDemandStyle="Thumbnail" allowQBE="false" allowSorting="false" label="Picture1" />
      <field name="VatID" type="Int32" label="Vat Id" />
      <field name="AbcVolume" type="String" label="Abc Volume" length="1" />
      <field name="AbcValue" type="String" label="Abc Value" length="1" />
      <field name="AbcTransactions" type="String" label="Abc Transactions" length="1" />
      <field name="OrderUnitID" type="UInt32" label="Order Unit Id" />
      <field name="StoreUnitID" type="UInt32" label="Store Unit Id" />
      <field name="StoreUnitDesc" type="String" readOnly="true" label="Pack Size" length="32" />
      <field name="Picture" type="Byte[]" onDemand="true" sourceFields="Rowid" onDemandHandler="st_itemPicture" onDemandStyle="Thumbnail" allowQBE="false" allowSorting="false" label="Picture" />
      <field name="LocationCatalogueid" type="UInt32" label="Location Catalogue id" />
      <field name="LocationCatalogueLocationCatalogue" type="String" readOnly="true" label="Location Catalogue Location Catalogue" length="8" />
      <field name="LocationCatalogueDescription" type="String" readOnly="true" label="Location Catalogue Description" length="100" />
      <field name="Chargeid" type="UInt32" label="Charge id" />
      <field name="ChargeCode" type="String" readOnly="true" label="Charge Code" length="2" />
      <field name="ChargeCodeDescription" type="String" readOnly="true" label="Charge Code Description" length="100" />
      <field name="StaffLocationCatalogueid" type="UInt32" label="Staff Location Catalogue id" />
      <field name="Local_OPEXCost" type="Currency" label="Cost" computed="true" isVirtual="true" dataFormatString="C2">
        <formula>OPEXCost(`st_item`.`item_code`,null,null)</formula>
      </field>
      <field name="Local_Description" type="String" label="Description" computed="true" isVirtual="true">
        <formula>concat(	`st_item`.`sti_desc` ," ",COALESCE(`st_item`.`sti_desc2`," "))</formula>
      </field>
      <field name="Local_Groups" type="String" label="Groups" computed="true" isVirtual="true" calculated="true">
        <formula>concat(COALESCE(`sti_grp1`.`stg1_grp1_desc`," ")
   , " "
  ,COALESCE(`sti_grp2`.`stg2_grp2_desc`," ") )</formula>
      </field>
    </fields>
    <views xmlns="urn:schemas-codeontime-com:data-aquarium">
      <view id="grid1" type="Grid" commandId="command1" label="Personal Catalogue" sortExpression="ItemCode asc" filter="StiOnStp =&quot;N&quot;" tags="modal-max-xl multi-select-none view-style-grid-disabled &#xD;&#xA;view-style-list-disabled &#xD;&#xA;view-style-cards&#xD;&#xA;view-style-map-disabled &#xD;&#xA;view-style-calendar-disabled&#xD;&#xA;view-style-charts-disabled">
        <headerText>This is a list of items that can be ordered for your Personal Use</headerText>
        <dataFields>
          <dataField fieldName="ItemCode" columns="16" tag="list-item-desc">
          </dataField>
          <dataField fieldName="StiDesc" tag="list-item-heading">
          </dataField>
          <dataField fieldName="Picture" columns="15">
          </dataField>
          <dataField fieldName="StiGrp1" aliasFieldName="StiGrp1Stg1Grp1Desc" tag="list-item-desc5000, list-item-label10000" columns="20">
          </dataField>
          <dataField fieldName="StaffFilter" columns="8" hidden="true" tag="list-item-desc">
          </dataField>
          <dataField fieldName="Local_OPEXCost" columns="15" tag="list-item-para&#xD;&#xA;list-item-desc">
          </dataField>
          <dataField fieldName="StiFreStk" columns="15" tag="list-item-desc">
          </dataField>
          <dataField fieldName="ChargeCodeDescription" hidden="true">
          </dataField>
          <dataField fieldName="ChargeCode" columns="2" hidden="true">
          </dataField>
          <dataField fieldName="StaffLocationCatalogueid" columns="15" hidden="true">
          </dataField>
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Catalogue">
        <headerText>You can ask a question about this item or add it to your trolley using the buttons below</headerText>
        <categories>
          <category id="Detail" headerText="Detail" tab="Detail">
            <description>Information about this Item</description>
            <dataFields>
              <dataField fieldName="ItemCode" columns="16" />
              <dataField fieldName="Local_Description" rows="5" />
              <dataField fieldName="StiFreStk" columns="15" />
              <dataField fieldName="StoreUnitID" aliasFieldName="StoreUnitDesc" />
              <dataField fieldName="LocationCatalogueid" aliasFieldName="LocationCatalogueLocationCatalogue" hidden="true">
              </dataField>
              <dataField fieldName="LocationCatalogueDescription" hidden="true">
              </dataField>
              <dataField fieldName="ChargeCode" columns="2" hidden="true">
              </dataField>
              <dataField fieldName="ChargeCodeDescription" hidden="true">
              </dataField>
              <dataField fieldName="StaffLocationCatalogueid" columns="15" hidden="true">
              </dataField>
              <dataField fieldName="Local_OPEXCost" columns="15" />
              <dataField fieldName="Local_Groups" rows="5" />
              <dataField fieldName="StiDesc" hidden="true">
              </dataField>
            </dataFields>
          </category>
          <category headerText="Pictures" id="c1" tab="Pictures">
            <description>Images for his Item</description>
            <dataFields>
              <dataField fieldName="Picture" columns="15" />
              <dataField fieldName="Picture1" columns="15" />
            </dataFields>
            <visibility>
              <expression test="[Picture] != null" type="ClientScript" />
            </visibility>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexst Item">
        <headerText>hello</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="ItemCode" columns="16" />
              <dataField fieldName="StiDesc" />
              <dataField fieldName="StiGrp1" aliasFieldName="StiGrp1Stg1Grp1Desc" />
              <dataField fieldName="StiGrp2" aliasFieldName="StiGrp2Stg2Grp2Desc" />
              <dataField fieldName="VatCode" columns="1" />
              <dataField fieldName="StandardPrice" columns="15" />
              <dataField fieldName="AverageCost" columns="15" />
              <dataField fieldName="LastCost" columns="15" />
              <dataField fieldName="StandardCost" columns="15" />
              <dataField fieldName="StiOnStp" columns="1" />
              <dataField fieldName="StiStndOrdQty" columns="15" />
              <dataField fieldName="StiStkLv" columns="15" />
              <dataField fieldName="StiFreStk" columns="15" />
              <dataField fieldName="StiPlNlCd" columns="12" />
              <dataField fieldName="StiCsNlCd" columns="12" />
              <dataField fieldName="StiCiNlCd" columns="12" />
              <dataField fieldName="StiCvNlCd" columns="12" />
              <dataField fieldName="StiDiscCd" columns="2" />
              <dataField fieldName="StiStkTyp" columns="1" />
              <dataField fieldName="StiAltItm" columns="1" />
              <dataField fieldName="StiFifoLow" columns="15" />
              <dataField fieldName="StiFifoHigh" columns="15" />
              <dataField fieldName="OrderUnit" columns="4" />
              <dataField fieldName="StoreUnit" columns="4" />
              <dataField fieldName="PriceUnit" columns="4" />
              <dataField fieldName="OrderPer" columns="15" />
              <dataField fieldName="PricePer" columns="15" />
              <dataField fieldName="StorePer" columns="15" />
              <dataField fieldName="SizeScale" columns="15" />
              <dataField fieldName="LastReceiptDate" columns="10" />
              <dataField fieldName="BudgetInd" columns="8" />
              <dataField fieldName="ItemOncost" columns="2" />
              <dataField fieldName="GroupOncost" columns="1" />
              <dataField fieldName="ContractCode" columns="10" />
              <dataField fieldName="MaxIssueLv" columns="15" />
              <dataField fieldName="MaxOrderQty" columns="15" />
              <dataField fieldName="MaxStkLv" columns="15" />
              <dataField fieldName="TotalIssues" columns="15" />
              <dataField fieldName="FrozenQty" columns="15" />
              <dataField fieldName="FrozenDate" columns="10" />
              <dataField fieldName="InventoryDate" columns="10" />
              <dataField fieldName="SuspenseCode" columns="12" />
              <dataField fieldName="InventoryCode" columns="12" />
              <dataField fieldName="AdjustmentCode" columns="12" />
              <dataField fieldName="OncostCode" columns="12" />
              <dataField fieldName="StiDesc2" />
              <dataField fieldName="LastStockTake" columns="10" />
              <dataField fieldName="WhCode" aliasFieldName="WhWhseCode" />
              <dataField fieldName="WhWarehouseTypetypeDescription" columns="50" />
              <dataField fieldName="StaffAllowance" columns="15" />
              <dataField fieldName="CertificationControl" columns="1" />
              <dataField fieldName="CertificationCode" aliasFieldName="CertificationName" />
              <dataField fieldName="SerialNumbers" columns="1" />
              <dataField fieldName="CostFifo" columns="15" />
              <dataField fieldName="StaffFilter" columns="8" />
              <dataField fieldName="StaffFilterstaffFilter" columns="8" />
              <dataField fieldName="ReviewPeriod" aliasFieldName="ReviewPeriodperiodCode" />
              <dataField fieldName="CompanyID" aliasFieldName="CompanyName" />
              <dataField fieldName="OldStockID" columns="15" />
              <dataField fieldName="ItemGlCode" aliasFieldName="ItemGlNlaPrt1" />
              <dataField fieldName="ItemGenderFilter" columns="1" />
              <dataField fieldName="ArchiveFlag" columns="1" />
              <dataField fieldName="Picture1" columns="15" />
              <dataField fieldName="VatID" columns="15" />
              <dataField fieldName="AbcVolume" columns="1" />
              <dataField fieldName="AbcValue" columns="1" />
              <dataField fieldName="AbcTransactions" columns="1" />
              <dataField fieldName="OrderUnitID" columns="15" />
              <dataField fieldName="StoreUnitID" aliasFieldName="StoreUnitDesc" />
              <dataField fieldName="Picture" columns="15" />
              <dataField fieldName="LocationCatalogueid" aliasFieldName="LocationCatalogueLocationCatalogue" />
              <dataField fieldName="LocationCatalogueDescription" />
              <dataField fieldName="Chargeid" aliasFieldName="ChargeCode" />
              <dataField fieldName="ChargeCodeDescription" />
              <dataField fieldName="StaffLocationCatalogueid" columns="15" hidden="true">
              </dataField>
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions xmlns="urn:schemas-codeontime-com:data-aquarium">
      <actionGroup id="ag1" scope="Grid">
        <action commandName="Custom" commandArgument="Add" headerText="Add to Trolley" causesValidation="false" id="a100" confirmation="_controller=ItemAddPrompt&#xD;&#xA;_title=Add Item to Trolley&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" whenKeySelected="true" cssClass="material-icon-add-shopping-cart" />
        <action id="a1" commandName="Select" commandArgument="editForm1" headerText="More Information" />
        <action commandName="Email" id="a101" headerText="Ask A Question" description="Ask a Question ?" commandArgument="Ask" confirmation="_controller=OfficerEmailPrompt&#xD;&#xA;_title=Ask Question about an Item&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" causesValidation="false" whenKeySelected="false" cssClass="glyphicon-question-sign" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
        <action commandName="Email" id="a101" headerText="Ask A Question" description="Ask a Question ?" commandArgument="Ask" confirmation="_controller=OfficerEmailPrompt&#xD;&#xA;_title=Ask Question about an Item&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" causesValidation="false" whenKeySelected="false" cssClass="glyphicon-question-sign" />
        <action commandName="Custom" commandArgument="Add" headerText="Add to Trolley" causesValidation="false" id="a100" confirmation="_controller=ItemAddPrompt&#xD;&#xA;_title=Ask Item to Trolley&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" whenKeySelected="true" cssClass="glyphicon-shopping-cart" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag100" scope="ActionBar" headerText="Catalogue actions" flat="true">
      </actionGroup>
    </actions>
    <businessRules>
      <rule id="r100" commandName="Email" type="Email" phase="Execute" name="AskAQuestion" commandArgument="Ask">From: "{Parameters_Forname} {Parameters_Surname}" {Parameters_OfficerEmail}
To: {Parameters_AskEmail}
Subject: {Parameters_Subject}
&lt;html&gt;
&lt;body&gt;
&lt;p&gt;
{Parameters_OfficerEmailHeader}
{Parameters_Message}
{Parameters_OfficerEmailFooter}
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</rule>
      <rule id="r101" commandName="Custom" commandArgument="Add" type="Code" phase="Execute" name="AddItemToTrolley" />
      <rule id="r102" commandName="Email" type="Code" phase="After" name="ConfirmEmail" />
      <rule id="r103" commandName="Custom" commandArgument="Add" type="JavaScript" phase="After" name="FullScreen">debugger;
this.preventDefault();


</rule>
      <rule id="r104" commandName="Email" commandArgument="Ask" type="JavaScript" phase="After" name="ShowMessage">debugger;
this.preventDefault();


</rule>
    </businessRules>
  </dataController>
  <dataController name="OfficerEmailPrompt" conflictDetection="overwriteChanges" generateDataAccessObjects="false">
    <fields>
      <field name="ItemCode" type="String" label="Item Code" length="16">
        <codeDefault>SelectFieldValue("Context_ItemCode")</codeDefault>
      </field>
      <field name="StiDesc" type="String" label="Description" length="75" showInSummary="true">
        <codeDefault>SelectFieldValue("Context_StiDesc") ?? (SelectFieldValue("Context_ItemStiDesc") ?? (SelectFieldValue("Context_ItemCodeStiDesc")))</codeDefault>
      </field>
      <field name="SizeCode" type="String" label="Size Code" length="20" showInSummary="true">
        <codeDefault>SelectFieldValue("Context_SizeCode")</codeDefault>
      </field>
      <field name="Message" type="String" label="Message" length="500" allowNulls="false" />
      <field name="Forname" type="String" label="Forname" length="30" showInSummary="true">
        <codeDefault>Officer.staffRecord.Forname</codeDefault>
      </field>
      <field name="Surname" type="String" label="Surname" length="30" showInSummary="true">
        <codeDefault>Officer.staffRecord.Surname</codeDefault>
      </field>
      <field name="AskEmail" type="String" label="To">
        <codeDefault>Context.Session["AskEmail"]</codeDefault>
      </field>
      <field name="OfficerEmail" type="String" label="From">
        <codeDefault>Context.Session["OfficerEmail"]</codeDefault>
      </field>
      <field name="RqHeader" type="Int32" label="Requisition">
        <codeDefault>SelectFieldValue("Context_RqHeader")</codeDefault>
      </field>
      <field name="Subject" type="String" label="Subject" length="100" />
      <field name="OfficerEmailHeader" type="String" label="Email Header">
        <codeDefault>OPEX.OfficerEmailHeader</codeDefault>
      </field>
      <field name="OfficerEmailFooter" type="String" label="Email Header">
        <codeDefault>OPEX.OfficerEmailFooter</codeDefault>
      </field>
    </fields>
    <views>
      <view id="PromptView" type="Form" label="Prompt">
        <categories>
          <category id="c1" headerText="Ask A Question">
            <dataFields>
              <dataField fieldName="OfficerEmail" rows="5" />
              <dataField fieldName="Forname" columns="30" hidden="true">
              </dataField>
              <dataField fieldName="Surname" columns="30" hidden="true">
              </dataField>
              <dataField fieldName="AskEmail" rows="5">
              </dataField>
              <dataField fieldName="RqHeader" columns="15" hidden="true">
                <visibility>
                  <expression test="[RqHeader] != null" type="ClientScript" />
                </visibility>
              </dataField>
              <dataField fieldName="ItemCode" columns="16" hidden="true">
              </dataField>
              <dataField fieldName="StiDesc" rows="5" hidden="true">
              </dataField>
              <dataField fieldName="SizeCode" columns="20" hidden="true">
                <visibility>
                  <expression test="[SizeCode] != null" type="ClientScript" />
                </visibility>
              </dataField>
              <dataField fieldName="Subject" rows="5" />
              <dataField fieldName="Message" rows="5" textMode="RichText">
              </dataField>
              <dataField fieldName="OfficerEmailHeader" rows="5" hidden="true">
              </dataField>
              <dataField fieldName="OfficerEmailFooter" rows="5" hidden="true">
              </dataField>
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <businessRules>
      <rule id="r100" commandName="New" type="Code" phase="Execute" name="SetFieldDefaults" />
    </businessRules>
    <actions>
    </actions>
  </dataController>
  <dataController name="ItemAddPrompt" conflictDetection="overwriteChanges" generateDataAccessObjects="false">
    <fields>
      <field name="ItemCode" type="String" label="Item Code" length="16">
        <codeDefault>SelectFieldValue("Context_ItemCode")</codeDefault>
      </field>
      <field name="ItemStiDesc" type="String" readOnly="true" label="Description" length="75">
        <codeDefault>SelectFieldValue("Context_StiDesc")</codeDefault>
      </field>
      <field name="SizeCode" type="String" label="Size" length="20" showInSummary="true" contextFields="ItemCode=ItemCode" allowNulls="false">
        <items style="Lookup" dataController="ItemSize" dataView="grid1" dataTextField="SizeCode" dataValueField="SizeCode" copy="ReqItemCost=Local_OPEXCost" />
      </field>
      <field name="Qty" type="Decimal" label="Qty" showInSummary="true" allowNulls="false">
        <codeDefault>1</codeDefault>
      </field>
      <field name="CommentCode" type="String" label="Reason Code" length="3" showInSummary="true" allowNulls="false">
        <items style="Lookup" dataController="ReasonCodes" dataValueField="CommentCode" dataTextField="CommentCode" copy="CommentDesc=CommentDesc" dataView="grid1" />
        <codeDefault>(OPEX.companyId == "WF") ? SelectFieldValue("Context_ChargeCode") : SelectFieldValue("CommentCode")</codeDefault>
      </field>
      <field name="UpdateStaffProfile" type="String" label="Update Staff Profile" length="1">
        <codeValue />
        <codeDefault>"N"</codeDefault>
      </field>
      <field name="CommentDesc" type="String" readOnly="true" label="Reason" length="20">
        <codeDefault>(OPEX.companyId == "WF") ? SelectFieldValue("Context_ChargeCodeDescription") : SelectFieldValue("CommentDesc")</codeDefault>
      </field>
      <field name="LineValue" type="Decimal" dataFormatString="C2" label="Line Value" showInSummary="true">
        <codeDefault />
      </field>
      <field name="ReqItemCost" type="Decimal" dataFormatString="C2" label="Item Cost">
        <codeDefault />
      </field>
      <field name="StaffUid" type="UInt32" allowNulls="false" label="Staff Uid">
        <codeValue />
        <codeDefault>Officer.staffRecord.StaffUid</codeDefault>
      </field>
      <field name="Local_StaffProfileSize" type="String" label="Local Staff Profile Size" length="20" />
      <field name="Description" type="String" label="Additional Information" length="500" />
    </fields>
    <views>
      <view id="PromptView" type="Form" label="Prompt" tags="material-icon-add-shopping-cart">
        <categories>
          <category id="c1" headerText="Add Item">
            <dataFields>
              <dataField fieldName="StaffUid" columns="15" hidden="true">
              </dataField>
              <dataField fieldName="ItemCode" columns="16" textMode="Static">
              </dataField>
              <dataField fieldName="ItemStiDesc" rows="5" />
              <dataField fieldName="SizeCode" columns="20" />
              <dataField fieldName="Qty" columns="15" />
              <dataField fieldName="CommentCode" columns="3" />
              <dataField fieldName="CommentDesc" columns="20" />
              <dataField fieldName="UpdateStaffProfile" columns="1" hidden="true">
              </dataField>
              <dataField fieldName="Local_StaffProfileSize" columns="20" hidden="true">
              </dataField>
              <dataField fieldName="ReqItemCost" columns="15" textMode="Static">
              </dataField>
              <dataField fieldName="LineValue" columns="15" textMode="Static">
              </dataField>
              <dataField fieldName="Description" rows="5">
              </dataField>
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <businessRules>
      <rule id="r100" commandName="New" type="Code" phase="Execute" name="GetDefaultSize" />
      <rule id="r101" commandName="Calculate|Confirm" type="JavaScript" phase="Execute" name="CalculateLineCost">var q = [Qty];
var ic = [ReqItemCost];
[LineValue]=q * ic;</rule>
      <rule id="r102" commandName="Confirm" type="JavaScript" phase="Execute" name="UpdateStaffProfile">// Check the size selected against the default one 
// and set the updateStaffProfile if it needs to be updated on Dispatch
// if no entry in staff profile it will create one
debugger;

var sizeCode = [SizeCode];
var profileSizeCode = [Local_StaffProfileSize];
var itemCode = [ItemCode];

if (profileSizeCode == null)
{
  [UpdateStaffProfile] = "Y";
}

else if (sizeCode != profileSizeCode) 
{
  success = this.result.confirm(
    'Update Staff History for {0} change from {1} to {2} ? ',itemCode,profileSizeCode,sizeCode);
  if (success) {
    [UpdateStaffProfile] = "Y";
  }
}
</rule>
    </businessRules>
  </dataController>
  <dataController name="ItemCatalogueLocation" label="ItemCatalogueLocation" conflictDetection="overwriteChanges" handler="ItemCatalogueLocationBusinessRules" generateDataAccessObjects="false">
    <commands xmlns="urn:schemas-codeontime-com:data-aquarium">
      <command id="command1" type="Text">
        <text>
select
	`st_item`.`rowid` `Rowid`
	,`st_item`.`item_code` `ItemCode`
	,`st_item`.`sti_desc` `StiDesc`
	,`st_item`.`sti_grp1` `StiGrp1`
	,`sti_grp1`.`stg1_grp1_desc` `StiGrp1Stg1Grp1Desc`
	,`st_item`.`sti_grp2` `StiGrp2`
	,`sti_grp2`.`stg2_grp2_desc` `StiGrp2Stg2Grp2Desc`
	,`st_item`.`vat_code` `VatCode`
	,`st_item`.`standard_price` `StandardPrice`
	,`st_item`.`average_cost` `AverageCost`
	,`st_item`.`last_cost` `LastCost`
	,`st_item`.`standard_cost` `StandardCost`
	,`st_item`.`sti_on_stp` `StiOnStp`
	,`st_item`.`sti_stnd_ord_qty` `StiStndOrdQty`
	,`st_item`.`sti_stk_lv` `StiStkLv`
	,`st_item`.`sti_fre_stk` `StiFreStk`
	,`st_item`.`sti_pl_nl_cd` `StiPlNlCd`
	,`st_item`.`sti_cs_nl_cd` `StiCsNlCd`
	,`st_item`.`sti_ci_nl_cd` `StiCiNlCd`
	,`st_item`.`sti_cv_nl_cd` `StiCvNlCd`
	,`st_item`.`sti_disc_cd` `StiDiscCd`
	,`st_item`.`sti_stk_typ` `StiStkTyp`
	,`st_item`.`sti_alt_itm` `StiAltItm`
	,`st_item`.`sti_fifo_low` `StiFifoLow`
	,`st_item`.`sti_fifo_high` `StiFifoHigh`
	,`st_item`.`order_unit` `OrderUnit`
	,`st_item`.`store_unit` `StoreUnit`
	,`st_item`.`price_unit` `PriceUnit`
	,`st_item`.`order_per` `OrderPer`
	,`st_item`.`price_per` `PricePer`
	,`st_item`.`store_per` `StorePer`
	,`st_item`.`size_scale` `SizeScale`
	,`st_item`.`last_receipt_date` `LastReceiptDate`
	,`st_item`.`budget_ind` `BudgetInd`
	,`st_item`.`item_oncost` `ItemOncost`
	,`st_item`.`group_oncost` `GroupOncost`
	,`st_item`.`contract_code` `ContractCode`
	,`st_item`.`max_issue_lv` `MaxIssueLv`
	,`st_item`.`max_order_qty` `MaxOrderQty`
	,`st_item`.`max_stk_lv` `MaxStkLv`
	,`st_item`.`total_issues` `TotalIssues`
	,`st_item`.`frozen_qty` `FrozenQty`
	,`st_item`.`frozen_date` `FrozenDate`
	,`st_item`.`inventory_date` `InventoryDate`
	,`st_item`.`suspense_code` `SuspenseCode`
	,`st_item`.`inventory_code` `InventoryCode`
	,`st_item`.`adjustment_code` `AdjustmentCode`
	,`st_item`.`oncost_code` `OncostCode`
	,`st_item`.`sti_desc2` `StiDesc2`
	,`st_item`.`last_stock_take` `LastStockTake`
	,`st_item`.`wh_code` `WhCode`
	,`wh`.`whse_code` `WhWhseCode`
	,`wh_warehouse_type`.`type_description` `WhWarehouseTypetypeDescription`
	,`st_item`.`staff_allowance` `StaffAllowance`
	,`st_item`.`certification_control` `CertificationControl`
	,`st_item`.`certification_code` `CertificationCode`
	,`certification`.`name` `CertificationName`
	,`st_item`.`serial_numbers` `SerialNumbers`
	,`st_item`.`cost_fifo` `CostFifo`
	,`st_item`.`staff_filter` `StaffFilter`
	,`staff_filter`.`staff_filter` `StaffFilterstaffFilter`
	,`st_item`.`review_period` `ReviewPeriod`
	,`review_period`.`period_code` `ReviewPeriodperiodCode`
	,`st_item`.`company_id` `CompanyID`
	,`company`.`name` `CompanyName`
	,`st_item`.`old_stock_id` `OldStockID`
	,`st_item`.`item_gl_code` `ItemGlCode`
	,`item_gl`.`nla_prt1` `ItemGlNlaPrt1`
	,`st_item`.`item_gender_filter` `ItemGenderFilter`
	,`st_item`.`archive_flag` `ArchiveFlag`
	,`st_item`.`picture1` `Picture1`
	,`st_item`.`vat_id` `VatID`
	,`st_item`.`abc_volume` `AbcVolume`
	,`st_item`.`abc_value` `AbcValue`
	,`st_item`.`abc_transactions` `AbcTransactions`
	,`st_item`.`order_unit_id` `OrderUnitID`
	,`st_item`.`store_unit_id` `StoreUnitID`
	,`store_unit`.`unit_desc` `StoreUnitDesc`
	,`st_item`.`picture` `Picture`
	,`st_item`.`location_catalogue_id` `LocationCatalogueid`
	,`location_catalogue`.`location_catalogue` `LocationCatalogueLocationCatalogue`
	,`location_catalogue`.`description` `LocationCatalogueDescription`
	,`st_item`.`charge_id` `Chargeid`
	,`charge`.`charge_code` `ChargeCode`
	,`charge`.`charge_code_description` `ChargeCodeDescription`
	,`st_item`.`staff_location_catalogue_id` `StaffLocationCatalogueid`
from `opex`.`st_item` `st_item`
	left join `opex`.`st_gp1cd` `sti_grp1` on `st_item`.`sti_grp1` = `sti_grp1`.`sti_grp1`
	left join `opex`.`st_gp2cd` `sti_grp2` on `st_item`.`sti_grp2` = `sti_grp2`.`sti_grp2`
	left join `opex`.`st_whse` `wh` on `st_item`.`wh_code` = `wh`.`whse_code`
	left join `opex`.`warehouse_types` `wh_warehouse_type` on `wh`.`warehouse_type` = `wh_warehouse_type`.`type_id`
	left join `opex`.`st_certs` `certification` on `st_item`.`certification_code` = `certification`.`code`
	left join `opex`.`item_staff_filter` `staff_filter` on `st_item`.`staff_filter` = `staff_filter`.`staff_filter`
	left join `opex`.`review_periods` `review_period` on `st_item`.`review_period` = `review_period`.`period_code`
	left join `opex`.`company` `company` on `st_item`.`company_id` = `company`.`id`
	left join `opex`.`gl_codes` `item_gl` on `st_item`.`item_gl_code` = `item_gl`.`gl_code`
	left join `opex`.`st_units` `store_unit` on `st_item`.`store_unit_id` = `store_unit`.`rowid`
	left join `opex`.`location_catalogue` `location_catalogue` on `st_item`.`location_catalogue_id` = `location_catalogue`.`location_catalogue_id`
	left join `opex`.`st_charge_code` `charge` on `st_item`.`charge_id` = `charge`.`charge_id`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields xmlns="urn:schemas-codeontime-com:data-aquarium">
      <field name="Rowid" type="UInt64" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="ItemCode" type="String" allowNulls="false" label="Item Code" length="16" />
      <field name="StiDesc" type="String" label="Description" length="75" showInSummary="true" />
      <field name="StiGrp1" type="String" label="Group" length="3" showInSummary="true" />
      <field name="StiGrp1Stg1Grp1Desc" type="String" readOnly="true" label="Group" length="20" />
      <field name="StiGrp2" type="String" label="Sti Grp2" length="3" showInSummary="true" />
      <field name="StiGrp2Stg2Grp2Desc" type="String" readOnly="true" label="Group" length="20" />
      <field name="VatCode" type="String" label="Vat Code" length="1" showInSummary="true" />
      <field name="StandardPrice" type="Decimal" dataFormatString="c" label="Standard Price" />
      <field name="AverageCost" type="Decimal" dataFormatString="c" label="Average Cost" />
      <field name="LastCost" type="Decimal" dataFormatString="c" label="Last Cost" />
      <field name="StandardCost" type="Decimal" dataFormatString="c" label="Standard Cost" />
      <field name="StiOnStp" type="String" label="On Stop" length="1" />
      <field name="StiStndOrdQty" type="Decimal" allowNulls="false" label="Sti Stnd Ord Qty" />
      <field name="StiStkLv" type="Decimal" allowNulls="false" label="Sti Stk Lv" />
      <field name="StiFreStk" type="Decimal" allowNulls="false" label="Stock Level" />
      <field name="StiPlNlCd" type="String" label="Sti Pl Nl Cd" length="12" />
      <field name="StiCsNlCd" type="String" label="Sti Cs Nl Cd" length="12" />
      <field name="StiCiNlCd" type="String" label="Sti Ci Nl Cd" length="12" />
      <field name="StiCvNlCd" type="String" label="Sti Cv Nl Cd" length="12" />
      <field name="StiDiscCd" type="String" label="Sti Disc Cd" length="2" />
      <field name="StiStkTyp" type="String" label="Sti Stk Typ" length="1" />
      <field name="StiAltItm" type="String" label="Sti Alt Itm" length="1" />
      <field name="StiFifoLow" type="Int16" label="Sti Fifo Low" />
      <field name="StiFifoHigh" type="Int16" label="Sti Fifo High" />
      <field name="OrderUnit" type="String" label="Order Unit" length="4" />
      <field name="StoreUnit" type="String" label="Store Unit" length="4" />
      <field name="PriceUnit" type="String" dataFormatString="c" label="Price Unit" length="4" />
      <field name="OrderPer" type="Decimal" label="Order Per" />
      <field name="PricePer" type="Decimal" dataFormatString="c" label="Price Per" />
      <field name="StorePer" type="Decimal" label="Store Per" />
      <field name="SizeScale" type="String" label="Size Scale" length="15" />
      <field name="LastReceiptDate" type="DateTime" label="Last Receipt Date" />
      <field name="BudgetInd" type="String" label="Budget Ind" length="8" />
      <field name="ItemOncost" type="String" dataFormatString="c" label="Item Oncost" length="2" />
      <field name="GroupOncost" type="String" dataFormatString="c" label="Group Oncost" length="1" />
      <field name="ContractCode" type="String" label="Contract Code" length="10" />
      <field name="MaxIssueLv" type="Decimal" label="Max Issue Lv" />
      <field name="MaxOrderQty" type="Decimal" label="Max Order Qty" />
      <field name="MaxStkLv" type="Decimal" label="Max Stk Lv" />
      <field name="TotalIssues" type="Decimal" label="Total Issues" />
      <field name="FrozenQty" type="Decimal" label="Frozen Qty" />
      <field name="FrozenDate" type="DateTime" label="Frozen Date" />
      <field name="InventoryDate" type="DateTime" label="Inventory Date" />
      <field name="SuspenseCode" type="String" label="Suspense Code" length="12" />
      <field name="InventoryCode" type="String" label="Inventory Code" length="12" />
      <field name="AdjustmentCode" type="String" label="Adjustment Code" length="12" />
      <field name="OncostCode" type="String" dataFormatString="c" label="Oncost Code" length="12" />
      <field name="StiDesc2" type="String" label="Description" length="75" />
      <field name="LastStockTake" type="DateTime" label="Last Stock Take" />
      <field name="WhCode" type="String" allowNulls="false" label="Wh Code" length="3" />
      <field name="WhWhseCode" type="String" readOnly="true" label="Wh Whse Code" length="3" />
      <field name="WhWarehouseTypetypeDescription" type="String" readOnly="true" label="Wh Warehouse Typetype Description" length="50" />
      <field name="StaffAllowance" type="Int32" label="Staff Allowance" />
      <field name="CertificationControl" type="String" label="Certification Control" length="1" />
      <field name="CertificationCode" type="Int32" label="Certification Code" />
      <field name="CertificationName" type="String" readOnly="true" label="Certification Name" length="25" />
      <field name="SerialNumbers" type="String" label="Serial Numbers" length="1" />
      <field name="CostFifo" type="Decimal" dataFormatString="c" label="Cost Fifo" />
      <field name="StaffFilter" type="String" label="Staff Filter" length="8" />
      <field name="StaffFilterstaffFilter" type="String" readOnly="true" label="Staff Filterstaff Filter" length="8" />
      <field name="ReviewPeriod" type="String" label="Review Period" length="1" />
      <field name="ReviewPeriodperiodCode" type="String" readOnly="true" label="Review Periodperiod Code" length="1" />
      <field name="CompanyID" type="UInt32" label="Company Id" />
      <field name="CompanyName" type="String" readOnly="true" label="Company Name" length="20" />
      <field name="OldStockID" type="String" label="Old Stock Id" length="15" />
      <field name="ItemGlCode" type="String" label="Item Gl Code" length="12">
        <items style="Lookup" dataController="GlCodes" newDataView="createForm1" dataValueField="GlCode" />
      </field>
      <field name="ItemGlNlaPrt1" type="String" readOnly="true" label="Item Gl Nla Prt1" length="4" />
      <field name="ItemGenderFilter" type="String" label="Item Gender Filter" length="1" />
      <field name="ArchiveFlag" type="String" label="Archive Flag" length="1" />
      <field name="Picture1" type="Byte[]" onDemand="true" sourceFields="Rowid" onDemandHandler="st_itemPicture1" onDemandStyle="Thumbnail" allowQBE="false" allowSorting="false" label="Picture1" />
      <field name="VatID" type="Int32" label="Vat Id" />
      <field name="AbcVolume" type="String" label="Abc Volume" length="1" />
      <field name="AbcValue" type="String" label="Abc Value" length="1" />
      <field name="AbcTransactions" type="String" label="Abc Transactions" length="1" />
      <field name="OrderUnitID" type="UInt32" label="Order Unit Id" />
      <field name="StoreUnitID" type="UInt32" label="Store Unit Id" />
      <field name="StoreUnitDesc" type="String" readOnly="true" label="Pack Size" length="32" />
      <field name="Picture" type="Byte[]" onDemand="true" sourceFields="Rowid" onDemandHandler="st_itemPicture" onDemandStyle="Thumbnail" allowQBE="false" allowSorting="false" label="Picture" />
      <field name="LocationCatalogueid" type="UInt32" label="Location Catalogue id" />
      <field name="LocationCatalogueLocationCatalogue" type="String" readOnly="true" label="Location Catalogue Location Catalogue" length="8" />
      <field name="LocationCatalogueDescription" type="String" readOnly="true" label="Location Catalogue Description" length="100" />
      <field name="Chargeid" type="UInt32" label="Charge id" />
      <field name="ChargeCode" type="String" readOnly="true" label="Charge Code" length="2" />
      <field name="ChargeCodeDescription" type="String" readOnly="true" label="Charge Code Description" length="100" />
      <field name="StaffLocationCatalogueid" type="UInt32" label="Staff Location Catalogue id" />
      <field name="Local_OPEXCost" type="Currency" label="Cost" computed="true" isVirtual="true" dataFormatString="C2">
        <formula>OPEXCost(`st_item`.`item_code`,null,null)</formula>
      </field>
      <field name="Local_Description" type="String" label="Description" computed="true" isVirtual="true">
        <formula>concat(	`st_item`.`sti_desc` ," ",COALESCE(`st_item`.`sti_desc2`," "))</formula>
      </field>
      <field name="Local_Groups" type="String" label="Groups" computed="true" isVirtual="true" calculated="true">
        <formula>concat(COALESCE(`sti_grp1`.`stg1_grp1_desc`," ")
   , " "
  ,COALESCE(`sti_grp2`.`stg2_grp2_desc`," ") )</formula>
      </field>
    </fields>
    <views xmlns="urn:schemas-codeontime-com:data-aquarium">
      <view id="grid1" type="Grid" commandId="command1" label="Location Catalogue" sortExpression="ItemCode asc" filter="StiOnStp =&quot;N&quot;" tags="modal-max-xl multi-select-none view-style-grid-disabled &#xD;&#xA;view-style-list-disabled &#xD;&#xA;view-style-cards&#xD;&#xA;view-style-map-disabled &#xD;&#xA;view-style-calendar-disabled&#xD;&#xA;view-style-charts-disabled">
        <headerText>This is a list of items that can be ordered for this location</headerText>
        <dataFields>
          <dataField fieldName="ItemCode" columns="16" tag="list-item-desc">
          </dataField>
          <dataField fieldName="StiDesc" tag="list-item-heading">
          </dataField>
          <dataField fieldName="Picture" columns="15">
          </dataField>
          <dataField fieldName="StiGrp1" aliasFieldName="StiGrp1Stg1Grp1Desc">
          </dataField>
          <dataField fieldName="Chargeid" aliasFieldName="ChargeCode" />
          <dataField fieldName="StaffLocationCatalogueid" columns="15" />
          <dataField fieldName="LocationCatalogueid" columns="15" hidden="true">
          </dataField>
          <dataField fieldName="Local_OPEXCost" rows="5" tag="list-item-para&#xD;&#xA;list-item-desc">
          </dataField>
          <dataField fieldName="StiFreStk" columns="15" tag="list-item-desc">
          </dataField>
          <dataField fieldName="ChargeCode" columns="2" hidden="true">
          </dataField>
          <dataField fieldName="ChargeCodeDescription" hidden="true">
          </dataField>
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Catalogue">
        <headerText>You can ask a question about this item or add it to your trolley using the buttons below</headerText>
        <categories>
          <category id="Detail" headerText="Detail" tab="Detail">
            <description>Information about this Item</description>
            <dataFields>
              <dataField fieldName="ItemCode" columns="16" />
              <dataField fieldName="Local_Description" rows="5" />
              <dataField fieldName="StiFreStk" columns="15" />
              <dataField fieldName="StoreUnitID" aliasFieldName="StoreUnitDesc" />
              <dataField fieldName="LocationCatalogueid" aliasFieldName="LocationCatalogueLocationCatalogue" hidden="true">
              </dataField>
              <dataField fieldName="LocationCatalogueDescription" hidden="true">
              </dataField>
              <dataField fieldName="ChargeCode" columns="2" hidden="true">
              </dataField>
              <dataField fieldName="ChargeCodeDescription" hidden="true">
              </dataField>
              <dataField fieldName="StaffLocationCatalogueid" columns="15" />
              <dataField fieldName="Local_OPEXCost" rows="5" />
              <dataField fieldName="Local_Groups" rows="5" />
              <dataField fieldName="StiDesc" hidden="true">
              </dataField>
            </dataFields>
          </category>
          <category headerText="Pictures" id="c1" tab="Pictures">
            <description>Images for his Item</description>
            <dataFields>
              <dataField fieldName="Picture" columns="15" />
              <dataField fieldName="Picture1" columns="15" />
            </dataFields>
            <visibility>
              <expression test="[Picture] != null" type="ClientScript" />
            </visibility>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexst Item">
        <headerText>hello</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="ItemCode" columns="16" />
              <dataField fieldName="StiDesc" />
              <dataField fieldName="StiGrp1" aliasFieldName="StiGrp1Stg1Grp1Desc" />
              <dataField fieldName="StiGrp2" aliasFieldName="StiGrp2Stg2Grp2Desc" />
              <dataField fieldName="VatCode" columns="1" />
              <dataField fieldName="StandardPrice" columns="15" />
              <dataField fieldName="AverageCost" columns="15" />
              <dataField fieldName="LastCost" columns="15" />
              <dataField fieldName="StandardCost" columns="15" />
              <dataField fieldName="StiOnStp" columns="1" />
              <dataField fieldName="StiStndOrdQty" columns="15" />
              <dataField fieldName="StiStkLv" columns="15" />
              <dataField fieldName="StiFreStk" columns="15" />
              <dataField fieldName="StiPlNlCd" columns="12" />
              <dataField fieldName="StiCsNlCd" columns="12" />
              <dataField fieldName="StiCiNlCd" columns="12" />
              <dataField fieldName="StiCvNlCd" columns="12" />
              <dataField fieldName="StiDiscCd" columns="2" />
              <dataField fieldName="StiStkTyp" columns="1" />
              <dataField fieldName="StiAltItm" columns="1" />
              <dataField fieldName="StiFifoLow" columns="15" />
              <dataField fieldName="StiFifoHigh" columns="15" />
              <dataField fieldName="OrderUnit" columns="4" />
              <dataField fieldName="StoreUnit" columns="4" />
              <dataField fieldName="PriceUnit" columns="4" />
              <dataField fieldName="OrderPer" columns="15" />
              <dataField fieldName="PricePer" columns="15" />
              <dataField fieldName="StorePer" columns="15" />
              <dataField fieldName="SizeScale" columns="15" />
              <dataField fieldName="LastReceiptDate" columns="10" />
              <dataField fieldName="BudgetInd" columns="8" />
              <dataField fieldName="ItemOncost" columns="2" />
              <dataField fieldName="GroupOncost" columns="1" />
              <dataField fieldName="ContractCode" columns="10" />
              <dataField fieldName="MaxIssueLv" columns="15" />
              <dataField fieldName="MaxOrderQty" columns="15" />
              <dataField fieldName="MaxStkLv" columns="15" />
              <dataField fieldName="TotalIssues" columns="15" />
              <dataField fieldName="FrozenQty" columns="15" />
              <dataField fieldName="FrozenDate" columns="10" />
              <dataField fieldName="InventoryDate" columns="10" />
              <dataField fieldName="SuspenseCode" columns="12" />
              <dataField fieldName="InventoryCode" columns="12" />
              <dataField fieldName="AdjustmentCode" columns="12" />
              <dataField fieldName="OncostCode" columns="12" />
              <dataField fieldName="StiDesc2" />
              <dataField fieldName="LastStockTake" columns="10" />
              <dataField fieldName="WhCode" aliasFieldName="WhWhseCode" />
              <dataField fieldName="WhWarehouseTypetypeDescription" columns="50" />
              <dataField fieldName="StaffAllowance" columns="15" />
              <dataField fieldName="CertificationControl" columns="1" />
              <dataField fieldName="CertificationCode" aliasFieldName="CertificationName" />
              <dataField fieldName="SerialNumbers" columns="1" />
              <dataField fieldName="CostFifo" columns="15" />
              <dataField fieldName="StaffFilter" columns="8" />
              <dataField fieldName="StaffFilterstaffFilter" columns="8" />
              <dataField fieldName="ReviewPeriod" aliasFieldName="ReviewPeriodperiodCode" />
              <dataField fieldName="CompanyID" aliasFieldName="CompanyName" />
              <dataField fieldName="OldStockID" columns="15" />
              <dataField fieldName="ItemGlCode" aliasFieldName="ItemGlNlaPrt1" />
              <dataField fieldName="ItemGenderFilter" columns="1" />
              <dataField fieldName="ArchiveFlag" columns="1" />
              <dataField fieldName="Picture1" columns="15" />
              <dataField fieldName="VatID" columns="15" />
              <dataField fieldName="AbcVolume" columns="1" />
              <dataField fieldName="AbcValue" columns="1" />
              <dataField fieldName="AbcTransactions" columns="1" />
              <dataField fieldName="OrderUnitID" columns="15" />
              <dataField fieldName="StoreUnitID" aliasFieldName="StoreUnitDesc" />
              <dataField fieldName="Picture" columns="15" />
              <dataField fieldName="LocationCatalogueid" aliasFieldName="LocationCatalogueLocationCatalogue" />
              <dataField fieldName="LocationCatalogueDescription" />
              <dataField fieldName="Chargeid" aliasFieldName="ChargeCode" />
              <dataField fieldName="ChargeCodeDescription" />
              <dataField fieldName="StaffLocationCatalogueid" columns="15" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions xmlns="urn:schemas-codeontime-com:data-aquarium">
      <actionGroup id="ag1" scope="Grid">
        <action commandName="Custom" commandArgument="Add" headerText="Add to Trolley" causesValidation="false" id="a100" confirmation="_controller=ItemAddPromptLocation&#xD;&#xA;_title=Add Item to Location Trolley&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" whenKeySelected="true" cssClass="glyphicon-shopping-cart" />
        <action id="a1" commandName="Select" commandArgument="editForm1" headerText="More Information" />
        <action commandName="Email" id="a101" headerText="Ask A Question" description="Ask a Question ?" commandArgument="Ask" confirmation="_controller=OfficerEmailPrompt&#xD;&#xA;_title=Ask Question about an Item&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" causesValidation="false" whenKeySelected="false" cssClass="glyphicon-question-sign" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
        <action commandName="Email" id="a101" headerText="Ask A Question" description="Ask a Question ?" commandArgument="Ask" confirmation="_controller=OfficerEmailPrompt&#xD;&#xA;_title=Ask Question about an Item&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" causesValidation="false" whenKeySelected="false" cssClass="glyphicon-question-sign" />
        <action commandName="Custom" commandArgument="Add" headerText="Add to Trolley" causesValidation="false" id="a100" confirmation="_controller=ItemAddPrompt&#xD;&#xA;_title=Ask Item to Trolley&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" whenKeySelected="true" cssClass="glyphicon-shopping-cart" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
    <businessRules>
      <rule id="r101" commandName="Custom" commandArgument="Add" type="Code" phase="Execute" name="AddItemToTrolley" />
      <rule id="r100" commandName="Email" type="Email" phase="Execute" name="AskAQuestion" commandArgument="Ask">From: "{Parameters_Forname} {Parameters_Surname}" {Parameters_OfficerEmail}
To: {Parameters_AskEmail}
Subject: {Parameters_Subject}
&lt;html&gt;
&lt;body&gt;
&lt;p&gt;
{Parameters_OfficerEmailHeader}
{Parameters_Message}
{Parameters_OfficerEmailFooter}
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</rule>
      <rule id="r102" commandName="Email" type="Code" phase="After" name="ConfirmEmail" />
      <rule id="r104" commandName="Custom" commandArgument="Add" type="JavaScript" phase="After" name="FullScreen">this.preventDefault();


</rule>
      <rule id="r103" commandName="Email" commandArgument="Ask" type="JavaScript" phase="After" name="ShowMessage">debugger;
this.preventDefault();


</rule>
    </businessRules>
  </dataController>
  <dataController name="RequisitionLinesLocations" label="RequisitionLinesLocations" conflictDetection="overwriteChanges" generateDataAccessObjects="false" handler="RequisitionLinesLocationsBusinessRules">
    <commands xmlns="urn:schemas-codeontime-com:data-aquarium">
      <command id="command1" type="Text">
        <text>
select
	`rq_rqitm_2`.`rowid` `Rowid`
	,`rq_rqitm_2`.`item_code` `ItemCode`
	,`item`.`sti_desc` `StiDesc`
	,`rq_rqitm_2`.`size_code` `SizeCode`
	,`rq_rqitm_2`.`outs_qty` `OutsQty`
	,`rq_rqitm_2`.`comment_code` `CommentCode`
	,`comment`.`comment_desc` `CommentDesc`
	,`rq_rqitm_2`.`whse_code` `WhseCode`
	,`whse`.`stwh_desc` `Warehouse`
	,`rq_rqitm_2`.`status_code` `StatusCode`
	,`status`.`status_description` `StatusDescription`
	,`rq_rqitm_2`.`line_value` `LineValue`
	,`rq_rqitm_2`.`alloc_qty` `AllocQty`
	,`rq_rqitm_2`.`orig_qty` `OrigQty`
	,`rq_rqitm_2`.`req_item_cost` `ReqItemCost`
	,`rq_rqitm_2`.`budget_ind` `BudgetInd`
	,`rq_rqitm_2`.`return_dt` `ReturnDt`
	,`rq_rqitm_2`.`rq_header` `RqHeader`
	,`rq_header`.`staff_code` `RqHeaderstaffCode`
	,`rq_header`.`staff_uid` `rqHeaderStaffUid`
	,`rq_header`.`location_code` `rqHeaderLocationCode`
	,`rq_header`.`rqn_prefix` `rqHeaderRqnPrefix`
	,`rq_rqitm_2`.`date_time_placed` `DateTimePlaced`
	,`rq_rqitm_2`.`date_time_rcvd` `DateTimeRcvd`
	,`rq_rqitm_2`.`return_qty_total` `ReturnQtyTotal`
	,`rq_rqitm_2`.`serial_number_id` `SerialNumberID`
	,`serial_number`.`serial_number` `SerialNumberSerialNumber`
	,`serial_number`.`item_condition_code` `ConditionCode`
	,`rq_rqitm_2`.`gl_code` `GlCode`
	,`gl`.`gl_description` `glDescription`
	,`rq_rqitm_2`.`dispatch_id` `DispatchID`
	,`dispatch`.`status_code` `DispatchStatusCode`
	,`rq_rqitm_2`.`additional_text` `AdditionalText`
	,`item_condition_code`.`description` `ItemConditionCodeDescription`
	,`location_code`.`location_desc` `LocationCodeLocationDesc`
from `opex`.`rq_rqitm_2` `rq_rqitm_2`
	left join `opex`.`rq_comms` `comment` on `rq_rqitm_2`.`comment_code` = `comment`.`comment_code`
	left join `opex`.`st_whse` `whse` on `rq_rqitm_2`.`whse_code` = `whse`.`whse_code`
	left join `opex`.`rq_status` `status` on `rq_rqitm_2`.`status_code` = `status`.`status_code`
	left join `opex`.`rq_rqns` `rq_header` on `rq_rqitm_2`.`rq_header` = `rq_header`.`rowid`
	left join `opex`.`rq_locns` `location_code` on `rq_header`.`location_code` = `location_code`.`location_code`
	left join `opex`.`serial_numbers` `serial_number` on `rq_rqitm_2`.`serial_number_id` = `serial_number`.`id`
	left join `opex`.`item_condition_status` `item_condition_code` on `serial_number`.`item_condition_code` = `item_condition_code`.`item_condition_code`
	left join `opex`.`gl_codes` `gl` on `rq_rqitm_2`.`gl_code` = `gl`.`gl_code`
	left join `opex`.`requisition_dispatch_detail` `dispatch` on `rq_rqitm_2`.`dispatch_id` = `dispatch`.`dispatch_id`
	left join `opex`.`st_item` `item` on `rq_rqitm_2`.`item_code` = `item`.`item_code`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields xmlns="urn:schemas-codeontime-com:data-aquarium">
      <field name="Rowid" type="Int32" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="ItemCode" type="String" label="Item Code" length="16" showInSummary="true">
        <items style="Lookup" dataController="Item" dataValueField="ItemCode" dataTextField="ItemCode" copy="StiDesc=StiDesc" dataView="grid1" />
      </field>
      <field name="StiDesc" type="String" readOnly="true" label="Item Description" length="75" />
      <field name="SizeCode" type="String" allowNulls="false" label="Size Code" length="20" showInSummary="true" />
      <field name="OutsQty" type="Decimal" label="Outstanding" showInSummary="true" />
      <field name="CommentCode" type="String" label="Reason Code" length="3" showInSummary="true">
        <items style="Lookup" dataController="ReasonCodes" newDataView="createForm1" dataValueField="CommentCode" dataTextField="CommentCode" copy="CommentDesc=CommentDesc" />
      </field>
      <field name="CommentDesc" type="String" readOnly="true" label="Reason" length="20" />
      <field name="WhseCode" type="String" label="Warehouse Code" length="3" showInSummary="true" />
      <field name="Warehouse" type="String" readOnly="true" label="Warehouse" length="32" />
      <field name="StatusCode" type="String" label="Status Code" length="2" />
      <field name="StatusDescription" type="String" readOnly="true" label="Status" length="50" />
      <field name="LineValue" type="Decimal" label="Cost" dataFormatString="C2" />
      <field name="AllocQty" type="Decimal" label="Issued" />
      <field name="OrigQty" type="Decimal" allowNulls="false" label="Requested" />
      <field name="ReqItemCost" type="Decimal" dataFormatString="C2" label="Item Cost" />
      <field name="BudgetInd" type="String" label="Budget Ind" length="8" />
      <field name="ReturnDt" type="DateTime" label="Returned" />
      <field name="RqHeader" type="Int32" allowNulls="false" label="Requisition" />
      <field name="RqHeaderstaffCode" type="String" readOnly="true" label="Staff Code" length="8" />
      <field name="rqHeaderStaffUid" type="UInt32" readOnly="true" label="Staff UID" />
      <field name="rqHeaderLocationCode" type="String" readOnly="true" label="rq Header Location Code" length="8" />
      <field name="rqHeaderRqnPrefix" type="String" readOnly="true" label="rq Header Rqn Prefix" length="2" />
      <field name="DateTimePlaced" type="DateTime" label="Placed" dataFormatString="d" />
      <field name="DateTimeRcvd" type="DateTime" label="Dispatched" dataFormatString="d" />
      <field name="ReturnQtyTotal" type="Int32" label="Returned" />
      <field name="SerialNumberID" type="Int32" label="Serial Number Id">
        <items style="Lookup" dataController="SerialNumbersLocation" newDataView="createForm1" dataValueField="ID" dataTextField="ItemCode" copy="SerialNumberSerialNumber=SerialNumber, ConditionCode=ItemConditionCode, ItemConditionCodeDescription=ItemConditionDescription" />
      </field>
      <field name="SerialNumberSerialNumber" type="String" readOnly="true" label="Serial Number" length="20" />
      <field name="ConditionCode" type="String" readOnly="true" label="Serial Number Item Condition Code" length="1" />
      <field name="GlCode" type="String" label="GL Code" length="12">
        <items style="Lookup" dataController="GlCodes" newDataView="createForm1" dataValueField="GlCode" dataTextField="GlCode" copy="glDescription=GlDescription" />
      </field>
      <field name="glDescription" type="String" readOnly="true" label="GL description" length="50" />
      <field name="DispatchID" type="UInt32" label="Dispatch Id" />
      <field name="DispatchStatusCode" type="String" readOnly="true" label="Dispatch Status Code" length="2" />
      <field name="AdditionalText" type="String" label="Additional Text" length="500" />
      <field name="ItemConditionCodeDescription" type="String" readOnly="true" label="Item Condition" length="50" />
      <field name="LocationCodeLocationDesc" type="String" readOnly="true" label="Location Code Location Desc" length="75" />
    </fields>
    <views xmlns="urn:schemas-codeontime-com:data-aquarium">
      <view id="grid1" type="Grid" commandId="command1" label="Location Requisitioned Items (Outstanding)" sortExpression="RqHeader desc, ItemCode desc" filter="`rq_rqitm_2`.`status_code`  not like &quot;N%&quot;&#xD;&#xA;AND&#xD;&#xA;(&#xD;&#xA;`rq_rqitm_2`.`status_code` in (&quot;OS&quot;,&quot;SU&quot;,&quot;EN&quot;,&quot;SQ&quot;,&quot;EA&quot;,&quot;WT&quot;,&quot;SN&quot;,&quot;TW&quot;,&quot;HD&quot;,&quot;CF&quot;,&quot;DS&quot;) OR&#xD;&#xA;(`rq_rqitm_2`.status_code  in (&quot;AL&quot;,&quot;PA&quot;,&quot;PK&quot; ) AND `rq_rqitm_2`.tailoring_for is null)&#xD;&#xA;)&#xD;&#xA;AND&#xD;&#xA;`rq_header`.`rqn_prefix` in (&quot;ST&quot;,&quot;SX&quot;)">
        <headerText>This is a list of requisitioned items that are outstanding for this location</headerText>
        <dataFields>
          <dataField fieldName="RqHeader">
          </dataField>
          <dataField fieldName="ItemCode" columns="16" />
          <dataField fieldName="StiDesc" columns="50" rows="5">
          </dataField>
          <dataField fieldName="SizeCode" columns="20" />
          <dataField fieldName="StatusDescription" columns="50" rows="5">
          </dataField>
          <dataField fieldName="OrigQty" columns="15" />
          <dataField fieldName="AllocQty" columns="15" />
          <dataField fieldName="OutsQty" columns="15" />
          <dataField fieldName="ReqItemCost" columns="15" />
          <dataField fieldName="LineValue" columns="15" />
          <dataField fieldName="rqHeaderRqnPrefix" columns="2" hidden="true">
          </dataField>
          <dataField fieldName="DateTimePlaced" columns="10" />
          <dataField fieldName="DateTimeRcvd" columns="10">
          </dataField>
          <dataField fieldName="rqHeaderLocationCode" columns="8" hidden="true">
          </dataField>
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Requisiton Detail">
        <headerText />
        <categories>
          <category id="c1" headerText="Detail" tab="Detail">
            <description />
            <dataFields>
              <dataField fieldName="RqHeader" columns="15" />
              <dataField fieldName="ItemCode" columns="16" />
              <dataField fieldName="StiDesc" />
              <dataField fieldName="SizeCode" columns="20" />
              <dataField fieldName="StatusDescription" columns="50" />
              <dataField fieldName="CommentDesc" columns="20" />
              <dataField fieldName="rqHeaderLocationCode" columns="8" hidden="true">
              </dataField>
              <dataField fieldName="rqHeaderRqnPrefix" columns="2" hidden="true">
              </dataField>
              <dataField fieldName="AdditionalText" />
              <dataField fieldName="LocationCodeLocationDesc" hidden="true">
              </dataField>
            </dataFields>
          </category>
          <category headerText="Qty" id="c5" tab="Qty">
            <dataFields>
              <dataField fieldName="OrigQty" columns="15" />
              <dataField fieldName="AllocQty" columns="15" />
              <dataField fieldName="OutsQty" columns="15" />
              <dataField fieldName="ReturnQtyTotal" columns="15" />
            </dataFields>
          </category>
          <category headerText="Dates" tab="Dates" id="c2">
            <dataFields>
              <dataField fieldName="DateTimePlaced" columns="10" />
              <dataField fieldName="DateTimeRcvd" columns="10" />
              <dataField fieldName="ReturnDt" columns="10" />
            </dataFields>
          </category>
          <category headerText="Costs" tab="Costs" id="c3">
            <dataFields>
              <dataField fieldName="ReqItemCost" columns="15" />
              <dataField fieldName="LineValue" columns="15" />
            </dataFields>
          </category>
          <category headerText="Serial Numbers" tab="Serial Numbers" id="c4">
            <dataFields>
              <dataField fieldName="SerialNumberSerialNumber" columns="20" />
              <dataField fieldName="ItemConditionCodeDescription" columns="50" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexrq Rqitm2">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="ItemCode" columns="16" />
              <dataField fieldName="StiDesc" />
              <dataField fieldName="SizeCode" columns="20" />
              <dataField fieldName="OutsQty" columns="15" />
              <dataField fieldName="CommentCode" columns="3" />
              <dataField fieldName="CommentDesc" columns="20" />
              <dataField fieldName="WhseCode" columns="3" />
              <dataField fieldName="Warehouse" columns="32" />
              <dataField fieldName="StatusCode" columns="2" />
              <dataField fieldName="StatusDescription" columns="50" />
              <dataField fieldName="LineValue" columns="15" />
              <dataField fieldName="AllocQty" columns="15" />
              <dataField fieldName="OrigQty" columns="15" />
              <dataField fieldName="ReqItemCost" columns="15" />
              <dataField fieldName="BudgetInd" columns="8" />
              <dataField fieldName="ReturnDt" columns="10" />
              <dataField fieldName="RqHeader" aliasFieldName="RqHeaderstaffCode" />
              <dataField fieldName="rqHeaderStaffUid" columns="15" />
              <dataField fieldName="rqHeaderLocationCode" columns="8" />
              <dataField fieldName="rqHeaderRqnPrefix" columns="2" />
              <dataField fieldName="DateTimePlaced" columns="10" />
              <dataField fieldName="DateTimeRcvd" columns="10" />
              <dataField fieldName="ReturnQtyTotal" columns="15" />
              <dataField fieldName="SerialNumberID" aliasFieldName="CleanIdentifier-Error" />
              <dataField fieldName="SerialNumberSerialNumber" columns="20" />
              <dataField fieldName="ConditionCode" columns="1" />
              <dataField fieldName="GlCode" columns="12" />
              <dataField fieldName="glDescription" columns="50" />
              <dataField fieldName="DispatchID" columns="15" />
              <dataField fieldName="DispatchStatusCode" columns="2" />
              <dataField fieldName="AdditionalText" />
              <dataField fieldName="ItemConditionCodeDescription" columns="50" />
              <dataField fieldName="LocationCodeLocationDesc" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="gridAll" commandId="command1" type="Grid" label="Location Requisitioned Items (All)" baseViewId="grid1" filter="`rq_rqitm_2`.`status_code`  not like &quot;N%&quot;&#xD;&#xA;AND&#xD;&#xA;`rq_header`.`rqn_prefix` in (&quot;ST&quot;,&quot;SX&quot;)" sortExpression="RqHeader desc, ItemCode desc">
        <headerText>This is a list of all requisitioned items for this location</headerText>
      </view>
    </views>
    <actions xmlns="urn:schemas-codeontime-com:data-aquarium">
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" headerText="More Information" />
        <action commandName="Email" id="a101" headerText="Ask A Question" description="Ask a Question ?" commandArgument="Ask" confirmation="_controller=OfficerEmailPrompt&#xD;&#xA;_title=Ask Question about an Item&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" causesValidation="false" whenKeySelected="false" cssClass="glyphicon-question-sign" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
        <action commandName="Email" id="a101" headerText="Ask A Question" description="Ask a Question ?" commandArgument="Ask" confirmation="_controller=OfficerEmailPrompt&#xD;&#xA;_title=Ask Question about an Item&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" causesValidation="false" whenKeySelected="false" cssClass="glyphicon-question-sign" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
    <businessRules xmlns="urn:schemas-codeontime-com:data-aquarium">
      <rule id="r100" commandName="Email" type="Email" phase="Execute" name="AskAQuestion" commandArgument="Ask">From: "{Parameters_Forname} {Parameters_Surname}" {Parameters_OfficerEmail}
To: {Parameters_AskEmail}
Subject: {Parameters_Subject}
&lt;html&gt;
&lt;body&gt;
&lt;p&gt;
{Parameters_OfficerEmailHeader}
{Parameters_Message}
{Parameters_OfficerEmailFooter}
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</rule>
      <rule id="r102" commandName="Email" type="Code" phase="After" name="ConfirmEmail" />
    </businessRules>
  </dataController>
  <dataController name="ItemAddPromptLocation" conflictDetection="overwriteChanges" generateDataAccessObjects="false">
    <fields>
      <field name="ItemCode" type="String" label="Item Code" length="16">
        <codeDefault>SelectFieldValue("Context_ItemCode")</codeDefault>
      </field>
      <field name="ItemStiDesc" type="String" readOnly="true" label="Description" length="75">
        <codeDefault>SelectFieldValue("Context_StiDesc")</codeDefault>
      </field>
      <field name="SizeCode" type="String" label="Size" length="20" showInSummary="true" contextFields="ItemCode=ItemCode" causesCalculate="true" allowNulls="false">
        <items style="Lookup" dataController="ItemSize" dataView="grid1" dataTextField="SizeCode" dataValueField="SizeCode" copy="ReqItemCost=Local_OPEXCost" />
      </field>
      <field name="Qty" type="Decimal" label="Qty" showInSummary="true" allowNulls="false">
        <codeDefault>1</codeDefault>
      </field>
      <field name="CommentCode" type="String" label="Reason Code" length="3" showInSummary="true" allowNulls="false">
        <items style="Lookup" dataController="ReasonCodes" dataValueField="CommentCode" dataTextField="CommentCode" copy="CommentDesc=CommentDesc" dataView="grid1" />
        <codeDefault>(OPEX.companyId == "WF") ? SelectFieldValue("Context_ChargeCode") : SelectFieldValue("CommentCode")</codeDefault>
      </field>
      <field name="UpdateStaffProfile" type="String" label="Update Staff Profile" length="1">
        <codeValue />
        <codeDefault>"N"</codeDefault>
      </field>
      <field name="CommentDesc" type="String" readOnly="true" label="Reason" length="20">
        <codeDefault>(OPEX.companyId == "WF") ? SelectFieldValue("Context_ChargeCodeDescription") : SelectFieldValue("CommentDesc")</codeDefault>
      </field>
      <field name="LineValue" type="Decimal" dataFormatString="C2" label="Line Value" showInSummary="true" />
      <field name="ReqItemCost" type="Decimal" dataFormatString="C2" label="Item Cost" />
      <field name="StaffUid" type="UInt32" allowNulls="false" label="Staff Uid">
        <codeValue />
        <codeDefault>Officer.staffRecord.StaffUid</codeDefault>
      </field>
      <field name="Local_StaffProfileSize" type="String" label="Local Staff Profile Size" length="20" />
      <field name="Description" type="String" label="Additional Information" length="500" />
    </fields>
    <views>
      <view id="PromptView" type="Form" label="Prompt">
        <categories>
          <category id="c1" headerText="Add Item">
            <dataFields>
              <dataField fieldName="StaffUid" columns="15" hidden="true">
              </dataField>
              <dataField fieldName="ItemCode" columns="16" textMode="Static">
              </dataField>
              <dataField fieldName="ItemStiDesc" rows="5" />
              <dataField fieldName="SizeCode" columns="20" watermark="Choose a Size">
              </dataField>
              <dataField fieldName="Qty" columns="15" />
              <dataField fieldName="CommentCode" columns="3" />
              <dataField fieldName="CommentDesc" columns="20" />
              <dataField fieldName="UpdateStaffProfile" columns="1" hidden="true">
              </dataField>
              <dataField fieldName="Local_StaffProfileSize" columns="20" hidden="true">
              </dataField>
              <dataField fieldName="ReqItemCost" columns="15" textMode="Static">
              </dataField>
              <dataField fieldName="LineValue" columns="15" textMode="Static">
              </dataField>
              <dataField fieldName="Description" rows="5" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <businessRules>
      <rule id="r100" commandName="New" type="Code" phase="Execute" name="GetDefaultSize" />
      <rule id="r101" commandName="Calculate" type="JavaScript" phase="Execute" name="CalculateLineCost">var q = [Qty];
var ic = [ReqItemCost];
[LineValue]=q * ic;</rule>
      <rule id="r102" commandName="Confirm" type="JavaScript" phase="Execute" name="UpdateStaffProfile">// Check the size selected against the default one 
// and set the updateStaffProfile if it needs to be updated on Dispatch
// if no entry in staff profile it will create one
debugger;

var sizeCode = [SizeCode];
var profileSizeCode = [Local_StaffProfileSize];
var itemCode = [ItemCode];

if (profileSizeCode == null)
{
  [UpdateStaffProfile] = "Y";
}

else if (sizeCode != profileSizeCode) 
{
  success = this.result.confirm(
    'Update Staff History for {0} change from {1} to {2} ? ',itemCode,profileSizeCode,sizeCode);
  if (success) {
    [UpdateStaffProfile] = "Y";
  }
}
</rule>
    </businessRules>
  </dataController>
  <dataController name="SerialNumbersReplacePrompt" conflictDetection="overwriteChanges" generateDataAccessObjects="false">
    <fields>
      <field name="SerialNumber" type="String" allowNulls="false" label="Returning Serial Number" length="20" showInSummary="true">
        <codeDefault>SelectFieldValue("Context_SerialNumber")</codeDefault>
      </field>
      <field name="ItemCode" type="String" allowNulls="false" label="Item Code" length="16" showInSummary="true">
        <items dataController="Item" newDataView="createForm1" dataValueField="ItemCode" dataTextField="StiDesc" />
        <codeDefault>SelectFieldValue("Context_ItemCode")</codeDefault>
      </field>
      <field name="NewSerialNumber" type="String" label="New Serial Number" contextFields="ItemCode=ItemCode" />
      <field name="NewSerialNumberId" type="Int32" label="New Serial Number" contextFields="ItemCode=ItemCode">
        <items style="Lookup" dataController="SerialNumbersLocation" dataView="gridIssued" dataTextField="SerialNumber" dataValueField="ID" copy="NewSerialNumber=SerialNumber" />
      </field>
      <field name="ItemStiDesc" type="String" readOnly="true" label="Item" length="75" allowNulls="false">
        <codeDefault>SelectFieldValue("Context_ItemStiDesc")</codeDefault>
      </field>
    </fields>
    <views>
      <view id="Prompt" type="Form" label="New Details">
        <categories>
          <category id="c1" headerText="Serial Numbers Replace">
            <dataFields>
              <dataField fieldName="SerialNumber" columns="20" textMode="Static">
              </dataField>
              <dataField fieldName="ItemStiDesc" rows="5" />
              <dataField fieldName="ItemCode" columns="16" textMode="Static">
              </dataField>
              <dataField fieldName="NewSerialNumberId" columns="15" />
              <dataField fieldName="NewSerialNumber" columns="15" hidden="true">
              </dataField>
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
  </dataController>
  <dataController name="SerialNumbersAssignPrompt" conflictDetection="overwriteChanges" generateDataAccessObjects="false">
    <fields>
      <field name="SerialNumber" type="String" allowNulls="false" label="Issuing Serial Number" length="20" showInSummary="true">
        <codeDefault>SelectFieldValue("Context_SerialNumber")</codeDefault>
      </field>
      <field name="ItemCode" type="String" allowNulls="false" label="Item Code" length="16" showInSummary="true">
        <items dataController="Item" newDataView="createForm1" dataValueField="ItemCode" dataTextField="StiDesc" />
        <codeDefault>SelectFieldValue("Context_ItemCode")</codeDefault>
      </field>
      <field name="ItemStiDesc" type="String" readOnly="true" label="Item" length="75" allowNulls="false">
        <codeDefault>SelectFieldValue("Context_ItemStiDesc")</codeDefault>
      </field>
      <field name="StaffEpl" type="String" label="EPL Number" contextFields="ItemCode=ItemCode" />
      <field name="StaffSurname" type="String" label="Surname" contextFields="ItemCode=ItemCode" />
      <field name="StaffId" type="Int32" label="Assign To" contextFields="LocationCode=LocationCode">
        <items style="Lookup" dataController="StaffUnrestricted" dataView="grid1" dataTextField="Surname" dataValueField="StaffUid" copy="StaffEpl=EplNumber&#xD;&#xA;StaffSurname=Surname" description="Staff to Assign to" />
      </field>
      <field name="LocationCode" type="String" label="Location Code" length="8">
        <codeDefault>SelectFieldValue("Context_LocationCode")</codeDefault>
      </field>
    </fields>
    <views>
      <view id="Prompt" type="Form" label="Assign">
        <headerText>Enter the Officer to Assign to</headerText>
        <categories>
          <category id="c1" headerText="Serial Numbers Assign Prompt">
            <dataFields>
              <dataField fieldName="LocationCode" columns="8">
              </dataField>
              <dataField fieldName="ItemCode" columns="16" />
              <dataField fieldName="ItemStiDesc" rows="5" />
              <dataField fieldName="SerialNumber" columns="20" />
              <dataField fieldName="StaffId" columns="15" />
              <dataField fieldName="StaffEpl" rows="5" />
              <dataField fieldName="StaffSurname" rows="5" hidden="true">
              </dataField>
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
  </dataController>
  <dataController name="StaffUnrestricted" label="StaffUnrestricted" conflictDetection="overwriteChanges" generateDataAccessObjects="true">
    <commands xmlns="urn:schemas-codeontime-com:data-aquarium">
      <command id="command1" type="Text">
        <text>
select
	`rq_staff`.`staff_uid` `StaffUid`
	,`rq_staff`.`staff_code` `StaffCode`
	,`rq_staff`.`staff_title` `StaffTitle`
	,`rq_staff`.`initials` `Initials`
	,`rq_staff`.`forname` `Forname`
	,`rq_staff`.`surname` `Surname`
	,`rq_staff`.`rank_code` `RankCode`
	,`rank`.`rank_desc` `RankDesc`
	,`rank_staff_filter`.`staff_filter` `RankStaffFilterstaffFilter`
	,`rq_staff`.`epl_number` `EplNumber`
	,`rq_staff`.`location_code` `LocationCode`
	,`location`.`location_desc` `LocationDesc`
	,`location`.`default_delivery_location_id` `LocationDefaultDeliveryLocationid`
	,`location`.`location_catalogue_id` `LocationCatalogueid`
	,`location`.`staff_location_catalogue_id` `LocationStaffLocationCatalogueid`
	,`location_division`.`division_desc` `LocationDivisionDesc`
	,`location_division_company`.`name` `LocationDivisionCompanyName`
	,`location_company`.`name` `LocationCompanyName`
	,`location_default_delivery_location`.`sla_acc` `LocationDefaultDeliveryLocationSlaAcc`
	,`location_budget_ind`.`budget_desc` `LocationBudgetIndbudgetDesc`
	,`rq_staff`.`join_date` `JoinDate`
	,`rq_staff`.`leave_date` `LeaveDate`
	,`rq_staff`.`comments` `Comments`
	,`rq_staff`.`email` `Email`
	,`rq_staff`.`company_id` `CompanyID`
	,`company`.`name` `CompanyName`
	,`rq_staff`.`userCredentials` `UserCredentials`
	,`rq_staff`.`telephone` `Telephone`
	,`rq_staff`.`internal` `Internal`
	,`rq_staff`.`opex_user` `OpexUser`
	,`rq_staff`.`opex_user_name` `OpexUserName`
	,`rq_staff`.`gender` `Gender`
	,`rq_staff`.`active` `Active`
	,`rq_staff`.`restrict_access` `RestrictAccess`
	,`rq_staff`.`access_control_type` `AccessControlType`
	,`location_catalogue`.`location_catalogue` `LocationCatalogueLocationCatalogue`
	,`location_catalogue`.`description` `LocationCatalogueDescription`
from `opex`.`rq_staff` `rq_staff`
	left join `opex`.`rq_ranks` `rank` on `rq_staff`.`rank_code` = `rank`.`rank_code`
	left join `opex`.`item_staff_filter` `rank_staff_filter` on `rank`.`staff_filter` = `rank_staff_filter`.`staff_filter`
	left join `opex`.`rq_locns` `location` on `rq_staff`.`location_code` = `location`.`location_code`
	left join `opex`.`divisions` `location_division` on `location`.`division_code` = `location_division`.`division_code`
	left join `opex`.`company` `location_division_company` on `location_division`.`company_id` = `location_division_company`.`id`
	left join `opex`.`company` `location_company` on `location`.`company_id` = `location_company`.`id`
	left join `opex`.`locations` `location_default_delivery_location` on `location`.`default_delivery_location_id` = `location_default_delivery_location`.`del_location_id`
	left join `opex`.`rq_budcd` `location_budget_ind` on `location`.`budget_ind` = `location_budget_ind`.`budget_code`
	left join `opex`.`location_catalogue` `location_catalogue` on `location`.`location_catalogue_id` = `location_catalogue`.`location_catalogue_id`
	left join `opex`.`company` `company` on `rq_staff`.`company_id` = `company`.`id`
</text>
      </command>
      <command id="staff_uidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="StaffUid" />
        </output>
      </command>
    </commands>
    <fields xmlns="urn:schemas-codeontime-com:data-aquarium">
      <field name="StaffUid" type="UInt32" allowNulls="false" isPrimaryKey="true" label="Staff Uid" readOnly="true" />
      <field name="StaffCode" type="String" label="Staff Code" length="8" showInSummary="true" />
      <field name="StaffTitle" type="String" label="Staff Title" length="4" showInSummary="true" />
      <field name="Initials" type="String" label="Initials" length="4" showInSummary="true" />
      <field name="Forname" type="String" label="Forname" length="30" showInSummary="true" />
      <field name="Surname" type="String" label="Surname" length="30" showInSummary="true" />
      <field name="RankCode" type="String" allowNulls="false" label="Rank Code" length="8">
        <items style="Lookup" dataController="RqRanks" newDataView="createForm1" dataValueField="RankCode" dataTextField="RankDesc" copy="" />
      </field>
      <field name="RankDesc" type="String" readOnly="true" label="Rank Desc" length="32" />
      <field name="RankStaffFilterstaffFilter" type="String" readOnly="true" label="Rank Staff Filterstaff Filter" length="8" />
      <field name="EplNumber" type="String" label="Epl Number" length="8" />
      <field name="LocationCode" type="String" allowNulls="false" label="Location Code" length="8">
        <items style="Lookup" dataController="OpexrqLocns" newDataView="createForm1" dataValueField="LocationCode" dataTextField="LocationDesc" copy="LocationDefaultDeliveryLocationid=DefaultDeliveryLocationID, LocationDivisionDesc=DivisionDesc, LocationDivisionCompanyName=CompanyName, LocationCompanyName=CompanyName, LocationDefaultDeliveryLocationSlaAcc=DefaultDeliveryLocationSlaAcc, LocationBudgetIndbudgetDesc=BudgetIndbudgetDesc, " />
      </field>
      <field name="LocationDesc" type="String" readOnly="true" label="Location Desc" length="75" />
      <field name="LocationDefaultDeliveryLocationid" type="UInt32" readOnly="true" label="Location Default Delivery Location id" />
      <field name="LocationCatalogueid" type="UInt32" readOnly="true" label="Location Catalogue id" />
      <field name="LocationStaffLocationCatalogueid" type="UInt32" readOnly="true" label="Location Staff Location Catalogue id" />
      <field name="LocationDivisionDesc" type="String" readOnly="true" label="Location Division Desc" length="35" />
      <field name="LocationDivisionCompanyName" type="String" readOnly="true" label="Location Division Company Name" length="20" />
      <field name="LocationCompanyName" type="String" readOnly="true" label="Location Company Name" length="20" />
      <field name="LocationDefaultDeliveryLocationSlaAcc" type="String" readOnly="true" label="Location Default Delivery Location Sla Acc" length="8" />
      <field name="LocationBudgetIndbudgetDesc" type="String" readOnly="true" label="Location Budget Indbudget Desc" length="50" />
      <field name="JoinDate" type="DateTime" label="Join Date" />
      <field name="LeaveDate" type="DateTime" label="Leave Date" />
      <field name="Comments" type="String" label="Comments" length="60" />
      <field name="Email" type="String" label="Email" length="255" />
      <field name="CompanyID" type="UInt32" label="Company Id" />
      <field name="CompanyName" type="String" readOnly="true" label="Company Name" length="20" />
      <field name="UserCredentials" type="String" label="user Credentials" length="100" />
      <field name="Telephone" type="String" label="Telephone" length="40" />
      <field name="Internal" type="String" label="Internal" length="1" />
      <field name="OpexUser" type="String" label="Opex User" length="1" />
      <field name="OpexUserName" type="String" label="Opex User Name" length="256" />
      <field name="Gender" type="String" label="Gender" length="1" />
      <field name="Active" type="String" label="Active" length="1" />
      <field name="RestrictAccess" type="String" label="Restrict Access" length="1" />
      <field name="AccessControlType" type="String" label="Access Control Type" length="1" />
      <field name="LocationCatalogueLocationCatalogue" type="String" readOnly="true" label="Location Catalogue Location Catalogue" length="8" />
      <field name="LocationCatalogueDescription" type="String" readOnly="true" label="Location Catalogue Description" length="100" />
    </fields>
    <views xmlns="urn:schemas-codeontime-com:data-aquarium">
      <view id="grid1" type="Grid" commandId="command1" label="Opexrq Staff">
        <headerText>$DefaultGridViewDescription</headerText>
        <dataFields>
          <dataField fieldName="EplNumber" columns="8">
          </dataField>
          <dataField fieldName="Forname" columns="30" />
          <dataField fieldName="Surname" columns="30" />
          <dataField fieldName="RankCode" aliasFieldName="RankDesc" hidden="true">
          </dataField>
          <dataField fieldName="LocationCode">
          </dataField>
          <dataField fieldName="LocationStaffLocationCatalogueid" columns="15" />
          <dataField fieldName="JoinDate" columns="10" hidden="true">
          </dataField>
          <dataField fieldName="LeaveDate" columns="10" hidden="true">
          </dataField>
          <dataField fieldName="Comments" hidden="true">
          </dataField>
          <dataField fieldName="Email" hidden="true">
          </dataField>
          <dataField fieldName="Gender" columns="1" />
          <dataField fieldName="Active" columns="1" hidden="true">
          </dataField>
          <dataField fieldName="LocationCatalogueLocationCatalogue" columns="8" hidden="true">
          </dataField>
          <dataField fieldName="LocationCatalogueDescription" hidden="true">
          </dataField>
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Opexrq Staff">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1" headerText="Opexrq Staff">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="StaffCode" columns="8" />
              <dataField fieldName="StaffTitle" columns="4" />
              <dataField fieldName="Initials" columns="4" />
              <dataField fieldName="Forname" columns="30" />
              <dataField fieldName="Surname" columns="30" />
              <dataField fieldName="RankCode" aliasFieldName="RankDesc" />
              <dataField fieldName="RankStaffFilterstaffFilter" columns="8" />
              <dataField fieldName="EplNumber" columns="8" />
              <dataField fieldName="LocationCode" aliasFieldName="LocationDesc" />
              <dataField fieldName="LocationDefaultDeliveryLocationid" columns="15" />
              <dataField fieldName="LocationCatalogueid" columns="15" />
              <dataField fieldName="LocationStaffLocationCatalogueid" columns="15" />
              <dataField fieldName="LocationDivisionDesc" columns="35" />
              <dataField fieldName="LocationDivisionCompanyName" columns="20" />
              <dataField fieldName="LocationCompanyName" columns="20" />
              <dataField fieldName="LocationDefaultDeliveryLocationSlaAcc" columns="8" />
              <dataField fieldName="LocationBudgetIndbudgetDesc" columns="50" />
              <dataField fieldName="JoinDate" columns="10" />
              <dataField fieldName="LeaveDate" columns="10" />
              <dataField fieldName="Comments" />
              <dataField fieldName="Email" />
              <dataField fieldName="CompanyID" aliasFieldName="CompanyName" />
              <dataField fieldName="UserCredentials" />
              <dataField fieldName="Telephone" columns="40" />
              <dataField fieldName="Internal" columns="1" />
              <dataField fieldName="OpexUser" columns="1" />
              <dataField fieldName="OpexUserName" />
              <dataField fieldName="Gender" columns="1" />
              <dataField fieldName="Active" columns="1" />
              <dataField fieldName="RestrictAccess" columns="1" />
              <dataField fieldName="AccessControlType" columns="1" />
              <dataField fieldName="LocationCatalogueLocationCatalogue" columns="8" />
              <dataField fieldName="LocationCatalogueDescription" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Opexrq Staff">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="StaffCode" columns="8" />
              <dataField fieldName="StaffTitle" columns="4" />
              <dataField fieldName="Initials" columns="4" />
              <dataField fieldName="Forname" columns="30" />
              <dataField fieldName="Surname" columns="30" />
              <dataField fieldName="RankCode" aliasFieldName="RankDesc" />
              <dataField fieldName="RankStaffFilterstaffFilter" columns="8" />
              <dataField fieldName="EplNumber" columns="8" />
              <dataField fieldName="LocationCode" aliasFieldName="LocationDesc" />
              <dataField fieldName="LocationDefaultDeliveryLocationid" columns="15" />
              <dataField fieldName="LocationCatalogueid" columns="15" />
              <dataField fieldName="LocationStaffLocationCatalogueid" columns="15" />
              <dataField fieldName="LocationDivisionDesc" columns="35" />
              <dataField fieldName="LocationDivisionCompanyName" columns="20" />
              <dataField fieldName="LocationCompanyName" columns="20" />
              <dataField fieldName="LocationDefaultDeliveryLocationSlaAcc" columns="8" />
              <dataField fieldName="LocationBudgetIndbudgetDesc" columns="50" />
              <dataField fieldName="JoinDate" columns="10" />
              <dataField fieldName="LeaveDate" columns="10" />
              <dataField fieldName="Comments" />
              <dataField fieldName="Email" />
              <dataField fieldName="CompanyID" aliasFieldName="CompanyName" />
              <dataField fieldName="UserCredentials" />
              <dataField fieldName="Telephone" columns="40" />
              <dataField fieldName="Internal" columns="1" />
              <dataField fieldName="OpexUser" columns="1" />
              <dataField fieldName="OpexUserName" />
              <dataField fieldName="Gender" columns="1" />
              <dataField fieldName="Active" columns="1" />
              <dataField fieldName="RestrictAccess" columns="1" />
              <dataField fieldName="AccessControlType" columns="1" />
              <dataField fieldName="LocationCatalogueLocationCatalogue" columns="8" />
              <dataField fieldName="LocationCatalogueDescription" />
            </dataFields>
          </category>
        </categories>
      </view>
    </views>
    <actions xmlns="urn:schemas-codeontime-com:data-aquarium">
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
  </dataController>
  <dataController name="RequisitionTextLocation" label="RequisitionTextLocation" conflictDetection="overwriteChanges" generateDataAccessObjects="false" handler="RequisitionTextLocationBusinessRules">
    <commands xmlns="urn:schemas-codeontime-com:data-aquarium">
      <command id="command1" type="Text">
        <text>
select
	`rq_txitm`.`rowid` `Rowid`
	,`rq_txitm`.`rq_header` `RqHeader`
	,`rq_header`.`staff_code` `RqHeaderstaffCode`
	,`rq_header`.`location_code` `rqHeaderLocationCode`
	,`rq_header`.`rqn_prefix` `rqHeaderRqnPrefix`
	,`rq_header`.`staff_uid` `rqHeaderStaffUid`
	,`rq_txitm`.`rqt_desc` `RqtDesc`
	,`rq_txitm`.`rqt_notes` `RqtNotes`
	,`rq_txitm`.`rqt_qty` `RqtQty`
	,`rq_txitm`.`rqt_value` `RqtValue`
	,`rq_txitm`.`rqt_act_val` `RqtActVal`
	,`rq_txitm`.`comment_code` `CommentCode`
	,`comment`.`comment_desc` `CommentDesc`
	,`rq_txitm`.`status` `Status`
	,`rq_status`.`status_description` `rqStatusDescription`
	,`rq_txitm`.`date_entered` `DateEntered`
	,`rq_txitm`.`date_approved` `DateApproved`
	,`rq_txitm`.`date_completed` `DateCompleted`
	,`rq_txitm`.`gl_code` `GlCode`
	,`rq_txitm`.`line_value` `LineValue`
	,`rq_txitm`.`actual_line_value` `ActualLineValue`
	,`rq_txitm`.`budget_ind` `BudgetInd`
	,`budget_ind`.`budget_desc` `BudgetIndbudgetDesc`
	,`rq_txitm`.`po_header_id` `PoHeaderID`
	,`requested_by`.`surname` `RequestedbySurname`
	,`requested_by`.`staff_code` `RequestedbyStaffCode`
from `opex`.`rq_txitm` `rq_txitm`
	left join `opex`.`rq_rqns` `rq_header` on `rq_txitm`.`rq_header` = `rq_header`.`rowid`
	left join `opex`.`rq_comms` `comment` on `rq_txitm`.`comment_code` = `comment`.`comment_code`
	left join `opex`.`rq_budcd` `budget_ind` on `rq_txitm`.`budget_ind` = `budget_ind`.`budget_code`
	left join `opex`.`rq_staff` `requested_by` on `rq_txitm`.`requested_by` = `requested_by`.`staff_uid`
	left join `opex`.`rq_status` `rq_status` on `rq_txitm`.`status` = `rq_status`.`status_code`
</text>
      </command>
      <command id="rowidIdentityCommand" type="Text" event="Inserted">
        <text>select @@identity</text>
        <output>
          <fieldOutput fieldName="Rowid" />
        </output>
      </command>
    </commands>
    <fields xmlns="urn:schemas-codeontime-com:data-aquarium">
      <field name="Rowid" type="Int32" allowNulls="false" isPrimaryKey="true" label="Rowid" readOnly="true" />
      <field name="RqHeader" type="Int32" allowNulls="false" label="Requisition" showInSummary="true" />
      <field name="RqHeaderstaffCode" type="String" readOnly="true" label="Rq Header Staff Code" length="8" />
      <field name="rqHeaderLocationCode" type="String" readOnly="true" label="rq Header Location Code" length="8" />
      <field name="rqHeaderRqnPrefix" type="String" readOnly="true" label="Requisition Number" length="2" />
      <field name="rqHeaderStaffUid" type="UInt32" readOnly="true" label="StaffID" />
      <field name="RqtDesc" type="String" label="Description" length="2000" showInSummary="true" />
      <field name="RqtNotes" type="String" label="Additional Information" length="250" showInSummary="true" />
      <field name="RqtQty" type="Int32" allowNulls="false" label="Qty" showInSummary="true" />
      <field name="RqtValue" type="Decimal" allowNulls="false" label="Unit Cost" showInSummary="true" dataFormatString="C2" />
      <field name="RqtActVal" type="Decimal" label="Actual Unit Cost" />
      <field name="CommentCode" type="String" label="Reason Code" length="3">
        <items style="Lookup" dataController="ReasonCodes" newDataView="createForm1" dataValueField="CommentCode" dataTextField="CommentDesc" />
      </field>
      <field name="CommentDesc" type="String" readOnly="true" label="Reason" length="20" />
      <field name="Status" type="String" label="Status Code" length="2" />
      <field name="rqStatusDescription" type="String" readOnly="true" label="Status" length="50" />
      <field name="DateEntered" type="DateTime" label="Date Entered" />
      <field name="DateApproved" type="DateTime" label="Date Approved" />
      <field name="DateCompleted" type="DateTime" label="Date Completed" />
      <field name="GlCode" type="String" label="GL Code" length="12" />
      <field name="LineValue" type="Decimal" label="Line Value" dataFormatString="C2" />
      <field name="ActualLineValue" type="Decimal" label="Actual Line Value" />
      <field name="BudgetInd" type="String" label="Budget Code" length="8">
        <items style="Lookup" dataController="RqBudcd" newDataView="createForm1" dataValueField="BudgetCode" dataTextField="BudgetDesc" />
      </field>
      <field name="BudgetIndbudgetDesc" type="String" readOnly="true" label="Budget" length="50" />
      <field name="PoHeaderID" type="Int32" label="PO Reference" />
      <field name="RequestedbySurname" type="String" readOnly="true" label="Requested by Surname" length="30" />
      <field name="RequestedbyStaffCode" type="String" readOnly="true" label="Requested by Staff Code" length="8" />
    </fields>
    <views xmlns="urn:schemas-codeontime-com:data-aquarium">
      <view id="grid1" type="Grid" commandId="command1" label="Non Stock Items (Outstanding)" sortExpression="RqHeader desc" filter="Status in (&quot;SU&quot;,&quot;IS&quot;,&quot;OO&quot;,&quot;PQ&quot;)&#xD;&#xA;AND rqHeaderRqnPrefix = &quot;TL&quot;">
        <headerText>This is a list of non stock items that have been requested</headerText>
        <dataFields>
          <dataField fieldName="RqHeader">
          </dataField>
          <dataField fieldName="RqtDesc" />
          <dataField fieldName="RqtQty" columns="15" />
          <dataField fieldName="RqtValue" columns="15" />
          <dataField fieldName="LineValue" columns="15" />
          <dataField fieldName="Status" aliasFieldName="rqStatusDescription">
          </dataField>
          <dataField fieldName="DateApproved" columns="10" />
          <dataField fieldName="DateCompleted" columns="10" />
          <dataField fieldName="PoHeaderID" columns="15" />
          <dataField fieldName="rqHeaderStaffUid" columns="15" hidden="true">
          </dataField>
          <dataField fieldName="rqHeaderLocationCode" columns="8" hidden="true">
          </dataField>
          <dataField fieldName="rqHeaderRqnPrefix" columns="2" hidden="true">
          </dataField>
          <dataField fieldName="GlCode" columns="12" />
          <dataField fieldName="BudgetInd" columns="8" />
        </dataFields>
      </view>
      <view id="editForm1" type="Form" commandId="command1" label="Review Requisition Text">
        <headerText>$DefaultEditViewDescription</headerText>
        <categories>
          <category id="c1" headerText="General" tab="General">
            <description>$DefaultEditDescription</description>
            <dataFields>
              <dataField fieldName="RqHeader">
              </dataField>
              <dataField fieldName="RqtDesc" />
              <dataField fieldName="RqtQty" columns="15" />
              <dataField fieldName="RqtValue" columns="15" />
              <dataField fieldName="LineValue" columns="15" />
              <dataField fieldName="CommentCode" aliasFieldName="CommentDesc" />
              <dataField fieldName="Status" aliasFieldName="rqStatusDescription" />
            </dataFields>
          </category>
          <category headerText="Dates" id="c2" tab="Dates">
            <dataFields>
              <dataField fieldName="DateEntered" columns="10" />
              <dataField fieldName="DateApproved" columns="10" />
              <dataField fieldName="DateCompleted" columns="10" />
            </dataFields>
          </category>
          <category headerText="Detail" id="c3" tab="Detail">
            <dataFields>
              <dataField fieldName="RqtNotes" />
              <dataField fieldName="RequestedbySurname" columns="30" />
              <dataField fieldName="RequestedbyStaffCode" columns="8" />
              <dataField fieldName="BudgetInd" aliasFieldName="BudgetIndbudgetDesc" />
              <dataField fieldName="GlCode" columns="12" />
              <dataField fieldName="PoHeaderID" columns="15" />
            </dataFields>
          </category>
          <category headerText="Hidden" tab="Hidden" id="c4">
            <visibility>
              <expression test="false" type="ClientScript" />
            </visibility>
            <dataFields>
              <dataField fieldName="rqHeaderStaffUid" columns="15" />
              <dataField fieldName="rqHeaderRqnPrefix" columns="2" />
              <dataField fieldName="rqHeaderLocationCode" columns="8" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="createForm1" type="Form" commandId="command1" label="New Requisition Text">
        <headerText>$DefaultCreateViewDescription</headerText>
        <categories>
          <category id="c1">
            <description>$DefaultNewDescription</description>
            <dataFields>
              <dataField fieldName="RqHeader" aliasFieldName="RqHeaderstaffCode" />
              <dataField fieldName="rqHeaderLocationCode" columns="8" />
              <dataField fieldName="rqHeaderRqnPrefix" columns="2" />
              <dataField fieldName="rqHeaderStaffUid" columns="15" />
              <dataField fieldName="RqtDesc" />
              <dataField fieldName="RqtNotes" />
              <dataField fieldName="RqtQty" columns="15" />
              <dataField fieldName="RqtValue" columns="15" />
              <dataField fieldName="RqtActVal" columns="15" />
              <dataField fieldName="CommentCode" aliasFieldName="CommentDesc" />
              <dataField fieldName="Status" aliasFieldName="rqStatusDescription" />
              <dataField fieldName="DateEntered" columns="10" />
              <dataField fieldName="DateApproved" columns="10" />
              <dataField fieldName="DateCompleted" columns="10" />
              <dataField fieldName="GlCode" columns="12" />
              <dataField fieldName="LineValue" columns="15" />
              <dataField fieldName="ActualLineValue" columns="15" />
              <dataField fieldName="BudgetInd" aliasFieldName="BudgetIndbudgetDesc" />
              <dataField fieldName="PoHeaderID" columns="15" />
              <dataField fieldName="RequestedbySurname" columns="30" />
              <dataField fieldName="RequestedbyStaffCode" columns="8" />
            </dataFields>
          </category>
        </categories>
      </view>
      <view id="GridAll" commandId="command1" type="Grid" label="All Non Stock Items" baseViewId="grid1" sortExpression="RqHeader desc" filter="rqHeaderRqnPrefix = &quot;TL&quot;" />
    </views>
    <actions xmlns="urn:schemas-codeontime-com:data-aquarium">
      <actionGroup id="ag1" scope="Grid">
        <action id="a1" commandName="Select" commandArgument="editForm1" />
        <action commandName="Email" id="a101" headerText="Ask A Question" description="Ask a Question ?" commandArgument="Ask" confirmation="_controller=OfficerEmailPrompt&#xD;&#xA;_title=Ask Question about an Item&#xD;&#xA;_width=500&#xD;&#xA;_view = PromptView" causesValidation="false" whenKeySelected="false" cssClass="glyphicon-question-sign" />
      </actionGroup>
      <actionGroup id="ag2" scope="Form">
        <action id="a3" commandName="Cancel" />
        <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
        <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
        <action id="a8" whenLastCommandName="New" commandName="Cancel" />
        <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
        <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
        <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
        <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
      </actionGroup>
      <actionGroup id="ag5" scope="ActionBar" headerText="Actions">
        <action id="a1" commandName="ExportCsv" />
        <action id="a2" />
        <action id="a3" commandName="ExportRowset" />
        <action id="a4" commandName="ExportRss" />
        <action id="a5" />
        <action id="a6" commandName="Import" commandArgument="createForm1" />
        <action id="a7" commandName="DataSheet" />
        <action id="a8" commandName="Grid" />
      </actionGroup>
      <actionGroup id="ag6" scope="ActionBar" headerText="Record">
        <action id="a1" whenLastCommandName="Edit" commandName="Update" />
        <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a3" whenLastCommandName="New" commandName="Insert" />
        <action id="a4" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
      <actionGroup id="ag7" scope="ActionBar" headerText="Report">
        <action id="a1" commandName="ReportAsPdf" />
        <action id="a2" commandName="ReportAsImage" />
        <action id="a3" commandName="ReportAsExcel" />
        <action id="a4" commandName="ReportAsWord" />
      </actionGroup>
      <actionGroup id="ag8" scope="Row">
        <action id="a4" whenLastCommandName="Edit" commandName="Update" />
        <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
        <action id="a6" whenLastCommandName="New" commandName="Insert" />
        <action id="a7" whenLastCommandName="New" commandName="Cancel" />
      </actionGroup>
    </actions>
    <businessRules xmlns="urn:schemas-codeontime-com:data-aquarium">
      <rule id="r100" commandName="Email" type="Email" phase="Execute" name="AskAQuestion" commandArgument="Ask">From: "{Parameters_Forname} {Parameters_Surname}" {Parameters_OfficerEmail}
To: {Parameters_AskEmail}
Subject: {Parameters_Subject}
&lt;html&gt;
&lt;body&gt;
&lt;p&gt;
{Parameters_OfficerEmailHeader}
{Parameters_Message}
{Parameters_OfficerEmailFooter}
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</rule>
      <rule id="r102" commandName="Email" type="Code" phase="After" name="ConfirmEmail" />
    </businessRules>
  </dataController>
</dataControllerCollection>